/*! For license information please see main.f8e91509.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),o=n(43),i=n(950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(l(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),w=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope");var E=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var T=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var R=Symbol.iterator;function j(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function P(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case y:return"Fragment";case b:return"Profiler";case v:return"StrictMode";case k:return"Suspense";case S:return"SuspenseList";case E:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case m:return"Portal";case w:return e.displayName||"Context";case x:return(e._context.displayName||"Context")+".Consumer";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:P(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return P(e(t))}catch(n){}}return null}var M=Array.isArray,O=o.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D={pending:!1,data:null,method:null,action:null},F=[],q=-1;function L(e){return{current:e}}function z(e){0>q||(e.current=F[q],F[q]=null,q--)}function H(e,t){q++,F[q]=e.current,e.current=t}var B,W,U=L(null),V=L(null),G=L(null),Q=L(null);function K(e,t){switch(H(G,t),H(V,e),H(U,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=vd(t=yd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}z(U),H(U,e)}function Y(){z(U),z(V),z(G)}function $(e){null!==e.memoizedState&&H(Q,e);var t=U.current,n=vd(t,e.type);t!==n&&(H(V,e),H(U,n))}function Z(e){V.current===e&&(z(U),z(V)),Q.current===e&&(z(Q),uh._currentValue=D)}function X(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||"",W=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+B+e+W}var J=!1;function ee(e,t){if(!e||J)return"";J=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(o){var r=o}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=r.DetermineComponentFrameRoot(),a=i[0],s=i[1];if(a&&s){var l=a.split("\n"),c=s.split("\n");for(o=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;o<c.length&&!c[o].includes("DetermineComponentFrameRoot");)o++;if(r===l.length||o===c.length)for(r=l.length-1,o=c.length-1;1<=r&&0<=o&&l[r]!==c[o];)o--;for(;1<=r&&0<=o;r--,o--)if(l[r]!==c[o]){if(1!==r||1!==o)do{if(r--,0>--o||l[r]!==c[o]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=o);break}}}finally{J=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(r){return"\nError generating stack: "+r.message+"\n"+r.stack}}var re=Object.prototype.hasOwnProperty,oe=r.unstable_scheduleCallback,ie=r.unstable_cancelCallback,ae=r.unstable_shouldYield,se=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,pe=r.unstable_LowPriority,fe=r.unstable_IdlePriority,ge=r.log,me=r.unstable_setDisableYieldValue,ye=null,ve=null;function be(e){if("function"===typeof ge&&me(e),ve&&"function"===typeof ve.setStrictMode)try{ve.setStrictMode(ye,e)}catch(t){}}var xe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(we(e)/_e|0)|0},we=Math.log,_e=Math.LN2;var ke=256,Se=262144,Ce=4194304;function Ae(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ee(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var o=0,i=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&r;return 0!==s?0!==(r=s&~i)?o=Ae(r):0!==(a&=s)?o=Ae(a):n||0!==(n=s&~e)&&(o=Ae(n)):0!==(s=r&~i)?o=Ae(s):0!==a?o=Ae(a):n||0!==(n=r&~e)&&(o=Ae(n)),0===o?0:0!==t&&t!==o&&0===(t&i)&&((i=o&-o)>=(n=t&-t)||32===i&&0!==(4194048&n))?t:o}function Te(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Re(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function je(){var e=Ce;return 0===(62914560&(Ce<<=1))&&(Ce=4194304),e}function Ie(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Pe(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Me(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-xe(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Oe(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-xe(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}function Ne(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:De(n))&(e.suspendedLanes|t))?0:n}function De(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function qe(){var e=N.p;return 0!==e?e:void 0===(e=window.event)?32:Ah(e.type)}function Le(e,t){var n=N.p;try{return N.p=e,t()}finally{N.p=n}}var ze=Math.random().toString(36).slice(2),He="__reactFiber$"+ze,Be="__reactProps$"+ze,We="__reactContainer$"+ze,Ue="__reactEvents$"+ze,Ve="__reactListeners$"+ze,Ge="__reactHandles$"+ze,Qe="__reactResources$"+ze,Ke="__reactMarker$"+ze;function Ye(e){delete e[He],delete e[Be],delete e[Ue],delete e[Ve],delete e[Ge]}function $e(e){var t=e[He];if(t)return t;for(var n=e.parentNode;n;){if(t=n[We]||n[He]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Dd(e);null!==e;){if(n=e[He])return n;e=Dd(e)}return t}n=(e=n).parentNode}return null}function Ze(e){if(e=e[He]||e[We]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Je(e){var t=e[Qe];return t||(t=e[Qe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ke]=!0}var tt=new Set,nt={};function rt(e,t){ot(e,t),ot(e+"Capture",t)}function ot(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var it=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function lt(e,t,n){if(o=t,re.call(st,o)||!re.call(at,o)&&(it.test(o)?st[o]=!0:(at[o]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var o}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var o=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ht(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function gt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var mt=/[\n"\\]/g;function yt(e){return e.replace(mt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,n,r,o,i,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?xt(e,a,dt(t)):null!=n?xt(e,a,dt(n)):null!=r&&e.removeAttribute("value"),null==o&&null!=i&&(e.defaultChecked=!!i),null!=o&&(e.checked=o&&"function"!==typeof o&&"symbol"!==typeof o),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+dt(s):e.removeAttribute("name")}function bt(e,t,n,r,o,i,a,s){if(null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&"boolean"!==typeof i&&(e.type=i),null!=t||null!=n){if(!("submit"!==i&&"reset"!==i||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:o)&&"symbol"!==typeof r&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),pt(e)}function xt(e,t,n){"number"===t&&gt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function wt(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function _t(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function kt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(a(92));if(M(r)){if(1<r.length)throw Error(a(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),pt(e)}function St(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Ct=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function At(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Ct.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Et(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var o in t)r=t[o],t.hasOwnProperty(o)&&n[o]!==r&&At(e,o,r)}else for(var i in t)t.hasOwnProperty(i)&&At(e,i,t[i])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return jt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Pt(){}var Mt=null;function Ot(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Nt=null,Dt=null;function Ft(e){var t=Ze(e);if(t&&(e=t.stateNode)){var n=e[Be]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+yt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=r[Be]||null;if(!o)throw Error(a(90));vt(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&ft(r)}break e;case"textarea":_t(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&wt(e,!!n.multiple,t,!1)}}}var qt=!1;function Lt(e,t,n){if(qt)return e(t,n);qt=!0;try{return e(t)}finally{if(qt=!1,(null!==Nt||null!==Dt)&&(Jc(),Nt&&(t=Nt,e=Dt,Dt=Nt=null,Ft(t),e)))for(t=0;t<e.length;t++)Ft(e[t])}}function zt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[Be]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Ht=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Bt=!1;if(Ht)try{var Wt={};Object.defineProperty(Wt,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Wt,Wt),window.removeEventListener("test",Wt,Wt)}catch(Zh){Bt=!1}var Ut=null,Vt=null,Gt=null;function Qt(){if(Gt)return Gt;var e,t,n=Vt,r=n.length,o="value"in Ut?Ut.value:Ut.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return Gt=o.slice(e,1<t?1-t:void 0)}function Kt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Yt(){return!0}function $t(){return!1}function Zt(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?Yt:$t,this.isPropagationStopped=$t,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Yt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Yt)},persist:function(){},isPersistent:Yt}),t}var Xt,Jt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Zt(tn),rn=p({},tn,{view:0,detail:0}),on=Zt(rn),an=p({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Jt=e.screenY-en.screenY):Jt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Jt}}),sn=Zt(an),ln=Zt(p({},an,{dataTransfer:0})),cn=Zt(p({},rn,{relatedTarget:0})),un=Zt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Zt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Zt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=gn[e])&&!!t[e]}function yn(){return mn}var vn=Zt(p({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Kt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yn,charCode:function(e){return"keypress"===e.type?Kt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Kt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Zt(p({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),xn=Zt(p({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yn})),wn=Zt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=Zt(p({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),kn=Zt(p({},tn,{newState:0,oldState:0})),Sn=[9,13,27,32],Cn=Ht&&"CompositionEvent"in window,An=null;Ht&&"documentMode"in document&&(An=document.documentMode);var En=Ht&&"TextEvent"in window&&!An,Tn=Ht&&(!Cn||An&&8<An&&11>=An),Rn=String.fromCharCode(32),jn=!1;function In(e,t){switch(e){case"keyup":return-1!==Sn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Mn=!1;var On={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Nn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!On[e.type]:"textarea"===t}function Dn(e,t,n,r){Nt?Dt?Dt.push(r):Dt=[r]:Nt=r,0<(t=rd(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Fn=null,qn=null;function Ln(e){Yu(e,0)}function zn(e){if(ft(Xe(e)))return e}function Hn(e,t){if("change"===e)return t}var Bn=!1;if(Ht){var Wn;if(Ht){var Un="oninput"in document;if(!Un){var Vn=document.createElement("div");Vn.setAttribute("oninput","return;"),Un="function"===typeof Vn.oninput}Wn=Un}else Wn=!1;Bn=Wn&&(!document.documentMode||9<document.documentMode)}function Gn(){Fn&&(Fn.detachEvent("onpropertychange",Qn),qn=Fn=null)}function Qn(e){if("value"===e.propertyName&&zn(qn)){var t=[];Dn(t,qn,e,Ot(e)),Lt(Ln,t)}}function Kn(e,t,n){"focusin"===e?(Gn(),qn=n,(Fn=t).attachEvent("onpropertychange",Qn)):"focusout"===e&&Gn()}function Yn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return zn(qn)}function $n(e,t){if("click"===e)return zn(t)}function Zn(e,t){if("input"===e||"change"===e)return zn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Jn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!re.call(t,o)||!Xn(e[o],t[o]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=gt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=gt((e=t.contentWindow).document)}return t}function or(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ir=Ht&&"documentMode"in document&&11>=document.documentMode,ar=null,sr=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==ar||ar!==gt(r)||("selectionStart"in(r=ar)&&or(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&Jn(lr,r)||(lr=r,0<(r=rd(sr,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ar)))}function dr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hr={animationend:dr("Animation","AnimationEnd"),animationiteration:dr("Animation","AnimationIteration"),animationstart:dr("Animation","AnimationStart"),transitionrun:dr("Transition","TransitionRun"),transitionstart:dr("Transition","TransitionStart"),transitioncancel:dr("Transition","TransitionCancel"),transitionend:dr("Transition","TransitionEnd")},pr={},fr={};function gr(e){if(pr[e])return pr[e];if(!hr[e])return e;var t,n=hr[e];for(t in n)if(n.hasOwnProperty(t)&&t in fr)return pr[e]=n[t];return e}Ht&&(fr=document.createElement("div").style,"AnimationEvent"in window||(delete hr.animationend.animation,delete hr.animationiteration.animation,delete hr.animationstart.animation),"TransitionEvent"in window||delete hr.transitionend.transition);var mr=gr("animationend"),yr=gr("animationiteration"),vr=gr("animationstart"),br=gr("transitionrun"),xr=gr("transitionstart"),wr=gr("transitioncancel"),_r=gr("transitionend"),kr=new Map,Sr="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cr(e,t){kr.set(e,t),rt(t,[e])}Sr.push("scrollEnd");var Ar="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Er=[],Tr=0,Rr=0;function jr(){for(var e=Tr,t=Rr=Tr=0;t<e;){var n=Er[t];Er[t++]=null;var r=Er[t];Er[t++]=null;var o=Er[t];Er[t++]=null;var i=Er[t];if(Er[t++]=null,null!==r&&null!==o){var a=r.pending;null===a?o.next=o:(o.next=a.next,a.next=o),r.pending=o}0!==i&&Or(n,o,i)}}function Ir(e,t,n,r){Er[Tr++]=e,Er[Tr++]=t,Er[Tr++]=n,Er[Tr++]=r,Rr|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Pr(e,t,n,r){return Ir(e,t,n,r),Nr(e)}function Mr(e,t){return Ir(e,null,null,t),Nr(e)}function Or(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var o=!1,i=e.return;null!==i;)i.childLanes|=n,null!==(r=i.alternate)&&(r.childLanes|=n),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(o=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,o&&null!==t&&(o=31-xe(n),null===(r=(e=i.hiddenUpdates)[o])?e[o]=[t]:r.push(t),t.lane=536870912|n),i):null}function Nr(e){if(50<Uc)throw Uc=0,Vc=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Dr={};function Fr(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qr(e,t,n,r){return new Fr(e,t,n,r)}function Lr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zr(e,t){var n=e.alternate;return null===n?((n=qr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Hr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Br(e,t,n,r,o,i){var s=0;if(r=e,"function"===typeof e)Lr(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,U.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case E:return(e=qr(31,n,t,o)).elementType=E,e.lanes=i,e;case y:return Wr(n.children,o,i,t);case v:s=8,o|=24;break;case b:return(e=qr(12,n,t,2|o)).elementType=b,e.lanes=i,e;case k:return(e=qr(13,n,t,o)).elementType=k,e.lanes=i,e;case S:return(e=qr(19,n,t,o)).elementType=S,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case w:s=10;break e;case x:s=9;break e;case _:s=11;break e;case C:s=14;break e;case A:s=16,r=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),r=null}return(t=qr(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Wr(e,t,n,r){return(e=qr(7,e,r,t)).lanes=n,e}function Ur(e,t,n){return(e=qr(6,e,null,t)).lanes=n,e}function Vr(e){var t=qr(18,null,null,0);return t.stateNode=e,t}function Gr(e,t,n){return(t=qr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qr=new WeakMap;function Kr(e,t){if("object"===typeof e&&null!==e){var n=Qr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Qr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Yr=[],$r=0,Zr=null,Xr=0,Jr=[],eo=0,to=null,no=1,ro="";function oo(e,t){Yr[$r++]=Xr,Yr[$r++]=Zr,Zr=e,Xr=t}function io(e,t,n){Jr[eo++]=no,Jr[eo++]=ro,Jr[eo++]=to,to=e;var r=no;e=ro;var o=32-xe(r)-1;r&=~(1<<o),n+=1;var i=32-xe(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,no=1<<32-xe(t)+o|n<<o|r,ro=i+e}else no=1<<i|n<<o|r,ro=e}function ao(e){null!==e.return&&(oo(e,1),io(e,1,0))}function so(e){for(;e===Zr;)Zr=Yr[--$r],Yr[$r]=null,Xr=Yr[--$r],Yr[$r]=null;for(;e===to;)to=Jr[--eo],Jr[eo]=null,ro=Jr[--eo],Jr[eo]=null,no=Jr[--eo],Jr[eo]=null}function lo(e,t){Jr[eo++]=no,Jr[eo++]=ro,Jr[eo++]=to,no=t.id,ro=t.overflow,to=e}var co=null,uo=null,ho=!1,po=null,fo=!1,go=Error(a(519));function mo(e){throw _o(Kr(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),go}function yo(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[He]=e,t[Be]=r,n){case"dialog":$u("cancel",t),$u("close",t);break;case"iframe":case"object":case"embed":$u("load",t);break;case"video":case"audio":for(n=0;n<Qu.length;n++)$u(Qu[n],t);break;case"source":$u("error",t);break;case"img":case"image":case"link":$u("error",t),$u("load",t);break;case"details":$u("toggle",t);break;case"input":$u("invalid",t),bt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":$u("invalid",t);break;case"textarea":$u("invalid",t),kt(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||cd(t.textContent,n)?(null!=r.popover&&($u("beforetoggle",t),$u("toggle",t)),null!=r.onScroll&&$u("scroll",t),null!=r.onScrollEnd&&$u("scrollend",t),null!=r.onClick&&(t.onclick=Pt),t=!0):t=!1,t||mo(e,!0)}function vo(e){for(co=e.return;co;)switch(co.tag){case 5:case 31:case 13:return void(fo=!1);case 27:case 3:return void(fo=!0);default:co=co.return}}function bo(e){if(e!==co)return!1;if(!ho)return vo(e),ho=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bd(e.type,e.memoizedProps)),t=!t),t&&uo&&mo(e),vo(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));uo=Nd(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));uo=Nd(e)}else 27===n?(n=uo,Ad(e.type)?(e=Od,Od=null,uo=e):uo=n):uo=co?Md(e.stateNode.nextSibling):null;return!0}function xo(){uo=co=null,ho=!1}function wo(){var e=po;return null!==e&&(null===jc?jc=e:jc.push.apply(jc,e),po=null),e}function _o(e){null===po?po=[e]:po.push(e)}var ko=L(null),So=null,Co=null;function Ao(e,t,n){H(ko,t._currentValue),t._currentValue=n}function Eo(e){e._currentValue=ko.current,z(ko)}function To(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ro(e,t,n,r){var o=e.child;for(null!==o&&(o.return=e);null!==o;){var i=o.dependencies;if(null!==i){var s=o.child;i=i.firstContext;e:for(;null!==i;){var l=i;i=o;for(var c=0;c<t.length;c++)if(l.context===t[c]){i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),To(i.return,n,e),r||(s=null);break e}i=l.next}}else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(i=s.alternate)&&(i.lanes|=n),To(s,n,e),s=null}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===e){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}}function jo(e,t,n,r){e=null;for(var o=t,i=!1;null!==o;){if(!i)if(0!==(524288&o.flags))i=!0;else if(0!==(262144&o.flags))break;if(10===o.tag){var s=o.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var l=o.type;Xn(o.pendingProps.value,s.value)||(null!==e?e.push(l):e=[l])}}else if(o===Q.current){if(null===(s=o.alternate))throw Error(a(387));s.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(null!==e?e.push(uh):e=[uh])}o=o.return}null!==e&&Ro(t,e,n,r),t.flags|=262144}function Io(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Po(e){So=e,Co=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Mo(e){return No(So,e)}function Oo(e,t){return null===So&&Po(e),No(e,t)}function No(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Co){if(null===e)throw Error(a(308));Co=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Co=Co.next=t;return n}var Do="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Fo=r.unstable_scheduleCallback,qo=r.unstable_NormalPriority,Lo={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zo(){return{controller:new Do,data:new Map,refCount:0}}function Ho(e){e.refCount--,0===e.refCount&&Fo(qo,function(){e.controller.abort()})}var Bo=null,Wo=0,Uo=0,Vo=null;function Go(){if(0===--Wo&&null!==Bo){null!==Vo&&(Vo.status="fulfilled");var e=Bo;Bo=null,Uo=0,Vo=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Qo=O.S;O.S=function(e,t){Mc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Bo){var n=Bo=[];Wo=0,Uo=Bu(),Vo={status:"pending",value:void 0,then:function(e){n.push(e)}}}Wo++,t.then(Go,Go)}(0,t),null!==Qo&&Qo(e,t)};var Ko=L(null);function Yo(){var e=Ko.current;return null!==e?e:fc.pooledCache}function $o(e,t){H(Ko,null===t?Ko.current:t.pool)}function Zo(){var e=Yo();return null===e?null:{parent:Lo._currentValue,pool:e}}var Xo=Error(a(460)),Jo=Error(a(474)),ei=Error(a(542)),ti={then:function(){}};function ni(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ri(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Pt,Pt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e;default:if("string"===typeof t.status)t.then(Pt,Pt);else{if(null!==(e=fc)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw si(e=t.reason),e}throw ii=t,Xo}}function oi(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ii=t,Xo;throw t}}var ii=null;function ai(){if(null===ii)throw Error(a(459));var e=ii;return ii=null,e}function si(e){if(e===Xo||e===ei)throw Error(a(483))}var li=null,ci=0;function ui(e){var t=ci;return ci+=1,null===li&&(li=[]),ri(li,e,t)}function di(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function hi(e,t){if(t.$$typeof===f)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function pi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=zr(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Ur(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===y?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===A&&oi(i)===t.type)?(di(t=o(t,n.props),n),t.return=e,t):(di(t=Br(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Gr(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Wr(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ur(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case g:return di(n=Br(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case m:return(t=Gr(t,e.mode,n)).return=e,t;case A:return h(e,t=oi(t),n)}if(M(t)||j(t))return(t=Wr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,ui(t),n);if(t.$$typeof===w)return h(e,Oo(e,t),n);hi(e,t)}return null}function p(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==o?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case g:return n.key===o?c(e,t,n,r):null;case m:return n.key===o?u(e,t,n,r):null;case A:return p(e,t,n=oi(n),r)}if(M(n)||j(n))return null!==o?null:d(e,t,n,r,null);if("function"===typeof n.then)return p(e,t,ui(n),r);if(n.$$typeof===w)return p(e,t,Oo(e,n),r);hi(e,n)}return null}function f(e,t,n,r,o){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case g:return c(t,e=e.get(null===r.key?n:r.key)||null,r,o);case m:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case A:return f(e,t,n,r=oi(r),o)}if(M(r)||j(r))return d(t,e=e.get(n)||null,r,o,null);if("function"===typeof r.then)return f(e,t,n,ui(r),o);if(r.$$typeof===w)return f(e,t,n,Oo(t,r),o);hi(t,r)}return null}function v(l,c,u,d){if("object"===typeof u&&null!==u&&u.type===y&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case g:e:{for(var b=u.key;null!==c;){if(c.key===b){if((b=u.type)===y){if(7===c.tag){n(l,c.sibling),(d=o(c,u.props.children)).return=l,l=d;break e}}else if(c.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===A&&oi(b)===c.type){n(l,c.sibling),di(d=o(c,u.props),u),d.return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===y?((d=Wr(u.props.children,l.mode,d,u.key)).return=l,l=d):(di(d=Br(u.type,u.key,u.props,null,l.mode,d),u),d.return=l,l=d)}return s(l);case m:e:{for(b=u.key;null!==c;){if(c.key===b){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(d=o(c,u.children||[])).return=l,l=d;break e}n(l,c);break}t(l,c),c=c.sibling}(d=Gr(u,l.mode,d)).return=l,l=d}return s(l);case A:return v(l,c,u=oi(u),d)}if(M(u))return function(o,a,s,l){for(var c=null,u=null,d=a,g=a=0,m=null;null!==d&&g<s.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=p(o,d,s[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(o,d),a=i(y,a,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===s.length)return n(o,d),ho&&oo(o,g),c;if(null===d){for(;g<s.length;g++)null!==(d=h(o,s[g],l))&&(a=i(d,a,g),null===u?c=d:u.sibling=d,u=d);return ho&&oo(o,g),c}for(d=r(d);g<s.length;g++)null!==(m=f(d,o,g,s[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),a=i(m,a,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach(function(e){return t(o,e)}),ho&&oo(o,g),c}(l,c,u,d);if(j(u)){if("function"!==typeof(b=j(u)))throw Error(a(150));return function(o,s,l,c){if(null==l)throw Error(a(151));for(var u=null,d=null,g=s,m=s=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=p(o,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(o,g),s=i(b,s,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(o,g),ho&&oo(o,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(o,v.value,c))&&(s=i(v,s,m),null===d?u=v:d.sibling=v,d=v);return ho&&oo(o,m),u}for(g=r(g);!v.done;m++,v=l.next())null!==(v=f(g,o,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),s=i(v,s,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach(function(e){return t(o,e)}),ho&&oo(o,m),u}(l,c,u=b.call(u),d)}if("function"===typeof u.then)return v(l,c,ui(u),d);if(u.$$typeof===w)return v(l,c,Oo(l,u),d);hi(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(d=o(c,u)).return=l,l=d):(n(l,c),(d=Ur(u,l.mode,d)).return=l,l=d),s(l)):n(l,c)}return function(e,t,n,r){try{ci=0;var o=v(e,t,n,r);return li=null,o}catch(a){if(a===Xo||a===ei)throw a;var i=qr(29,a,null,e.mode);return i.lanes=r,i.return=e,i}}}var fi=pi(!0),gi=pi(!1),mi=!1;function yi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function xi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&pc)){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,t=Nr(e),Or(e,null,n),t}return Ir(e,r,t,n),Nr(e)}function wi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}function _i(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var ki=!1;function Si(){if(ki){if(null!==Vo)throw Vo}}function Ci(e,t,n,r){ki=!1;var o=e.updateQueue;mi=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=o.baseState;for(a=0,u=c=l=null,s=i;;){var h=-536870913&s.lane,f=h!==s.lane;if(f?(mc&h)===h:(r&h)===h){0!==h&&h===Uo&&(ki=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var g=e,m=s;h=t;var y=n;switch(m.tag){case 1:if("function"===typeof(g=m.payload)){d=g.call(y,d,h);break e}d=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(h="function"===typeof(g=m.payload)?g.call(y,d,h):g)||void 0===h)break e;d=p({},d,h);break e;case 2:mi=!0}}null!==(h=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=o.callbacks)?o.callbacks=[h]:f.push(h))}else f={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(s=s.next)){if(null===(s=o.shared.pending))break;s=(f=s).next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}null===u&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,null===i&&(o.shared.lanes=0),Sc|=a,e.lanes=a,e.memoizedState=d}}function Ai(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function Ei(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ai(n[e],t)}var Ti=L(null),Ri=L(0);function ji(e,t){H(Ri,e=_c),H(Ti,t),_c=e|t.baseLanes}function Ii(){H(Ri,_c),H(Ti,Ti.current)}function Pi(){_c=Ri.current,z(Ti),z(Ri)}var Mi=L(null),Oi=null;function Ni(e){var t=e.alternate;H(zi,1&zi.current),H(Mi,e),null===Oi&&(null===t||null!==Ti.current||null!==t.memoizedState)&&(Oi=e)}function Di(e){H(zi,zi.current),H(Mi,e),null===Oi&&(Oi=e)}function Fi(e){22===e.tag?(H(zi,zi.current),H(Mi,e),null===Oi&&(Oi=e)):qi()}function qi(){H(zi,zi.current),H(Mi,Mi.current)}function Li(e){z(Mi),Oi===e&&(Oi=null),z(zi)}var zi=L(0);function Hi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Id(n)||Pd(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bi=0,Wi=null,Ui=null,Vi=null,Gi=!1,Qi=!1,Ki=!1,Yi=0,$i=0,Zi=null,Xi=0;function Ji(){throw Error(a(321))}function ea(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function ta(e,t,n,r,o,i){return Bi=i,Wi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,O.H=null===e||null===e.memoizedState?ms:ys,Ki=!1,i=n(r,o),Ki=!1,Qi&&(i=ra(t,n,r,o)),na(e),i}function na(e){O.H=gs;var t=null!==Ui&&null!==Ui.next;if(Bi=0,Vi=Ui=Wi=null,Gi=!1,$i=0,Zi=null,t)throw Error(a(300));null===e||Ms||null!==(e=e.dependencies)&&Io(e)&&(Ms=!0)}function ra(e,t,n,r){Wi=e;var o=0;do{if(Qi&&(Zi=null),$i=0,Qi=!1,25<=o)throw Error(a(301));if(o+=1,Vi=Ui=null,null!=e.updateQueue){var i=e.updateQueue;i.lastEffect=null,i.events=null,i.stores=null,null!=i.memoCache&&(i.memoCache.index=0)}O.H=vs,i=t(n,r)}while(Qi);return i}function oa(){var e=O.H,t=e.useState()[0];return t="function"===typeof t.then?ua(t):t,e=e.useState()[0],(null!==Ui?Ui.memoizedState:null)!==e&&(Wi.flags|=1024),t}function ia(){var e=0!==Yi;return Yi=0,e}function aa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function sa(e){if(Gi){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Gi=!1}Bi=0,Vi=Ui=Wi=null,Qi=!1,$i=Yi=0,Zi=null}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Vi?Wi.memoizedState=Vi=e:Vi=Vi.next=e,Vi}function ca(){if(null===Ui){var e=Wi.alternate;e=null!==e?e.memoizedState:null}else e=Ui.next;var t=null===Vi?Wi.memoizedState:Vi.next;if(null!==t)Vi=t,Ui=e;else{if(null===e){if(null===Wi.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Ui=e).memoizedState,baseState:Ui.baseState,baseQueue:Ui.baseQueue,queue:Ui.queue,next:null},null===Vi?Wi.memoizedState=Vi=e:Vi=Vi.next=e}return Vi}function ua(e){var t=$i;return $i+=1,null===Zi&&(Zi=[]),e=ri(Zi,e,t),t=Wi,null===(null===Vi?t.memoizedState:Vi.next)&&(t=t.alternate,O.H=null===t||null===t.memoizedState?ms:ys),e}function da(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return ua(e);if(e.$$typeof===w)return Mo(e)}throw Error(a(438,String(e)))}function ha(e){var t=null,n=Wi.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Wi.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Wi.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=T;return t.index++,n}function pa(e,t){return"function"===typeof t?t(e):t}function fa(e){return ga(ca(),Ui,e)}function ga(e,t,n){var r=e.queue;if(null===r)throw Error(a(311));r.lastRenderedReducer=n;var o=e.baseQueue,i=r.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}t.baseQueue=o=i,r.pending=null}if(i=e.baseState,null===o)e.memoizedState=i;else{var l=s=null,c=null,u=t=o.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(mc&h)===h:(Bi&h)===h){var p=u.revertLane;if(0===p)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Uo&&(d=!0);else{if((Bi&p)===p){u=u.next,p===Uo&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,s=i):c=c.next=h,Wi.lanes|=p,Sc|=p}h=u.action,Ki&&n(i,h),i=u.hasEagerState?u.eagerState:n(i,h)}else p={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=p,s=i):c=c.next=p,Wi.lanes|=h,Sc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?s=i:c.next=l,!Xn(i,e.memoizedState)&&(Ms=!0,d&&null!==(n=Vo)))throw n;e.memoizedState=i,e.baseState=s,e.baseQueue=c,r.lastRenderedState=i}return null===o&&(r.lanes=0),[e.memoizedState,r.dispatch]}function ma(e){var t=ca(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);Xn(i,t.memoizedState)||(Ms=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ya(e,t,n){var r=Wi,o=ca(),i=ho;if(i){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Xn((Ui||o).memoizedState,n);if(s&&(o.memoizedState=n,Ms=!0),o=o.queue,Ba(xa.bind(null,r,o,e),[e]),o.getSnapshot!==t||s||null!==Vi&&1&Vi.memoizedState.tag){if(r.flags|=2048,Fa(9,{destroy:void 0},ba.bind(null,r,o,n,t),null),null===fc)throw Error(a(349));i||0!==(127&Bi)||va(r,t,n)}return n}function va(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Wi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Wi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ba(e,t,n,r){t.value=n,t.getSnapshot=r,wa(t)&&_a(e)}function xa(e,t,n){return n(function(){wa(t)&&_a(e)})}function wa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(r){return!0}}function _a(e){var t=Mr(e,2);null!==t&&Kc(t,e,2)}function ka(e){var t=la();if("function"===typeof e){var n=e;if(e=n(),Ki){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:e},t}function Sa(e,t,n,r){return e.baseState=n,ga(e,Ui,"function"===typeof r?r:pa)}function Ca(e,t,n,r,o){if(hs(e))throw Error(a(485));if(null!==(e=t.action)){var i={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){i.listeners.push(e)}};null!==O.T?n(!0):i.isTransition=!1,r(i),null===(n=t.pending)?(i.next=t.pending=i,Aa(t,i)):(i.next=n.next,t.pending=n.next=i)}}function Aa(e,t){var n=t.action,r=t.payload,o=e.state;if(t.isTransition){var i=O.T,a={};O.T=a;try{var s=n(o,r),l=O.S;null!==l&&l(a,s),Ea(e,t,s)}catch(c){Ra(e,t,c)}finally{null!==i&&null!==a.types&&(i.types=a.types),O.T=i}}else try{Ea(e,t,i=n(o,r))}catch(u){Ra(e,t,u)}}function Ea(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Ta(e,t,n)},function(n){return Ra(e,t,n)}):Ta(e,t,n)}function Ta(e,t,n){t.status="fulfilled",t.value=n,ja(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Aa(e,n)))}function Ra(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ja(t),t=t.next}while(t!==r)}e.action=null}function ja(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ia(e,t){return t}function Pa(e,t){if(ho){var n=fc.formState;if(null!==n){e:{var r=Wi;if(ho){if(uo){t:{for(var o=uo,i=fo;8!==o.nodeType;){if(!i){o=null;break t}if(null===(o=Md(o.nextSibling))){o=null;break t}}o="F!"===(i=o.data)||"F"===i?o:null}if(o){uo=Md(o.nextSibling),r="F!"===o.data;break e}}mo(r)}r=!1}r&&(t=n[0])}}return(n=la()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ia,lastRenderedState:t},n.queue=r,n=cs.bind(null,Wi,r),r.dispatch=n,r=ka(!1),i=ds.bind(null,Wi,!1,r.queue),o={state:t,dispatch:null,action:e,pending:null},(r=la()).queue=o,n=Ca.bind(null,Wi,o,i,n),o.dispatch=n,r.memoizedState=e,[t,n,!1]}function Ma(e){return Oa(ca(),Ui,e)}function Oa(e,t,n){if(t=ga(e,t,Ia)[0],e=fa(pa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=ua(t)}catch(a){if(a===Xo)throw ei;throw a}else r=t;var o=(t=ca()).queue,i=o.dispatch;return n!==t.memoizedState&&(Wi.flags|=2048,Fa(9,{destroy:void 0},Na.bind(null,o,n),null)),[r,i,e]}function Na(e,t){e.action=t}function Da(e){var t=ca(),n=Ui;if(null!==n)return Oa(t,n,e);ca(),t=t.memoizedState;var r=(n=ca()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Fa(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=Wi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Wi.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function qa(){return ca().memoizedState}function La(e,t,n,r){var o=la();Wi.flags|=e,o.memoizedState=Fa(1|t,{destroy:void 0},n,void 0===r?null:r)}function za(e,t,n,r){var o=ca();r=void 0===r?null:r;var i=o.memoizedState.inst;null!==Ui&&null!==r&&ea(r,Ui.memoizedState.deps)?o.memoizedState=Fa(t,i,n,r):(Wi.flags|=e,o.memoizedState=Fa(1|t,i,n,r))}function Ha(e,t){La(8390656,8,e,t)}function Ba(e,t){za(2048,8,e,t)}function Wa(e){var t=ca().memoizedState;return function(e){Wi.flags|=4;var t=Wi.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Wi.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pc))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Ua(e,t){return za(4,2,e,t)}function Va(e,t){return za(4,4,e,t)}function Ga(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Qa(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,za(4,4,Ga.bind(null,t,e),n)}function Ka(){}function Ya(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&ea(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $a(e,t){var n=ca();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&ea(t,r[1]))return r[0];if(r=e(),Ki){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r}function Za(e,t,n){return void 0===n||0!==(1073741824&Bi)&&0===(261930&mc)?e.memoizedState=t:(e.memoizedState=n,e=Qc(),Wi.lanes|=e,Sc|=e,n)}function Xa(e,t,n,r){return Xn(n,t)?n:null!==Ti.current?(e=Za(e,n,r),Xn(e,t)||(Ms=!0),e):0===(42&Bi)||0!==(1073741824&Bi)&&0===(261930&mc)?(Ms=!0,e.memoizedState=n):(e=Qc(),Wi.lanes|=e,Sc|=e,t)}function Ja(e,t,n,r,o){var i=N.p;N.p=0!==i&&8>i?i:8;var a=O.T,s={};O.T=s,ds(e,!1,t,n);try{var l=o(),c=O.S;if(null!==c&&c(s,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)us(e,t,function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r),Gc());else us(e,t,r,Gc())}catch(u){us(e,t,{then:function(){},status:"rejected",reason:u},Gc())}finally{N.p=i,null!==a&&null!==s.types&&(a.types=s.types),O.T=a}}function es(){}function ts(e,t,n,r){if(5!==e.tag)throw Error(a(476));var o=ns(e).queue;Ja(e,o,t,D,null===n?es:function(){return rs(e),n(r)})}function ns(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:D,baseState:D,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:D},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rs(e){var t=ns(e);null===t.next&&(t=e.alternate.memoizedState),us(e,t.next.queue,{},Gc())}function os(){return Mo(uh)}function is(){return ca().memoizedState}function as(){return ca().memoizedState}function ss(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gc(),r=xi(t,e=bi(n),n);return null!==r&&(Kc(r,t,n),wi(r,t,n)),t={cache:zo()},void(e.payload=t)}t=t.return}}function ls(e,t,n){var r=Gc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},hs(e)?ps(t,n):null!==(n=Pr(e,t,n,r))&&(Kc(n,e,r),fs(n,t,r))}function cs(e,t,n){us(e,t,n,Gc())}function us(e,t,n,r){var o={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(hs(e))ps(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,Xn(s,a))return Ir(e,t,o,0),null===fc&&jr(),!1}catch(l){}if(null!==(n=Pr(e,t,o,r)))return Kc(n,e,r),fs(n,t,r),!0}return!1}function ds(e,t,n,r){if(r={lane:2,revertLane:Bu(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},hs(e)){if(t)throw Error(a(479))}else null!==(t=Pr(e,n,r,2))&&Kc(t,e,2)}function hs(e){var t=e.alternate;return e===Wi||null!==t&&t===Wi}function ps(e,t){Qi=Gi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function fs(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Oe(e,n)}}var gs={readContext:Mo,use:da,useCallback:Ji,useContext:Ji,useEffect:Ji,useImperativeHandle:Ji,useLayoutEffect:Ji,useInsertionEffect:Ji,useMemo:Ji,useReducer:Ji,useRef:Ji,useState:Ji,useDebugValue:Ji,useDeferredValue:Ji,useTransition:Ji,useSyncExternalStore:Ji,useId:Ji,useHostTransitionStatus:Ji,useFormState:Ji,useActionState:Ji,useOptimistic:Ji,useMemoCache:Ji,useCacheRefresh:Ji};gs.useEffectEvent=Ji;var ms={readContext:Mo,use:da,useCallback:function(e,t){return la().memoizedState=[e,void 0===t?null:t],e},useContext:Mo,useEffect:Ha,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,La(4194308,4,Ga.bind(null,t,e),n)},useLayoutEffect:function(e,t){return La(4194308,4,e,t)},useInsertionEffect:function(e,t){La(4,2,e,t)},useMemo:function(e,t){var n=la();t=void 0===t?null:t;var r=e();if(Ki){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=la();if(void 0!==n){var o=n(t);if(Ki){be(!0);try{n(t)}finally{be(!1)}}}else o=t;return r.memoizedState=r.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},r.queue=e,e=e.dispatch=ls.bind(null,Wi,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},la().memoizedState=e},useState:function(e){var t=(e=ka(e)).queue,n=cs.bind(null,Wi,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ka,useDeferredValue:function(e,t){return Za(la(),e,t)},useTransition:function(){var e=ka(!1);return e=Ja.bind(null,Wi,e.queue,!0,!1),la().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Wi,o=la();if(ho){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===fc)throw Error(a(349));0!==(127&mc)||va(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Ha(xa.bind(null,r,i,e),[e]),r.flags|=2048,Fa(9,{destroy:void 0},ba.bind(null,r,i,n,t),null),n},useId:function(){var e=la(),t=fc.identifierPrefix;if(ho){var n=ro;t="_"+t+"R_"+(n=(no&~(1<<32-xe(no)-1)).toString(32)+n),0<(n=Yi++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Xi++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:os,useFormState:Pa,useActionState:Pa,useOptimistic:function(e){var t=la();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ds.bind(null,Wi,!0,n),n.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return la().memoizedState=ss.bind(null,Wi)},useEffectEvent:function(e){var t=la(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pc))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},ys={readContext:Mo,use:da,useCallback:Ya,useContext:Mo,useEffect:Ba,useImperativeHandle:Qa,useInsertionEffect:Ua,useLayoutEffect:Va,useMemo:$a,useReducer:fa,useRef:qa,useState:function(){return fa(pa)},useDebugValue:Ka,useDeferredValue:function(e,t){return Xa(ca(),Ui.memoizedState,e,t)},useTransition:function(){var e=fa(pa)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:ya,useId:is,useHostTransitionStatus:os,useFormState:Ma,useActionState:Ma,useOptimistic:function(e,t){return Sa(ca(),0,e,t)},useMemoCache:ha,useCacheRefresh:as};ys.useEffectEvent=Wa;var vs={readContext:Mo,use:da,useCallback:Ya,useContext:Mo,useEffect:Ba,useImperativeHandle:Qa,useInsertionEffect:Ua,useLayoutEffect:Va,useMemo:$a,useReducer:ma,useRef:qa,useState:function(){return ma(pa)},useDebugValue:Ka,useDeferredValue:function(e,t){var n=ca();return null===Ui?Za(n,e,t):Xa(n,Ui.memoizedState,e,t)},useTransition:function(){var e=ma(pa)[0],t=ca().memoizedState;return["boolean"===typeof e?e:ua(e),t]},useSyncExternalStore:ya,useId:is,useHostTransitionStatus:os,useFormState:Da,useActionState:Da,useOptimistic:function(e,t){var n=ca();return null!==Ui?Sa(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ha,useCacheRefresh:as};function bs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}vs.useEffectEvent=Wa;var xs={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gc(),o=bi(r);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=xi(e,o,r))&&(Kc(t,e,r),wi(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gc(),o=bi(r);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),null!==(t=xi(e,o,r))&&(Kc(t,e,r),wi(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gc(),r=bi(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=xi(e,r,n))&&(Kc(t,e,n),wi(t,e,n))}};function ws(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!Jn(n,r)||!Jn(o,i))}function _s(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&xs.enqueueReplaceState(t,t.state,null)}function ks(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var o in n===t&&(n=p({},n)),e)void 0===n[o]&&(n[o]=e[o]);return n}function Ss(e){Ar(e)}function Cs(e){console.error(e)}function As(e){Ar(e)}function Es(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Ts(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Rs(e,t,n){return(n=bi(n)).tag=3,n.payload={element:null},n.callback=function(){Es(e,t)},n}function js(e){return(e=bi(e)).tag=3,e}function Is(e,t,n,r){var o=n.type.getDerivedStateFromError;if("function"===typeof o){var i=r.value;e.payload=function(){return o(i)},e.callback=function(){Ts(t,n,r)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Ts(t,n,r),"function"!==typeof o&&(null===Dc?Dc=new Set([this]):Dc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ps=Error(a(461)),Ms=!1;function Os(e,t,n,r){t.child=null===e?gi(t,null,n,r):fi(t,e.child,n,r)}function Ns(e,t,n,r,o){n=n.render;var i=t.ref;if("ref"in r){var a={};for(var s in r)"ref"!==s&&(a[s]=r[s])}else a=r;return Po(t),r=ta(e,t,n,a,i,o),s=ia(),null===e||Ms?(ho&&s&&ao(t),t.flags|=1,Os(e,t,r,o),t.child):(aa(e,t,o),ol(e,t,o))}function Ds(e,t,n,r,o){if(null===e){var i=n.type;return"function"!==typeof i||Lr(i)||void 0!==i.defaultProps||null!==n.compare?((e=Br(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Fs(e,t,i,r,o))}if(i=e.child,!il(e,o)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:Jn)(a,r)&&e.ref===t.ref)return ol(e,t,o)}return t.flags|=1,(e=zr(i,r)).ref=t.ref,e.return=t,t.child=e}function Fs(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(Jn(i,r)&&e.ref===t.ref){if(Ms=!1,t.pendingProps=r=i,!il(e,o))return t.lanes=e.lanes,ol(e,t,o);0!==(131072&e.flags)&&(Ms=!0)}}return Us(e,t,n,r,o)}function qs(e,t,n,r){var o=r.children,i=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(i=null!==i?i.baseLanes|n:n,null!==e){for(r=t.child=e.child,o=0;null!==r;)o=o|r.lanes|r.childLanes,r=r.sibling;r=o&~i}else r=0,t.child=null;return zs(e,t,i,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,zs(e,t,null!==i?i.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&$o(0,null!==i?i.cachePool:null),null!==i?ji(t,i):Ii(),Fi(t)}else null!==i?($o(0,i.cachePool),ji(t,i),qi(),t.memoizedState=null):(null!==e&&$o(0,null),Ii(),qi());return Os(e,t,o,n),t.child}function Ls(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function zs(e,t,n,r,o){var i=Yo();return i=null===i?null:{parent:Lo._currentValue,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&$o(0,null),Ii(),Fi(t),null!==e&&jo(e,t,r,!0),t.childLanes=o,null}function Hs(e,t){return(t=Js({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Bs(e,t,n){return fi(t,e.child,null,n),(e=Hs(t,t.pendingProps)).flags|=2,Li(t),t.memoizedState=null,e}function Ws(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Us(e,t,n,r,o){return Po(t),n=ta(e,t,n,r,void 0,o),r=ia(),null===e||Ms?(ho&&r&&ao(t),t.flags|=1,Os(e,t,n,o),t.child):(aa(e,t,o),ol(e,t,o))}function Vs(e,t,n,r,o,i){return Po(t),t.updateQueue=null,n=ra(t,r,n,o),na(e),r=ia(),null===e||Ms?(ho&&r&&ao(t),t.flags|=1,Os(e,t,n,i),t.child):(aa(e,t,i),ol(e,t,i))}function Gs(e,t,n,r,o){if(Po(t),null===t.stateNode){var i=Dr,a=n.contextType;"object"===typeof a&&null!==a&&(i=Mo(a)),i=new n(r,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=xs,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=r,i.state=t.memoizedState,i.refs={},yi(t),a=n.contextType,i.context="object"===typeof a&&null!==a?Mo(a):Dr,i.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(bs(t,n,a,r),i.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(a=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),a!==i.state&&xs.enqueueReplaceState(i,i.state,null),Ci(t,r,i,o),Si(),i.state=t.memoizedState),"function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){i=t.stateNode;var s=t.memoizedProps,l=ks(n,s);i.props=l;var c=i.context,u=n.contextType;a=Dr,"object"===typeof u&&null!==u&&(a=Mo(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(s||c!==a)&&_s(t,i,r,a),mi=!1;var h=t.memoizedState;i.state=h,Ci(t,r,i,o),Si(),c=t.memoizedState,s||h!==c||mi?("function"===typeof d&&(bs(t,n,d,r),c=t.memoizedState),(l=mi||ws(t,n,l,r,h,c,a))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=a,r=l):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,vi(e,t),u=ks(n,a=t.memoizedProps),i.props=u,d=t.pendingProps,h=i.context,c=n.contextType,l=Dr,"object"===typeof c&&null!==c&&(l=Mo(c)),(c="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(a!==d||h!==l)&&_s(t,i,r,l),mi=!1,h=t.memoizedState,i.state=h,Ci(t,r,i,o),Si();var p=t.memoizedState;a!==d||h!==p||mi||null!==e&&null!==e.dependencies&&Io(e.dependencies)?("function"===typeof s&&(bs(t,n,s,r),p=t.memoizedState),(u=mi||ws(t,n,u,r,h,p,l)||null!==e&&null!==e.dependencies&&Io(e.dependencies))?(c||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,p,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),i.props=r,i.state=p,i.context=l,r=u):("function"!==typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return i=r,Ws(e,t),r=0!==(128&t.flags),i||r?(i=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&r?(t.child=fi(t,e.child,null,o),t.child=fi(t,null,n,o)):Os(e,t,n,o),t.memoizedState=i.state,e=t.child):e=ol(e,t,o),e}function Qs(e,t,n,r){return xo(),t.flags|=256,Os(e,t,n,r),t.child}var Ks={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ys(e){return{baseLanes:e,cachePool:Zo()}}function $s(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ec),e}function Zs(e,t,n){var r,o=t.pendingProps,i=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&zi.current)),r&&(i=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(ho){if(i?Ni(t):qi(),(e=uo)?null!==(e=null!==(e=jd(e,fo))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==to?{id:no,overflow:ro}:null,retryLane:536870912,hydrationErrors:null},(n=Vr(e)).return=t,t.child=n,co=t,uo=null):e=null,null===e)throw mo(t);return Pd(e)?t.lanes=32:t.lanes=536870912,null}var l=o.children;return o=o.fallback,i?(qi(),l=Js({mode:"hidden",children:l},i=t.mode),o=Wr(o,i,n,null),l.return=t,o.return=t,l.sibling=o,t.child=l,(o=t.child).memoizedState=Ys(n),o.childLanes=$s(e,r,n),t.memoizedState=Ks,Ls(null,o)):(Ni(t),Xs(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(s)256&t.flags?(Ni(t),t.flags&=-257,t=el(e,t,n)):null!==t.memoizedState?(qi(),t.child=e.child,t.flags|=128,t=null):(qi(),l=o.fallback,i=t.mode,o=Js({mode:"visible",children:o.children},i),(l=Wr(l,i,n,null)).flags|=2,o.return=t,l.return=t,o.sibling=l,t.child=o,fi(t,e.child,null,n),(o=t.child).memoizedState=Ys(n),o.childLanes=$s(e,r,n),t.memoizedState=Ks,t=Ls(null,o));else if(Ni(t),Pd(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(o=Error(a(419))).stack="",o.digest=r,_o({value:o,source:null,stack:null}),t=el(e,t,n)}else if(Ms||jo(e,t,n,!1),r=0!==(n&e.childLanes),Ms||r){if(null!==(r=fc)&&(0!==(o=Ne(r,n))&&o!==c.retryLane))throw c.retryLane=o,Mr(e,o),Kc(r,e,o),Ps;Id(l)||au(),t=el(e,t,n)}else Id(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,uo=Md(l.nextSibling),co=t,ho=!0,po=null,fo=!1,null!==e&&lo(t,e),(t=Xs(t,o.children)).flags|=4096);return t}return i?(qi(),l=o.fallback,i=t.mode,u=(c=e.child).sibling,(o=zr(c,{mode:"hidden",children:o.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=zr(u,l):(l=Wr(l,i,n,null)).flags|=2,l.return=t,o.return=t,o.sibling=l,t.child=o,Ls(null,o),o=t.child,null===(l=e.child.memoizedState)?l=Ys(n):(null!==(i=l.cachePool)?(c=Lo._currentValue,i=i.parent!==c?{parent:c,pool:c}:i):i=Zo(),l={baseLanes:l.baseLanes|n,cachePool:i}),o.memoizedState=l,o.childLanes=$s(e,r,n),t.memoizedState=Ks,Ls(e.child,o)):(Ni(t),e=(n=e.child).sibling,(n=zr(n,{mode:"visible",children:o.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function Xs(e,t){return(t=Js({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Js(e,t){return(e=qr(22,e,null,t)).lanes=0,e}function el(e,t,n){return fi(t,e.child,null,n),(e=Xs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function tl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),To(e.return,t,n)}function nl(e,t,n,r,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,treeForkCount:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o,a.treeForkCount=i)}function rl(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;r=r.children;var a=zi.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,H(zi,a),Os(e,t,r,n),r=ho?Xr:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&tl(e,n,t);else if(19===e.tag)tl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Hi(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),nl(t,!1,o,n,i,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Hi(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}nl(t,!0,n,null,i,r);break;case"together":nl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function ol(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Sc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(jo(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=zr(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zr(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function il(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Io(e))}function al(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ms=!0;else{if(!il(e,n)&&0===(128&t.flags))return Ms=!1,function(e,t,n){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),Ao(0,Lo,e.memoizedState.cache),xo();break;case 27:case 5:$(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:Ao(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Di(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Ni(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zs(e,t,n):(Ni(t),null!==(e=ol(e,t,n))?e.sibling:null);Ni(t);break;case 19:var o=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(jo(e,t,n,!1),r=0!==(n&t.childLanes)),o){if(r)return rl(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),H(zi,zi.current),r)break;return null;case 22:return t.lanes=0,qs(e,t,n,t.pendingProps);case 24:Ao(0,Lo,e.memoizedState.cache)}return ol(e,t,n)}(e,t,n);Ms=0!==(131072&e.flags)}else Ms=!1,ho&&0!==(1048576&t.flags)&&io(t,Xr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=oi(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var o=e.$$typeof;if(o===_){t.tag=11,t=Ns(null,t,e,r,n);break e}if(o===C){t.tag=14,t=Ds(null,t,e,r,n);break e}}throw t=P(e)||e,Error(a(306,t,""))}Lr(e)?(r=ks(e,r),t.tag=1,t=Gs(null,t,e,r,n)):(t.tag=0,t=Us(null,t,e,r,n))}return t;case 0:return Us(e,t,t.type,t.pendingProps,n);case 1:return Gs(e,t,r=t.type,o=ks(r,t.pendingProps),n);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(a(387));r=t.pendingProps;var i=t.memoizedState;o=i.element,vi(e,t),Ci(t,r,null,n);var s=t.memoizedState;if(r=s.cache,Ao(0,Lo,r),r!==i.cache&&Ro(t,[Lo],n,!0),Si(),r=s.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Qs(e,t,r,n);break e}if(r!==o){_o(o=Kr(Error(a(424)),t)),t=Qs(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(uo=Md(e.firstChild),co=t,ho=!0,po=null,fo=!0,n=gi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(xo(),r===o){t=ol(e,t,n);break e}Os(e,t,r,n)}t=t.child}return t;case 26:return Ws(e,t),null===e?(n=Vd(t.type,null,t.pendingProps,null))?t.memoizedState=n:ho||(n=t.type,e=t.pendingProps,(r=md(G.current).createElement(n))[He]=t,r[Be]=e,hd(r,n,e),et(r),t.stateNode=r):t.memoizedState=Vd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&ho&&(r=t.stateNode=Fd(t.type,t.pendingProps,G.current),co=t,fo=!0,o=uo,Ad(t.type)?(Od=o,uo=Md(r.firstChild)):uo=o),Os(e,t,t.pendingProps.children,n),Ws(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ho&&((o=r=uo)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var o=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ke])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==o.rel||e.getAttribute("href")!==(null==o.href||""===o.href?null:o.href)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin)||e.getAttribute("title")!==(null==o.title?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==o.src?null:o.src)||e.getAttribute("type")!==(null==o.type?null:o.type)||e.getAttribute("crossorigin")!==(null==o.crossOrigin?null:o.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==o.name?null:""+o.name;if("hidden"===o.type&&e.getAttribute("name")===i)return e}if(null===(e=Md(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,fo))?(t.stateNode=r,co=t,uo=Md(r.firstChild),fo=!1,o=!0):o=!1),o||mo(t)),$(t),o=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,r=i.children,bd(o,i)?r=null:null!==s&&bd(o,s)&&(t.flags|=32),null!==t.memoizedState&&(o=ta(e,t,oa,null,null,n),uh._currentValue=o),Ws(e,t),Os(e,t,r,n),t.child;case 6:return null===e&&ho&&((e=n=uo)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Md(e.nextSibling)))return null}return e}(n,t.pendingProps,fo))?(t.stateNode=n,co=t,uo=null,e=!0):e=!1),e||mo(t)),null;case 13:return Zs(e,t,n);case 4:return K(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=fi(t,null,r,n):Os(e,t,r,n),t.child;case 11:return Ns(e,t,t.type,t.pendingProps,n);case 7:return Os(e,t,t.pendingProps,n),t.child;case 8:case 12:return Os(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Ao(0,t.type,r.value),Os(e,t,r.children,n),t.child;case 9:return o=t.type._context,r=t.pendingProps.children,Po(t),r=r(o=Mo(o)),t.flags|=1,Os(e,t,r,n),t.child;case 14:return Ds(e,t,t.type,t.pendingProps,n);case 15:return Fs(e,t,t.type,t.pendingProps,n);case 19:return rl(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,o=0!==(128&t.flags);if(t.flags&=-129,null===e){if(ho){if("hidden"===r.mode)return e=Hs(t,r),t.lanes=536870912,Ls(null,e);if(Di(t),(e=uo)?null!==(e=null!==(e=jd(e,fo))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==to?{id:no,overflow:ro}:null,retryLane:536870912,hydrationErrors:null},(n=Vr(e)).return=t,t.child=n,co=t,uo=null):e=null,null===e)throw mo(t);return t.lanes=536870912,null}return Hs(t,r)}var i=e.memoizedState;if(null!==i){var s=i.dehydrated;if(Di(t),o)if(256&t.flags)t.flags&=-257,t=Bs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ms||jo(e,t,n,!1),o=0!==(n&e.childLanes),Ms||o){if(null!==(r=fc)&&0!==(s=Ne(r,n))&&s!==i.retryLane)throw i.retryLane=s,Mr(e,s),Kc(r,e,s),Ps;au(),t=Bs(e,t,n)}else e=i.treeContext,uo=Md(s.nextSibling),co=t,ho=!0,po=null,fo=!1,null!==e&&lo(t,e),(t=Hs(t,r)).flags|=4096;return t}return(e=zr(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return qs(e,t,n,t.pendingProps);case 24:return Po(t),r=Mo(Lo),null===e?(null===(o=Yo())&&(o=fc,i=zo(),o.pooledCache=i,i.refCount++,null!==i&&(o.pooledCacheLanes|=n),o=i),t.memoizedState={parent:r,cache:o},yi(t),Ao(0,Lo,o)):(0!==(e.lanes&n)&&(vi(e,t),Ci(t,null,null,n),Si()),o=e.memoizedState,i=t.memoizedState,o.parent!==r?(o={parent:r,cache:r},t.memoizedState=o,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=o),Ao(0,Lo,r)):(r=i.cache,Ao(0,Lo,r),r!==o.cache&&Ro(t,[Lo],n,!0))),Os(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function sl(e){e.flags|=4}function ll(e,t,n,r,o){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&o)===o)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw ii=ti,Jo;e.flags|=8192}}else e.flags&=-16777217}function cl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!oh(t)){if(!ru())throw ii=ti,Jo;e.flags|=8192}}function ul(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?je():536870912,e.lanes|=t,Tc|=t)}function dl(e,t){if(!ho)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function hl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=65011712&o.subtreeFlags,r|=65011712&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function pl(e,t,n){var r=t.pendingProps;switch(so(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return hl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Eo(Lo),Y(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(bo(t)?sl(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,wo())),hl(t),null;case 26:var o=t.type,i=t.memoizedState;return null===e?(sl(t),null!==i?(hl(t),cl(t,i)):(hl(t),ll(t,o,0,0,n))):i?i!==e.memoizedState?(sl(t),hl(t),cl(t,i)):(hl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&sl(t),hl(t),ll(t,o,0,0,n)),null;case 27:if(Z(t),n=G.current,o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}e=U.current,bo(t)?yo(t):(e=Fd(o,r,n),t.stateNode=e,sl(t))}return hl(t),null;case 5:if(Z(t),o=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if(!r){if(null===t.stateNode)throw Error(a(166));return hl(t),null}if(i=U.current,bo(t))yo(t);else{var s=md(G.current);switch(i){case 1:i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":i=s.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":i=s.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":(i=s.createElement("div")).innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i="string"===typeof r.is?s.createElement("select",{is:r.is}):s.createElement("select"),r.multiple?i.multiple=!0:r.size&&(i.size=r.size);break;default:i="string"===typeof r.is?s.createElement(o,{is:r.is}):s.createElement(o)}}i[He]=t,i[Be]=r;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)i.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=i;e:switch(hd(i,o,r),o){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&sl(t)}}return hl(t),ll(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&sl(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(e=G.current,bo(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(o=co))switch(o.tag){case 27:case 5:r=o.memoizedProps}e[He]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||cd(e.nodeValue,n)))||mo(t,!0)}else(e=md(e).createTextNode(r))[He]=t,t.stateNode=e}return hl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=bo(t),null!==n){if(null===e){if(!r)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[He]=t}else xo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),e=!1}else n=wo(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Li(t),t):(Li(t),null);if(0!==(128&t.flags))throw Error(a(558))}return hl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(o=bo(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[He]=t}else xo(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;hl(t),o=!1}else o=wo(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return 256&t.flags?(Li(t),t):(Li(t),null)}return Li(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(o=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(o=r.alternate.memoizedState.cachePool.pool),i=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(i=r.memoizedState.cachePool.pool),i!==o&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),ul(t,t.updateQueue),hl(t),null);case 4:return Y(),null===e&&Ju(t.stateNode.containerInfo),hl(t),null;case 10:return Eo(t.type),hl(t),null;case 19:if(z(zi),null===(r=t.memoizedState))return hl(t),null;if(o=0!==(128&t.flags),null===(i=r.rendering))if(o)dl(r,!1);else{if(0!==kc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(i=Hi(e))){for(t.flags|=128,dl(r,!1),e=i.updateQueue,t.updateQueue=e,ul(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Hr(n,e),n=n.sibling;return H(zi,1&zi.current|2),ho&&oo(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Oc&&(t.flags|=128,o=!0,dl(r,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=Hi(i))){if(t.flags|=128,o=!0,e=e.updateQueue,t.updateQueue=e,ul(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!ho)return hl(t),null}else 2*le()-r.renderingStartTime>Oc&&536870912!==n&&(t.flags|=128,o=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=zi.current,H(zi,o?1&n|2:1&n),ho&&oo(t,r.treeForkCount),e):(hl(t),null);case 22:case 23:return Li(t),Pi(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(hl(t),6&t.subtreeFlags&&(t.flags|=8192)):hl(t),null!==(n=t.updateQueue)&&ul(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&z(Ko),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Eo(Lo),hl(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function fl(e,t){switch(so(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Eo(Lo),Y(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Z(t),null;case 31:if(null!==t.memoizedState){if(Li(t),null===t.alternate)throw Error(a(340));xo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Li(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));xo()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return z(zi),null;case 4:return Y(),null;case 10:return Eo(t.type),null;case 22:case 23:return Li(t),Pi(),null!==e&&z(Ko),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Eo(Lo),null;default:return null}}function gl(e,t){switch(so(t),t.tag){case 3:Eo(Lo),Y();break;case 26:case 27:case 5:Z(t);break;case 4:Y();break;case 31:null!==t.memoizedState&&Li(t);break;case 13:Li(t);break;case 19:z(zi);break;case 10:Eo(t.type);break;case 22:case 23:Li(t),Pi(),null!==e&&z(Ko);break;case 24:Eo(Lo)}}function ml(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var o=r.next;n=o;do{if((n.tag&e)===e){r=void 0;var i=n.create,a=n.inst;r=i(),a.destroy=r}n=n.next}while(n!==o)}}catch(s){ku(t,t.return,s)}}function yl(e,t,n){try{var r=t.updateQueue,o=null!==r?r.lastEffect:null;if(null!==o){var i=o.next;r=i;do{if((r.tag&e)===e){var a=r.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,o=t;var l=n,c=s;try{c()}catch(u){ku(o,l,u)}}}r=r.next}while(r!==i)}}catch(u){ku(t,t.return,u)}}function vl(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ei(t,n)}catch(r){ku(e,e.return,r)}}}function bl(e,t,n){n.props=ks(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(r){ku(e,t,r)}}function xl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(o){ku(e,t,o)}}function wl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(o){ku(e,t,o)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){ku(e,t,i)}else n.current=null}function _l(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(o){ku(e,e.return,o)}}function kl(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,i=null,s=null,l=null,c=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(f)||ud(e,t,f,null,r,h)}}for(var p in r){var f=r[p];if(h=n[p],r.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":i=f;break;case"name":o=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":l=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==h&&ud(e,t,p,f,r,h)}}return void vt(e,s,l,c,u,d,i,o);case"select":for(i in f=s=l=p=null,n)if(c=n[i],n.hasOwnProperty(i)&&null!=c)switch(i){case"value":break;case"multiple":f=c;default:r.hasOwnProperty(i)||ud(e,t,i,null,r,c)}for(o in r)if(i=r[o],c=n[o],r.hasOwnProperty(o)&&(null!=i||null!=c))switch(o){case"value":p=i;break;case"defaultValue":l=i;break;case"multiple":s=i;default:i!==c&&ud(e,t,o,i,r,c)}return t=l,n=s,r=f,void(null!=p?wt(e,!!n,p,!1):!!r!==!!n&&(null!=t?wt(e,!!n,t,!0):wt(e,!!n,n?[]:"",!1)));case"textarea":for(l in f=p=null,n)if(o=n[l],n.hasOwnProperty(l)&&null!=o&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:ud(e,t,l,null,r,o)}for(s in r)if(o=r[s],i=n[s],r.hasOwnProperty(s)&&(null!=o||null!=i))switch(s){case"value":p=o;break;case"defaultValue":f=o;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(a(91));break;default:o!==i&&ud(e,t,s,o,r,i)}return void _t(e,p,f);case"option":for(var g in n)if(p=n[g],n.hasOwnProperty(g)&&null!=p&&!r.hasOwnProperty(g))if("selected"===g)e.selected=!1;else ud(e,t,g,null,r,p);for(c in r)if(p=r[c],f=n[c],r.hasOwnProperty(c)&&p!==f&&(null!=p||null!=f))if("selected"===c)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else ud(e,t,c,p,r,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in n)p=n[m],n.hasOwnProperty(m)&&null!=p&&!r.hasOwnProperty(m)&&ud(e,t,m,null,r,p);for(u in r)if(p=r[u],f=n[u],r.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:ud(e,t,u,p,r,f)}return;default:if(Tt(t)){for(var y in n)p=n[y],n.hasOwnProperty(y)&&void 0!==p&&!r.hasOwnProperty(y)&&dd(e,t,y,void 0,r,p);for(d in r)p=r[d],f=n[d],!r.hasOwnProperty(d)||p===f||void 0===p&&void 0===f||dd(e,t,d,p,r,f);return}}for(var v in n)p=n[v],n.hasOwnProperty(v)&&null!=p&&!r.hasOwnProperty(v)&&ud(e,t,v,null,r,p);for(h in r)p=r[h],f=n[h],!r.hasOwnProperty(h)||p===f||null==p&&null==f||ud(e,t,h,p,r,f)}(r,e.type,n,t),r[Be]=t}catch(o){ku(e,e.return,o)}}function Sl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ad(e.type)||4===e.tag}function Cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Sl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ad(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Pt));else if(4!==r&&(27===r&&Ad(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Al(e,t,n),e=e.sibling;null!==e;)Al(e,t,n),e=e.sibling}function El(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Ad(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(El(e,t,n),e=e.sibling;null!==e;)El(e,t,n),e=e.sibling}function Tl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);hd(t,r,n),t[He]=e,t[Be]=n}catch(i){ku(e,e.return,i)}}var Rl=!1,jl=!1,Il=!1,Pl="function"===typeof WeakSet?WeakSet:Set,Ml=null;function Ol(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Kl(e,n),4&r&&ml(5,n);break;case 1:if(Kl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){ku(n,n.return,a)}else{var o=ks(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){ku(n,n.return,s)}}64&r&&vl(n),512&r&&xl(n,n.return);break;case 3:if(Kl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ei(e,t)}catch(a){ku(n,n.return,a)}}break;case 27:null===t&&4&r&&Tl(n);case 26:case 5:Kl(e,n),null===t&&4&r&&_l(n),512&r&&xl(n,n.return);break;case 12:Kl(e,n);break;case 31:Kl(e,n),4&r&&zl(e,n);break;case 13:Kl(e,n),4&r&&Hl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Eu.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Rl)){t=null!==t&&null!==t.memoizedState||jl,o=Rl;var i=jl;Rl=r,(jl=t)&&!i?$l(e,n,0!==(8772&n.subtreeFlags)):Kl(e,n),Rl=o,jl=i}break;case 30:break;default:Kl(e,n)}}function Nl(e){var t=e.alternate;null!==t&&(e.alternate=null,Nl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ye(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Dl=null,Fl=!1;function ql(e,t,n){for(n=n.child;null!==n;)Ll(e,t,n),n=n.sibling}function Ll(e,t,n){if(ve&&"function"===typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(ye,n)}catch(i){}switch(n.tag){case 26:jl||wl(n,t),ql(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:jl||wl(n,t);var r=Dl,o=Fl;Ad(n.type)&&(Dl=n.stateNode,Fl=!1),ql(e,t,n),qd(n.stateNode),Dl=r,Fl=o;break;case 5:jl||wl(n,t);case 6:if(r=Dl,o=Fl,Dl=null,ql(e,t,n),Fl=o,null!==(Dl=r))if(Fl)try{(9===Dl.nodeType?Dl.body:"HTML"===Dl.nodeName?Dl.ownerDocument.body:Dl).removeChild(n.stateNode)}catch(a){ku(n,t,a)}else try{Dl.removeChild(n.stateNode)}catch(a){ku(n,t,a)}break;case 18:null!==Dl&&(Fl?(Ed(9===(e=Dl).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Uh(e)):Ed(Dl,n.stateNode));break;case 4:r=Dl,o=Fl,Dl=n.stateNode.containerInfo,Fl=!0,ql(e,t,n),Dl=r,Fl=o;break;case 0:case 11:case 14:case 15:yl(2,n,t),jl||yl(4,n,t),ql(e,t,n);break;case 1:jl||(wl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),ql(e,t,n);break;case 21:ql(e,t,n);break;case 22:jl=(r=jl)||null!==n.memoizedState,ql(e,t,n),jl=r;break;default:ql(e,t,n)}}function zl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Uh(e)}catch(n){ku(t,t.return,n)}}}function Hl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Uh(e)}catch(n){ku(t,t.return,n)}}function Bl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Pl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Pl),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Tu.bind(null,e,t);t.then(r,r)}})}function Wl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r],i=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 27:if(Ad(l.type)){Dl=l.stateNode,Fl=!1;break e}break;case 5:Dl=l.stateNode,Fl=!1;break e;case 3:case 4:Dl=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===Dl)throw Error(a(160));Ll(i,s,o),Dl=null,Fl=!1,null!==(i=o.alternate)&&(i.return=null),o.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Vl(t,e),t=t.sibling}var Ul=null;function Vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Wl(t,e),Gl(e),4&r&&(yl(3,e,e.return),ml(3,e),yl(5,e,e.return));break;case 1:Wl(t,e),Gl(e),512&r&&(jl||null===n||wl(n,n.return)),64&r&&Rl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var o=Ul;if(Wl(t,e),Gl(e),512&r&&(jl||null===n||wl(n,n.return)),4&r){var i=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,o=o.ownerDocument||o;t:switch(r){case"title":(!(i=o.getElementsByTagName("title")[0])||i[Ke]||i[He]||"http://www.w3.org/2000/svg"===i.namespaceURI||i.hasAttribute("itemprop"))&&(i=o.createElement(r),o.head.insertBefore(i,o.querySelector("head > title"))),hd(i,r,n),i[He]=e,et(i),r=i;break e;case"link":var s=nh("link","href",o).get(r+(n.href||""));if(s)for(var l=0;l<s.length;l++)if((i=s[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&i.getAttribute("rel")===(null==n.rel?null:n.rel)&&i.getAttribute("title")===(null==n.title?null:n.title)&&i.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(l,1);break t}hd(i=o.createElement(r),r,n),o.head.appendChild(i);break;case"meta":if(s=nh("meta","content",o).get(r+(n.content||"")))for(l=0;l<s.length;l++)if((i=s[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&i.getAttribute("name")===(null==n.name?null:n.name)&&i.getAttribute("property")===(null==n.property?null:n.property)&&i.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&i.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(l,1);break t}hd(i=o.createElement(r),r,n),o.head.appendChild(i);break;default:throw Error(a(468,r))}i[He]=e,et(i),r=i}e.stateNode=r}else rh(o,e.type,e.stateNode);else e.stateNode=Zd(o,r,e.memoizedProps);else i!==r?(null===i?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):i.count--,null===r?rh(o,e.type,e.stateNode):Zd(o,r,e.memoizedProps)):null===r&&null!==e.stateNode&&kl(e,e.memoizedProps,n.memoizedProps)}break;case 27:Wl(t,e),Gl(e),512&r&&(jl||null===n||wl(n,n.return)),null!==n&&4&r&&kl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Wl(t,e),Gl(e),512&r&&(jl||null===n||wl(n,n.return)),32&e.flags){o=e.stateNode;try{St(o,"")}catch(g){ku(e,e.return,g)}}4&r&&null!=e.stateNode&&kl(e,o=e.memoizedProps,null!==n?n.memoizedProps:o),1024&r&&(Il=!0);break;case 6:if(Wl(t,e),Gl(e),4&r){if(null===e.stateNode)throw Error(a(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(g){ku(e,e.return,g)}}break;case 3:if(th=null,o=Ul,Ul=Hd(t.containerInfo),Wl(t,e),Ul=o,Gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Uh(t.containerInfo)}catch(g){ku(e,e.return,g)}Il&&(Il=!1,Ql(e));break;case 4:r=Ul,Ul=Hd(e.stateNode.containerInfo),Wl(t,e),Gl(e),Ul=r;break;case 12:default:Wl(t,e),Gl(e);break;case 31:case 19:Wl(t,e),Gl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Bl(e,r)));break;case 13:Wl(t,e),Gl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Pc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,Bl(e,r)));break;case 22:o=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=Rl,d=jl;if(Rl=u||o,jl=d||c,Wl(t,e),jl=d,Rl=u,Gl(e),8192&r)e:for(t=e.stateNode,t._visibility=o?-2&t._visibility:1|t._visibility,o&&(null===n||c||Rl||jl||Yl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(i=c.stateNode,o)"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{l=c.stateNode;var h=c.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;l.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(g){ku(c,c.return,g)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=o?"":c.memoizedProps}catch(g){ku(c,c.return,g)}}}else if(18===t.tag){if(null===n){c=t;try{var f=c.stateNode;o?Td(f,!0):Td(c.stateNode,!1)}catch(g){ku(c,c.return,g)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,Bl(e,n))));case 30:case 21:}}function Gl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(Sl(r)){n=r;break}r=r.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var o=n.stateNode;El(e,Cl(e),o);break;case 5:var i=n.stateNode;32&n.flags&&(St(i,""),n.flags&=-33),El(e,Cl(e),i);break;case 3:case 4:var s=n.stateNode.containerInfo;Al(e,Cl(e),s);break;default:throw Error(a(161))}}catch(l){ku(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Ql(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Ql(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Kl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Ol(e,t.alternate,t),t=t.sibling}function Yl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Yl(t);break;case 1:wl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),Yl(t);break;case 27:qd(t.stateNode);case 26:case 5:wl(t,t.return),Yl(t);break;case 22:null===t.memoizedState&&Yl(t);break;default:Yl(t)}e=e.sibling}}function $l(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,o=e,i=t,a=i.flags;switch(i.tag){case 0:case 11:case 15:$l(o,i,n),ml(4,i);break;case 1:if($l(o,i,n),"function"===typeof(o=(r=i).stateNode).componentDidMount)try{o.componentDidMount()}catch(c){ku(r,r.return,c)}if(null!==(o=(r=i).updateQueue)){var s=r.stateNode;try{var l=o.shared.hiddenCallbacks;if(null!==l)for(o.shared.hiddenCallbacks=null,o=0;o<l.length;o++)Ai(l[o],s)}catch(c){ku(r,r.return,c)}}n&&64&a&&vl(i),xl(i,i.return);break;case 27:Tl(i);case 26:case 5:$l(o,i,n),n&&null===r&&4&a&&_l(i),xl(i,i.return);break;case 12:$l(o,i,n);break;case 31:$l(o,i,n),n&&4&a&&zl(o,i);break;case 13:$l(o,i,n),n&&4&a&&Hl(o,i);break;case 22:null===i.memoizedState&&$l(o,i,n),xl(i,i.return);break;case 30:break;default:$l(o,i,n)}t=t.sibling}}function Zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Ho(n))}function Xl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ho(e))}function Jl(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)ec(e,t,n,r),t=t.sibling}function ec(e,t,n,r){var o=t.flags;switch(t.tag){case 0:case 11:case 15:Jl(e,t,n,r),2048&o&&ml(9,t);break;case 1:case 31:case 13:default:Jl(e,t,n,r);break;case 3:Jl(e,t,n,r),2048&o&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Ho(e)));break;case 12:if(2048&o){Jl(e,t,n,r),e=t.stateNode;try{var i=t.memoizedProps,a=i.id,s=i.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ku(t,t.return,l)}}else Jl(e,t,n,r);break;case 23:break;case 22:i=t.stateNode,a=t.alternate,null!==t.memoizedState?2&i._visibility?Jl(e,t,n,r):nc(e,t):2&i._visibility?Jl(e,t,n,r):(i._visibility|=2,tc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&o&&Zl(a,t);break;case 24:Jl(e,t,n,r),2048&o&&Xl(t.alternate,t)}}function tc(e,t,n,r,o){for(o=o&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var i=e,a=t,s=n,l=r,c=a.flags;switch(a.tag){case 0:case 11:case 15:tc(i,a,s,l,o),ml(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?tc(i,a,s,l,o):nc(i,a):(u._visibility|=2,tc(i,a,s,l,o)),o&&2048&c&&Zl(a.alternate,a);break;case 24:tc(i,a,s,l,o),o&&2048&c&&Xl(a.alternate,a);break;default:tc(i,a,s,l,o)}t=t.sibling}}function nc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,o=r.flags;switch(r.tag){case 22:nc(n,r),2048&o&&Zl(r.alternate,r);break;case 24:nc(n,r),2048&o&&Xl(r.alternate,r);break;default:nc(n,r)}t=t.sibling}}var rc=8192;function oc(e,t,n){if(e.subtreeFlags&rc)for(e=e.child;null!==e;)ic(e,t,n),e=e.sibling}function ic(e,t,n){switch(e.tag){case 26:oc(e,t,n),e.flags&rc&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var o=Gd(r.href),i=t.querySelector(Qd(o));if(i)return null!==(t=i._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=ah.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=i,void et(i);i=t.ownerDocument||t,r=Kd(r),(o=Ld.get(o))&&Jd(r,o),et(i=i.createElement("link"));var a=i;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),hd(i,"link",r),n.instance=i}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=ah.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Ul,e.memoizedState,e.memoizedProps);break;case 5:default:oc(e,t,n);break;case 3:case 4:var r=Ul;Ul=Hd(e.stateNode.containerInfo),oc(e,t,n),Ul=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=rc,rc=16777216,oc(e,t,n),rc=r):oc(e,t,n))}}function ac(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function sc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,uc(r,e)}ac(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)lc(e),e=e.sibling}function lc(e){switch(e.tag){case 0:case 11:case 15:sc(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:sc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,cc(e)):sc(e)}}function cc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ml=r,uc(r,e)}ac(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),cc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,cc(t));break;default:cc(t)}e=e.sibling}}function uc(e,t){for(;null!==Ml;){var n=Ml;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Ho(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ml=r;else e:for(n=e;null!==Ml;){var o=(r=Ml).sibling,i=r.return;if(Nl(r),r===n){Ml=null;break e}if(null!==o){o.return=i,Ml=o;break e}Ml=i}}}var dc={getCacheForType:function(e){var t=Mo(Lo),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Mo(Lo).controller.signal}},hc="function"===typeof WeakMap?WeakMap:Map,pc=0,fc=null,gc=null,mc=0,yc=0,vc=null,bc=!1,xc=!1,wc=!1,_c=0,kc=0,Sc=0,Cc=0,Ac=0,Ec=0,Tc=0,Rc=null,jc=null,Ic=!1,Pc=0,Mc=0,Oc=1/0,Nc=null,Dc=null,Fc=0,qc=null,Lc=null,zc=0,Hc=0,Bc=null,Wc=null,Uc=0,Vc=null;function Gc(){return 0!==(2&pc)&&0!==mc?mc&-mc:null!==O.T?Bu():qe()}function Qc(){if(0===Ec)if(0===(536870912&mc)||ho){var e=Se;0===(3932160&(Se<<=1))&&(Se=262144),Ec=e}else Ec=536870912;return null!==(e=Mi.current)&&(e.flags|=32),Ec}function Kc(e,t,n){(e!==fc||2!==yc&&9!==yc)&&null===e.cancelPendingCommit||(tu(e,0),Xc(e,mc,Ec,!1)),Pe(e,n),0!==(2&pc)&&e===fc||(e===fc&&(0===(2&pc)&&(Cc|=n),4===kc&&Xc(e,mc,Ec,!1)),Nu(e))}function Yc(e,t,n){if(0!==(6&pc))throw Error(a(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Te(e,t),o=r?function(e,t){var n=pc;pc|=2;var r=ou(),o=iu();fc!==e||mc!==t?(Nc=null,Oc=le()+500,tu(e,t)):xc=Te(e,t);e:for(;;)try{if(0!==yc&&null!==gc){t=gc;var i=vc;t:switch(yc){case 1:yc=0,vc=null,hu(e,t,i,1);break;case 2:case 9:if(ni(i)){yc=0,vc=null,du(t);break}t=function(){2!==yc&&9!==yc||fc!==e||(yc=7),Nu(e)},i.then(t,t);break e;case 3:yc=7;break e;case 4:yc=5;break e;case 7:ni(i)?(yc=0,vc=null,du(t)):(yc=0,vc=null,hu(e,t,i,7));break;case 5:var s=null;switch(gc.tag){case 26:s=gc.memoizedState;case 5:case 27:var l=gc;if(s?oh(s):l.stateNode.complete){yc=0,vc=null;var c=l.sibling;if(null!==c)gc=c;else{var u=l.return;null!==u?(gc=u,pu(u)):gc=null}break t}}yc=0,vc=null,hu(e,t,i,5);break;case 6:yc=0,vc=null,hu(e,t,i,6);break;case 8:eu(),kc=6;break e;default:throw Error(a(462))}}cu();break}catch(d){nu(e,d)}return Co=So=null,O.H=r,O.A=o,pc=n,null!==gc?0:(fc=null,mc=0,jr(),kc)}(e,t):su(e,t,!0),i=r;;){if(0===o){xc&&!r&&Xc(e,t,0,!1);break}if(n=e.current.alternate,!i||Zc(n)){if(2===o){if(i=t,e.errorRecoveryDisabledLanes&i)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var l=e;o=Rc;var c=l.current.memoizedState.isDehydrated;if(c&&(tu(l,s).flags|=256),2!==(s=su(l,s,!1))){if(wc&&!c){l.errorRecoveryDisabledLanes|=i,Cc|=i,o=4;break e}i=jc,jc=o,null!==i&&(null===jc?jc=i:jc.push.apply(jc,i))}o=s}if(i=!1,2!==o)continue}}if(1===o){tu(e,0),Xc(e,t,0,!0);break}e:{switch(r=e,i=o){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Xc(r,t,Ec,!bc);break e;case 2:jc=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(o=Pc+300-le())){if(Xc(r,t,Ec,!bc),0!==Ee(r,0,!0))break e;zc=t,r.timeoutHandle=wd($c.bind(null,r,n,jc,Nc,Ic,t,Ec,Cc,Tc,bc,i,"Throttled",-0,0),o)}else $c(r,n,jc,Nc,Ic,t,Ec,Cc,Tc,bc,i,null,-0,0)}break}o=su(e,t,!1),i=!1}Nu(e)}function $c(e,t,n,r,o,i,a,s,l,c,u,d,h,p){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){ic(t,i,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Pt});var f=(62914560&i)===i?Pc-le():(4194048&i)===i?Mc-le():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ih&&(ih=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var o=n[r],i=o.transferSize,a=o.initiatorType,s=o.duration;if(i&&s&&pd(a)){for(a=0,s=o.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>s)break;var u=l.transferSize,d=l.initiatorType;u&&pd(d)&&(a+=u*((l=l.responseEnd)<s?1:(s-c)/(l-c)))}if(--r,t+=8*(i+a)/(o.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var o=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ih?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(o)}}:null}(d,f)))return zc=i,e.cancelPendingCommit=f(gu.bind(null,e,t,i,n,r,o,a,s,l,u,d,null,h,p)),void Xc(e,i,a,!c)}gu(e,t,i,n,r,o,a,s,l)}function Zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!Xn(i(),o))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xc(e,t,n,r){t&=~Ac,t&=~Cc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var o=t;0<o;){var i=31-xe(o),a=1<<i;r[i]=-1,o&=~a}0!==n&&Me(e,n,t)}function Jc(){return 0!==(6&pc)||(Du(0,!1),!1)}function eu(){if(null!==gc){if(0===yc)var e=gc.return;else Co=So=null,sa(e=gc),li=null,ci=0,e=gc;for(;null!==e;)gl(e.alternate,e),e=e.return;gc=null}}function tu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,_d(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zc=0,eu(),fc=e,gc=n=zr(e.current,null),mc=t,yc=0,vc=null,bc=!1,xc=Te(e,t),wc=!1,Tc=Ec=Ac=Cc=Sc=kc=0,jc=Rc=null,Ic=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var o=31-xe(r),i=1<<o;t|=e[o],r&=~i}return _c=t,jr(),n}function nu(e,t){Wi=null,O.H=gs,t===Xo||t===ei?(t=ai(),yc=3):t===Jo?(t=ai(),yc=4):yc=t===Ps?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,vc=t,null===gc&&(kc=1,Es(e,Kr(t,e.current)))}function ru(){var e=Mi.current;return null===e||((4194048&mc)===mc?null===Oi:((62914560&mc)===mc||0!==(536870912&mc))&&e===Oi)}function ou(){var e=O.H;return O.H=gs,null===e?gs:e}function iu(){var e=O.A;return O.A=dc,e}function au(){kc=4,bc||(4194048&mc)!==mc&&null!==Mi.current||(xc=!0),0===(134217727&Sc)&&0===(134217727&Cc)||null===fc||Xc(fc,mc,Ec,!1)}function su(e,t,n){var r=pc;pc|=2;var o=ou(),i=iu();fc===e&&mc===t||(Nc=null,tu(e,t)),t=!1;var a=kc;e:for(;;)try{if(0!==yc&&null!==gc){var s=gc,l=vc;switch(yc){case 8:eu(),a=6;break e;case 3:case 2:case 9:case 6:null===Mi.current&&(t=!0);var c=yc;if(yc=0,vc=null,hu(e,s,l,c),n&&xc){a=0;break e}break;default:c=yc,yc=0,vc=null,hu(e,s,l,c)}}lu(),a=kc;break}catch(u){nu(e,u)}return t&&e.shellSuspendCounter++,Co=So=null,pc=r,O.H=o,O.A=i,null===gc&&(fc=null,mc=0,jr()),a}function lu(){for(;null!==gc;)uu(gc)}function cu(){for(;null!==gc&&!ae();)uu(gc)}function uu(e){var t=al(e.alternate,e,_c);e.memoizedProps=e.pendingProps,null===t?pu(e):gc=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Vs(n,t,t.pendingProps,t.type,void 0,mc);break;case 11:t=Vs(n,t,t.pendingProps,t.type.render,t.ref,mc);break;case 5:sa(t);default:gl(n,t),t=al(n,t=gc=Hr(t,_c),_c)}e.memoizedProps=e.pendingProps,null===t?pu(e):gc=t}function hu(e,t,n,r){Co=So=null,sa(t),li=null,ci=0;var o=t.return;try{if(function(e,t,n,r,o){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&jo(t,n,o,!0),null!==(n=Mi.current)){switch(n.tag){case 31:case 13:return null===Oi?au():null===n.alternate&&0===kc&&(kc=3),n.flags&=-257,n.flags|=65536,n.lanes=o,r===ti?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Su(e,r,o)),!1;case 22:return n.flags|=65536,r===ti?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Su(e,r,o)),!1}throw Error(a(435,n.tag))}return Su(e,r,o),au(),!1}if(ho)return null!==(t=Mi.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=o,r!==go&&_o(Kr(e=Error(a(422),{cause:r}),n))):(r!==go&&_o(Kr(t=Error(a(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,o&=-o,e.lanes|=o,r=Kr(r,n),_i(e,o=Rs(e.stateNode,r,o)),4!==kc&&(kc=2)),!1;var i=Error(a(520),{cause:r});if(i=Kr(i,n),null===Rc?Rc=[i]:Rc.push(i),4!==kc&&(kc=2),null===t)return!0;r=Kr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=o&-o,n.lanes|=e,_i(n,e=Rs(n.stateNode,r,e)),!1;case 1:if(t=n.type,i=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==i&&"function"===typeof i.componentDidCatch&&(null===Dc||!Dc.has(i))))return n.flags|=65536,o&=-o,n.lanes|=o,Is(o=js(o),e,n,r),_i(n,o),!1}n=n.return}while(null!==n);return!1}(e,o,t,n,mc))return kc=1,Es(e,Kr(n,e.current)),void(gc=null)}catch(i){if(null!==o)throw gc=o,i;return kc=1,Es(e,Kr(n,e.current)),void(gc=null)}32768&t.flags?(ho||1===r?e=!0:xc||0!==(536870912&mc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=Mi.current)&&13===r.tag&&(r.flags|=16384))),fu(t,e)):pu(t)}function pu(e){var t=e;do{if(0!==(32768&t.flags))return void fu(t,bc);e=t.return;var n=pl(t.alternate,t,_c);if(null!==n)return void(gc=n);if(null!==(t=t.sibling))return void(gc=t);gc=t=e}while(null!==t);0===kc&&(kc=5)}function fu(e,t){do{var n=fl(e.alternate,e);if(null!==n)return n.flags&=32767,void(gc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(gc=e);gc=e=n}while(null!==e);kc=6,gc=null}function gu(e,t,n,r,o,i,s,l,c){e.cancelPendingCommit=null;do{xu()}while(0!==Fc);if(0!==(6&pc))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(i=t.lanes|t.childLanes,function(e,t,n,r,o,i){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-xe(n),d=1<<u;s[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==r&&Me(e,r,0),0!==i&&0===o&&0!==e.tag&&(e.suspendedLanes|=i&~(a&~t))}(e,n,i|=Rr,s,l,c),e===fc&&(gc=fc=null,mc=0),Lc=t,qc=e,zc=n,Hc=i,Bc=o,Wc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,oe(he,function(){return wu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=O.T,O.T=null,o=N.p,N.p=2,s=pc,pc|=4;try{!function(e,t){if(e=e.containerInfo,fd=bh,or(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(m){n=null;break e}var s=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==o&&3!==h.nodeType||(l=s+o),h!==i||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===o&&(l=s),p===i&&++d===r&&(c=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(gd={focusedElem:e,selectionRange:n},bh=!1,Ml=t;null!==Ml;)if(e=(t=Ml).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ml=e;else for(;null!==Ml;){switch(i=(t=Ml).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(o=e[n]).ref.impl=o.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==i){e=void 0,n=t,o=i.memoizedProps,i=i.memoizedState,r=n.stateNode;try{var g=ks(n.type,o);e=r.getSnapshotBeforeUpdate(g,i),r.__reactInternalSnapshotBeforeUpdate=e}catch(y){ku(n,n.return,y)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Rd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Rd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Ml=e;break}Ml=t.return}}(e,t)}finally{pc=s,N.p=o,O.T=r}}Fc=1,mu(),yu(),vu()}}function mu(){if(1===Fc){Fc=0;var e=qc,t=Lc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=O.T,O.T=null;var r=N.p;N.p=2;var o=pc;pc|=4;try{Vl(t,e);var i=gd,a=rr(e.containerInfo),s=i.focusedElem,l=i.selectionRange;if(a!==s&&s&&s.ownerDocument&&nr(s.ownerDocument.documentElement,s)){if(null!==l&&or(s)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in s)s.selectionStart=c,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=s.textContent.length,g=Math.min(l.start,f),m=void 0===l.end?g:Math.min(l.end,f);!p.extend&&g>m&&(a=m,m=g,g=a);var y=tr(s,g),v=tr(s,m);if(y&&v&&(1!==p.rangeCount||p.anchorNode!==y.node||p.anchorOffset!==y.offset||p.focusNode!==v.node||p.focusOffset!==v.offset)){var b=d.createRange();b.setStart(y.node,y.offset),p.removeAllRanges(),g>m?(p.addRange(b),p.extend(v.node,v.offset)):(b.setEnd(v.node,v.offset),p.addRange(b))}}}}for(d=[],p=s;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var x=d[s];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}bh=!!fd,gd=fd=null}finally{pc=o,N.p=r,O.T=n}}e.current=t,Fc=2}}function yu(){if(2===Fc){Fc=0;var e=qc,t=Lc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=O.T,O.T=null;var r=N.p;N.p=2;var o=pc;pc|=4;try{Ol(e,t.alternate,t)}finally{pc=o,N.p=r,O.T=n}}Fc=3}}function vu(){if(4===Fc||3===Fc){Fc=0,se();var e=qc,t=Lc,n=zc,r=Wc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Fc=5:(Fc=0,Lc=qc=null,bu(e,e.pendingLanes));var o=e.pendingLanes;if(0===o&&(Dc=null),Fe(n),t=t.stateNode,ve&&"function"===typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(ye,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=O.T,o=N.p,N.p=2,O.T=null;try{for(var i=e.onRecoverableError,a=0;a<r.length;a++){var s=r[a];i(s.value,{componentStack:s.stack})}}finally{O.T=t,N.p=o}}0!==(3&zc)&&xu(),Nu(e),o=e.pendingLanes,0!==(261930&n)&&0!==(42&o)?e===Vc?Uc++:(Uc=0,Vc=e):Uc=0,Du(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Ho(t)))}function xu(){return mu(),yu(),vu(),wu()}function wu(){if(5!==Fc)return!1;var e=qc,t=Hc;Hc=0;var n=Fe(zc),r=O.T,o=N.p;try{N.p=32>n?32:n,O.T=null,n=Bc,Bc=null;var i=qc,s=zc;if(Fc=0,Lc=qc=null,zc=0,0!==(6&pc))throw Error(a(331));var l=pc;if(pc|=4,lc(i.current),ec(i,i.current,s,n),pc=l,Du(0,!1),ve&&"function"===typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(ye,i)}catch(c){}return!0}finally{N.p=o,O.T=r,bu(e,t)}}function _u(e,t,n){t=Kr(n,t),null!==(e=xi(e,t=Rs(e.stateNode,t,2),2))&&(Pe(e,2),Nu(e))}function ku(e,t,n){if(3===e.tag)_u(e,e,n);else for(;null!==t;){if(3===t.tag){_u(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Dc||!Dc.has(r))){e=Kr(n,e),null!==(r=xi(t,n=js(2),2))&&(Is(n,r,t,e),Pe(r,2),Nu(r));break}}t=t.return}}function Su(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hc;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(wc=!0,o.add(n),e=Cu.bind(null,e,t,n),t.then(e,e))}function Cu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,fc===e&&(mc&n)===n&&(4===kc||3===kc&&(62914560&mc)===mc&&300>le()-Pc?0===(2&pc)&&tu(e,0):Ac|=n,Tc===mc&&(Tc=0)),Nu(e)}function Au(e,t){0===t&&(t=je()),null!==(e=Mr(e,t))&&(Pe(e,t),Nu(e))}function Eu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Au(e,n)}function Tu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==r&&r.delete(t),Au(e,n)}var Ru=null,ju=null,Iu=!1,Pu=!1,Mu=!1,Ou=0;function Nu(e){e!==ju&&null===e.next&&(null===ju?Ru=ju=e:ju=ju.next=e),Pu=!0,Iu||(Iu=!0,Sd(function(){0!==(6&pc)?oe(ue,Fu):qu()}))}function Du(e,t){if(!Mu&&Pu){Mu=!0;do{for(var n=!1,r=Ru;null!==r;){if(!t)if(0!==e){var o=r.pendingLanes;if(0===o)var i=0;else{var a=r.suspendedLanes,s=r.pingedLanes;i=(1<<31-xe(42|e)+1)-1,i=201326741&(i&=o&~(a&~s))?201326741&i|1:i?2|i:0}0!==i&&(n=!0,Hu(r,i))}else i=mc,0===(3&(i=Ee(r,r===fc?i:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Te(r,i)||(n=!0,Hu(r,i));r=r.next}}while(n);Mu=!1}}function Fu(){qu()}function qu(){Pu=Iu=!1;var e=0;0!==Ou&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==xd&&(xd=e,!0);return xd=null,!1}()&&(e=Ou);for(var t=le(),n=null,r=Ru;null!==r;){var o=r.next,i=Lu(r,t);0===i?(r.next=null,null===n?Ru=o:n.next=o,null===o&&(ju=n)):(n=r,(0!==e||0!==(3&i))&&(Pu=!0)),r=o}0!==Fc&&5!==Fc||Du(e,!1),0!==Ou&&(Ou=0)}function Lu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var a=31-xe(i),s=1<<a,l=o[a];-1===l?0!==(s&n)&&0===(s&r)||(o[a]=Re(s,t)):l<=t&&(e.expiredLanes|=s),i&=~s}if(n=mc,n=Ee(e,e===(t=fc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===yc||9===yc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ie(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Te(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ie(r),Fe(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=fe}return r=zu.bind(null,e),n=oe(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ie(r),e.callbackPriority=2,e.callbackNode=null,2}function zu(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(xu()&&e.callbackNode!==n)return null;var r=mc;return 0===(r=Ee(e,e===fc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Yc(e,r,t),Lu(e,le()),null!=e.callbackNode&&e.callbackNode===n?zu.bind(null,e):null)}function Hu(e,t){if(xu())return null;Yc(e,t,!0)}function Bu(){if(0===Ou){var e=Uo;0===e&&(e=ke,0===(261888&(ke<<=1))&&(ke=256)),Ou=e}return Ou}function Wu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Uu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Vu=0;Vu<Sr.length;Vu++){var Gu=Sr[Vu];Cr(Gu.toLowerCase(),"on"+(Gu[0].toUpperCase()+Gu.slice(1)))}Cr(mr,"onAnimationEnd"),Cr(yr,"onAnimationIteration"),Cr(vr,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(br,"onTransitionRun"),Cr(xr,"onTransitionStart"),Cr(wr,"onTransitionCancel"),Cr(_r,"onTransitionEnd"),ot("onMouseEnter",["mouseout","mouseover"]),ot("onMouseLeave",["mouseout","mouseover"]),ot("onPointerEnter",["pointerout","pointerover"]),ot("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Qu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ku=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Qu));function Yu(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==i&&o.isPropagationStopped())break e;i=s,o.currentTarget=c;try{i(o)}catch(u){Ar(u)}o.currentTarget=null,i=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==i&&o.isPropagationStopped())break e;i=s,o.currentTarget=c;try{i(o)}catch(u){Ar(u)}o.currentTarget=null,i=l}}}}function $u(e,t){var n=t[Ue];void 0===n&&(n=t[Ue]=new Set);var r=e+"__bubble";n.has(r)||(ed(t,e,2,!1),n.add(r))}function Zu(e,t,n){var r=0;t&&(r|=4),ed(n,e,r,t)}var Xu="_reactListening"+Math.random().toString(36).slice(2);function Ju(e){if(!e[Xu]){e[Xu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Ku.has(t)||Zu(t,!1,e),Zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Xu]||(t[Xu]=!0,Zu("selectionchange",!1,t))}}function ed(e,t,n,r){switch(Ah(t)){case 2:var o=xh;break;case 8:o=wh;break;default:o=_h}n=o.bind(null,t,n,e),o=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function td(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&a.stateNode.containerInfo===o)return;a=a.return}for(;null!==s;){if(null===(a=$e(s)))return;if(5===(c=a.tag)||6===c||26===c||27===c){r=i=a;continue e}s=s.parentNode}}r=r.return}Lt(function(){var r=i,o=Ot(n),a=[];e:{var s=kr.get(e);if(void 0!==s){var c=nn,u=e;switch(e){case"keypress":if(0===Kt(n))break e;case"keydown":case"keyup":c=vn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=xn;break;case mr:case yr:case vr:c=un;break;case _r:c=wn;break;case"scroll":case"scrollend":c=on;break;case"wheel":c=_n;break;case"copy":case"cut":case"paste":c=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=bn;break;case"toggle":case"beforetoggle":c=kn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==s?s+"Capture":null:s;d=[];for(var f,g=r;null!==g;){var m=g;if(f=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===f||null===p||null!=(m=zt(g,p))&&d.push(nd(g,m,f)),h)break;g=g.return}0<d.length&&(s=new c(s,u,null,n,o),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===Mt||!(u=n.relatedTarget||n.fromElement)||!$e(u)&&!u[We])&&(c||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?$e(u):null)&&(h=l(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(c=null,u=r),c!==u)){if(d=sn,m="onMouseLeave",p="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,m="onPointerLeave",p="onPointerEnter",g="pointer"),h=null==c?s:Xe(c),f=null==u?s:Xe(u),(s=new d(m,g+"leave",c,n,o)).target=h,s.relatedTarget=f,m=null,$e(o)===r&&((d=new d(p,g+"enter",u,n,o)).target=f,d.relatedTarget=h,m=d),h=m,c&&u)e:{for(d=od,g=u,f=0,m=p=c;m;m=d(m))f++;m=0;for(var y=g;y;y=d(y))m++;for(;0<f-m;)p=d(p),f--;for(;0<m-f;)g=d(g),m--;for(;f--;){if(p===g||null!==g&&p===g.alternate){d=p;break e}p=d(p),g=d(g)}d=null}else d=null;null!==c&&id(a,s,c,d,!1),null!==u&&null!==h&&id(a,h,u,d,!0)}if("select"===(c=(s=r?Xe(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var v=Hn;else if(Nn(s))if(Bn)v=Zn;else{v=Yn;var b=Kn}else!(c=s.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?r&&Tt(r.elementType)&&(v=Hn):v=$n;switch(v&&(v=v(e,r))?Dn(a,v,n,o):(b&&b(e,s,r),"focusout"===e&&r&&"number"===s.type&&null!=r.memoizedProps.value&&xt(s,"number",s.value)),b=r?Xe(r):window,e){case"focusin":(Nn(b)||"true"===b.contentEditable)&&(ar=b,sr=r,lr=null);break;case"focusout":lr=sr=ar=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(a,n,o);break;case"selectionchange":if(ir)break;case"keydown":case"keyup":ur(a,n,o)}var x;if(Cn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Mn?In(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Tn&&"ko"!==n.locale&&(Mn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Mn&&(x=Qt()):(Vt="value"in(Ut=o)?Ut.value:Ut.textContent,Mn=!0)),0<(b=rd(r,w)).length&&(w=new hn(w,e,null,n,o),a.push({event:w,listeners:b}),x?w.data=x:null!==(x=Pn(n))&&(w.data=x))),(x=En?function(e,t){switch(e){case"compositionend":return Pn(t);case"keypress":return 32!==t.which?null:(jn=!0,Rn);case"textInput":return(e=t.data)===Rn&&jn?null:e;default:return null}}(e,n):function(e,t){if(Mn)return"compositionend"===e||!Cn&&In(e,t)?(e=Qt(),Gt=Vt=Ut=null,Mn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(w=rd(r,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,o),a.push({event:b,listeners:w}),b.data=x)),function(e,t,n,r,o){if("submit"===t&&n&&n.stateNode===o){var i=Wu((o[Be]||null).action),a=r.submitter;a&&null!==(t=(t=a[Be]||null)?Wu(t.formAction):a.getAttribute("formAction"))&&(i=t,a=null);var s=new nn("action","action",null,r,o);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Ou){var e=a?Uu(o,a):new FormData(o);ts(n,{pending:!0,data:e,method:o.method,action:i},null,e)}}else"function"===typeof i&&(s.preventDefault(),e=a?Uu(o,a):new FormData(o),ts(n,{pending:!0,data:e,method:o.method,action:i},i,e))},currentTarget:o}]})}}(a,e,r,n,o)}Yu(a,t)})}function nd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rd(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;if(5!==(o=o.tag)&&26!==o&&27!==o||null===i||(null!=(o=zt(e,n))&&r.unshift(nd(e,o,i)),null!=(o=zt(e,t))&&r.push(nd(e,o,i))),3===e.tag)return r;e=e.return}return[]}function od(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function id(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(s=s.tag,null!==l&&l===r)break;5!==s&&26!==s&&27!==s||null===c||(l=c,o?null!=(c=zt(n,i))&&a.unshift(nd(n,c,l)):o||null!=(c=zt(n,i))&&a.push(nd(n,c,l))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var ad=/\r\n?/g,sd=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(ad,"\n").replace(sd,"")}function cd(e,t){return t=ld(t),ld(e)===t}function ud(e,t,n,r,o,i){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||St(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&St(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":Et(e,r,i);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof i&&("formAction"===n?("input"!==t&&ud(e,t,"name",o.name,o,null),ud(e,t,"formEncType",o.formEncType,o,null),ud(e,t,"formMethod",o.formMethod,o,null),ud(e,t,"formTarget",o.formTarget,o,null)):(ud(e,t,"encType",o.encType,o,null),ud(e,t,"method",o.method,o,null),ud(e,t,"target",o.target,o,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=It(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Pt);break;case"onScroll":null!=r&&$u("scroll",e);break;case"onScrollEnd":null!=r&&$u("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=It(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":$u("beforetoggle",e),$u("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=Rt.get(n)||n,r)}}function dd(e,t,n,r,o,i){switch(n){case"style":Et(e,r,i);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(a(61));if(null!=(n=r.__html)){if(null!=o.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof r?St(e,r):("number"===typeof r||"bigint"===typeof r)&&St(e,""+r);break;case"onScroll":null!=r&&$u("scroll",e);break;case"onScrollEnd":null!=r&&$u("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Pt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(o=n.endsWith("Capture"),t=n.slice(2,o?n.length-7:void 0),"function"===typeof(i=null!=(i=e[Be]||null)?i[n]:null)&&e.removeEventListener(t,i,o),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof i&&null!==i&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,o)))}}function hd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$u("error",e),$u("load",e);var r,o=!1,i=!1;for(r in n)if(n.hasOwnProperty(r)){var s=n[r];if(null!=s)switch(r){case"src":o=!0;break;case"srcSet":i=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,r,s,n,null)}}return i&&ud(e,t,"srcSet",n.srcSet,n,null),void(o&&ud(e,t,"src",n.src,n,null));case"input":$u("invalid",e);var l=r=s=i=null,c=null,u=null;for(o in n)if(n.hasOwnProperty(o)){var d=n[o];if(null!=d)switch(o){case"name":i=d;break;case"type":s=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:ud(e,t,o,d,n,null)}}return void bt(e,r,l,c,u,s,i,!1);case"select":for(i in $u("invalid",e),o=s=r=null,n)if(n.hasOwnProperty(i)&&null!=(l=n[i]))switch(i){case"value":r=l;break;case"defaultValue":s=l;break;case"multiple":o=l;default:ud(e,t,i,l,n,null)}return t=r,n=s,e.multiple=!!o,void(null!=t?wt(e,!!o,t,!1):null!=n&&wt(e,!!o,n,!0));case"textarea":for(s in $u("invalid",e),r=i=o=null,n)if(n.hasOwnProperty(s)&&null!=(l=n[s]))switch(s){case"value":o=l;break;case"defaultValue":i=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(a(91));break;default:ud(e,t,s,l,n,null)}return void kt(e,o,i,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(o=n[c]))if("selected"===c)e.selected=o&&"function"!==typeof o&&"symbol"!==typeof o;else ud(e,t,c,o,n,null);return;case"dialog":$u("beforetoggle",e),$u("toggle",e),$u("cancel",e),$u("close",e);break;case"iframe":case"object":$u("load",e);break;case"video":case"audio":for(o=0;o<Qu.length;o++)$u(Qu[o],e);break;case"image":$u("error",e),$u("load",e);break;case"details":$u("toggle",e);break;case"embed":case"source":case"link":$u("error",e),$u("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(o=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:ud(e,t,u,o,n,null)}return;default:if(Tt(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(o=n[d])&&dd(e,t,d,o,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(o=n[l])&&ud(e,t,l,o,n,null))}function pd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var fd=null,gd=null;function md(e){return 9===e.nodeType?e:e.ownerDocument}function yd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var xd=null;var wd="function"===typeof setTimeout?setTimeout:void 0,_d="function"===typeof clearTimeout?clearTimeout:void 0,kd="function"===typeof Promise?Promise:void 0,Sd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof kd?function(e){return kd.resolve(null).then(e).catch(Cd)}:wd;function Cd(e){setTimeout(function(){throw e})}function Ad(e){return"head"===e}function Ed(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)||"/&"===n){if(0===r)return e.removeChild(o),void Uh(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)qd(e.ownerDocument.documentElement);else if("head"===n){qd(n=e.ownerDocument.head);for(var i=n.firstChild;i;){var a=i.nextSibling,s=i.nodeName;i[Ke]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===i.rel.toLowerCase()||n.removeChild(i),i=a}}else"body"===n&&qd(e.ownerDocument.body);n=o}while(n);Uh(t)}function Td(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Rd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Rd(n),Ye(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function jd(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Md(e.nextSibling)))return null}return e}function Id(e){return"$?"===e.data||"$~"===e.data}function Pd(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Md(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Od=null;function Nd(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Md(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Dd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Fd(e,t,n){switch(t=md(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function qd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ye(e)}var Ld=new Map,zd=new Set;function Hd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Bd=N.d;N.d={f:function(){var e=Bd.f(),t=Jc();return e||t},r:function(e){var t=Ze(e);null!==t&&5===t.tag&&"form"===t.type?rs(t):Bd.r(e)},D:function(e){Bd.D(e),Ud("dns-prefetch",e,null)},C:function(e,t){Bd.C(e,t),Ud("preconnect",e,t)},L:function(e,t,n){Bd.L(e,t,n);var r=Wd;if(r&&e&&t){var o='link[rel="preload"][as="'+yt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(o+='[imagesrcset="'+yt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(o+='[imagesizes="'+yt(n.imageSizes)+'"]')):o+='[href="'+yt(e)+'"]';var i=o;switch(t){case"style":i=Gd(e);break;case"script":i=Yd(e)}Ld.has(i)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Ld.set(i,e),null!==r.querySelector(o)||"style"===t&&r.querySelector(Qd(i))||"script"===t&&r.querySelector($d(i))||(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){Bd.m(e,t);var n=Wd;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",o='link[rel="modulepreload"][as="'+yt(r)+'"][href="'+yt(e)+'"]',i=o;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Yd(e)}if(!Ld.has(i)&&(e=p({rel:"modulepreload",href:e},t),Ld.set(i,e),null===n.querySelector(o))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector($d(i)))return}hd(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){Bd.X(e,t);var n=Wd;if(n&&e){var r=Je(n).hoistableScripts,o=Yd(e),i=r.get(o);i||((i=n.querySelector($d(o)))||(e=p({src:e,async:!0},t),(t=Ld.get(o))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}},S:function(e,t,n){Bd.S(e,t,n);var r=Wd;if(r&&e){var o=Je(r).hoistableStyles,i=Gd(e);t=t||"default";var a=o.get(i);if(!a){var s={loading:0,preload:null};if(a=r.querySelector(Qd(i)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Ld.get(i))&&Jd(e,n);var l=a=r.createElement("link");et(l),hd(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){s.loading|=1}),l.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Xd(a,t,r)}a={type:"stylesheet",instance:a,count:1,state:s},o.set(i,a)}}},M:function(e,t){Bd.M(e,t);var n=Wd;if(n&&e){var r=Je(n).hoistableScripts,o=Yd(e),i=r.get(o);i||((i=n.querySelector($d(o)))||(e=p({src:e,async:!0,type:"module"},t),(t=Ld.get(o))&&eh(e,t),et(i=n.createElement("script")),hd(i,"link",e),n.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},r.set(o,i))}}};var Wd="undefined"===typeof document?null:document;function Ud(e,t,n){var r=Wd;if(r&&"string"===typeof t&&t){var o=yt(t);o='link[rel="'+e+'"][href="'+o+'"]',"string"===typeof n&&(o+='[crossorigin="'+n+'"]'),zd.has(o)||(zd.add(o),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(o)&&(hd(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function Vd(e,t,n,r){var o,i,s,l,c=(c=G.current)?Hd(c):null;if(!c)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Gd(n.href),(r=(n=Je(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Gd(n.href);var u=Je(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Qd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Ld.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Ld.set(e,n),u||(o=c,i=e,s=n,l=d.state,o.querySelector('link[rel="preload"][as="style"]['+i+"]")?l.loading=1:(i=o.createElement("link"),l.preload=i,i.addEventListener("load",function(){return l.loading|=1}),i.addEventListener("error",function(){return l.loading|=2}),hd(i,"link",s),et(i),o.head.appendChild(i))))),t&&null===r)throw Error(a(528,""));return d}if(t&&null!==r)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Yd(n),(r=(n=Je(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Gd(e){return'href="'+yt(e)+'"'}function Qd(e){return'link[rel="stylesheet"]['+e+"]"}function Kd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Yd(e){return'[src="'+yt(e)+'"]'}function $d(e){return"script[async]"+e}function Zd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+yt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var o=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),hd(r,"style",o),Xd(r,n.precedence,e),t.instance=r;case"stylesheet":o=Gd(n.href);var i=e.querySelector(Qd(o));if(i)return t.state.loading|=4,t.instance=i,et(i),i;r=Kd(n),(o=Ld.get(o))&&Jd(r,o),et(i=(e.ownerDocument||e).createElement("link"));var s=i;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hd(i,"link",r),t.state.loading|=4,Xd(i,n.precedence,e),t.instance=i;case"script":return i=Yd(n.src),(o=e.querySelector($d(i)))?(t.instance=o,et(o),o):(r=n,(o=Ld.get(i))&&eh(r=p({},n),o),et(o=(e=e.ownerDocument||e).createElement("script")),hd(o,"link",r),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Xd(r,n.precedence,e));return t.instance}function Xd(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=r.length?r[r.length-1]:null,i=o,a=0;a<r.length;a++){var s=r[a];if(s.dataset.precedence===t)i=s;else if(i!==o)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function Jd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var th=null;function nh(e,t,n){if(null===th){var r=new Map,o=th=new Map;o.set(n,r)}else(r=(o=th).get(n))||(r=new Map,o.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),o=0;o<n.length;o++){var i=n[o];if(!(i[Ke]||i[He]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var a=i.getAttribute(t)||"";a=e+a;var s=r.get(a);s?s.push(i):r.set(a,[i])}}return r}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function oh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ih=0;function ah(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var sh=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,sh=new Map,t.forEach(ch,e),sh=null,ah.call(e))}function ch(e,t){if(!(4&t.state.loading)){var n=sh.get(e);if(n)var r=n.get(null);else{n=new Map,sh.set(e,n);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<o.length;i++){var a=o[i];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),r=a)}r&&n.set(null,r)}a=(o=t.instance).getAttribute("data-precedence"),(i=n.get(a)||r)===r&&n.set(null,o),n.set(a,o),this.count++,r=ah.bind(this),o.addEventListener("load",r),o.addEventListener("error",r),i?i.parentNode.insertBefore(o,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(o,e.firstChild),t.state.loading|=4}}var uh={$$typeof:w,Provider:null,Consumer:null,_currentValue:D,_currentValue2:D,_threadCount:0};function dh(e,t,n,r,o,i,a,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ie(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ie(0),this.hiddenUpdates=Ie(null),this.identifierPrefix=r,this.onUncaughtError=o,this.onCaughtError=i,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function hh(e,t,n,r,o,i,a,s,l,c,u,d){return e=new dh(e,t,n,a,l,c,u,d,s),t=1,!0===i&&(t|=24),i=qr(3,null,null,t),e.current=i,i.stateNode=e,(t=zo()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:r,isDehydrated:n,cache:t},yi(i),e}function ph(e){return e?e=Dr:Dr}function fh(e,t,n,r,o,i){o=ph(o),null===r.context?r.context=o:r.pendingContext=o,(r=bi(t)).payload={element:n},null!==(i=void 0===i?null:i)&&(r.callback=i),null!==(n=xi(e,r,t))&&(Kc(n,0,t),wi(n,e,t))}function gh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function mh(e,t){gh(e,t),(e=e.alternate)&&gh(e,t)}function yh(e){if(13===e.tag||31===e.tag){var t=Mr(e,67108864);null!==t&&Kc(t,0,67108864),mh(e,67108864)}}function vh(e){if(13===e.tag||31===e.tag){var t=Gc(),n=Mr(e,t=De(t));null!==n&&Kc(n,0,t),mh(e,t)}}var bh=!0;function xh(e,t,n,r){var o=O.T;O.T=null;var i=N.p;try{N.p=2,_h(e,t,n,r)}finally{N.p=i,O.T=o}}function wh(e,t,n,r){var o=O.T;O.T=null;var i=N.p;try{N.p=8,_h(e,t,n,r)}finally{N.p=i,O.T=o}}function _h(e,t,n,r){if(bh){var o=kh(r);if(null===o)td(e,t,r,Sh,n),Nh(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Th=Dh(Th,e,t,n,r,o),!0;case"dragenter":return Rh=Dh(Rh,e,t,n,r,o),!0;case"mouseover":return jh=Dh(jh,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ih.set(i,Dh(Ih.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Ph.set(i,Dh(Ph.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Nh(e,r),4&t&&-1<Oh.indexOf(e)){for(;null!==o;){var i=Ze(o);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var a=Ae(i.pendingLanes);if(0!==a){var s=i;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var l=1<<31-xe(a);s.entanglements[1]|=l,a&=~l}Nu(i),0===(6&pc)&&(Oc=le()+500,Du(0,!1))}}break;case 31:case 13:null!==(s=Mr(i,2))&&Kc(s,0,2),Jc(),mh(i,2)}if(null===(i=kh(r))&&td(e,t,r,Sh,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else td(e,t,r,null,n)}}function kh(e){return Ch(e=Ot(e))}var Sh=null;function Ch(e){if(Sh=null,null!==(e=$e(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Sh=e,null}function Ah(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var Eh=!1,Th=null,Rh=null,jh=null,Ih=new Map,Ph=new Map,Mh=[],Oh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Nh(e,t){switch(e){case"focusin":case"focusout":Th=null;break;case"dragenter":case"dragleave":Rh=null;break;case"mouseover":case"mouseout":jh=null;break;case"pointerover":case"pointerout":Ih.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ph.delete(t.pointerId)}}function Dh(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=Ze(t))&&yh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Fh(e){var t=$e(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void Le(e.priority,function(){vh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Le(e.priority,function(){vh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function qh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=kh(e.nativeEvent);if(null!==n)return null!==(t=Ze(n))&&yh(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Mt=r,n.target.dispatchEvent(r),Mt=null,t.shift()}return!0}function Lh(e,t,n){qh(e)&&n.delete(t)}function zh(){Eh=!1,null!==Th&&qh(Th)&&(Th=null),null!==Rh&&qh(Rh)&&(Rh=null),null!==jh&&qh(jh)&&(jh=null),Ih.forEach(Lh),Ph.forEach(Lh)}function Hh(e,t){e.blockedOn===t&&(e.blockedOn=null,Eh||(Eh=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zh)))}var Bh=null;function Wh(e){Bh!==e&&(Bh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Bh===e&&(Bh=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],o=e[t+2];if("function"!==typeof r){if(null===Ch(r||n))continue;break}var i=Ze(n);null!==i&&(e.splice(t,3),t-=3,ts(i,{pending:!0,data:o,method:n.method,action:r},r,o))}}))}function Uh(e){function t(t){return Hh(t,e)}null!==Th&&Hh(Th,e),null!==Rh&&Hh(Rh,e),null!==jh&&Hh(jh,e),Ih.forEach(t),Ph.forEach(t);for(var n=0;n<Mh.length;n++){var r=Mh[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Mh.length&&null===(n=Mh[0]).blockedOn;)Fh(n),null===n.blockedOn&&Mh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var o=n[r],i=n[r+1],a=o[Be]||null;if("function"===typeof i)a||Wh(n);else if(a){var s=null;if(i&&i.hasAttribute("formAction")){if(o=i,a=i[Be]||null)s=a.formAction;else if(null!==Ch(o))continue}else s=a.action;"function"===typeof s?n[r+1]=s:(n.splice(r,3),r-=3),Wh(n)}}}function Vh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return o=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==o&&(o(),o=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,o=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==o&&(o(),o=null)}}}function Gh(e){this._internalRoot=e}function Qh(e){this._internalRoot=e}Qh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));fh(t.current,Gc(),e,t,null,null)},Qh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fh(e.current,2,null,e,null,null),Jc(),t[We]=null}},Qh.prototype.unstable_scheduleHydration=function(e){if(e){var t=qe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mh.length&&0!==t&&t<Mh[n].priority;n++);Mh.splice(n,0,e),0===n&&Fh(e)}};var Kh=o.version;if("19.2.0"!==Kh)throw Error(a(527,Kh,"19.2.0"));N.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return d(o),e;if(i===r)return d(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s){for(c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var Yh={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{ye=$h.inject(Yh),ve=$h}catch(Xh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,r="",o=Ss,i=Cs,l=As;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(o=t.onUncaughtError),void 0!==t.onCaughtError&&(i=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=hh(e,1,!1,null,0,n,r,null,o,i,l,Vh),e[We]=t.current,Ju(e),new Gh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var r=!1,o="",i=Ss,l=Cs,c=As,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onUncaughtError&&(i=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=hh(e,1,!0,t,0,r,o,u,i,l,c,Vh)).context=ph(null),n=t.current,(o=bi(r=De(r=Gc()))).callback=null,xi(n,o,r),n=r,t.current.lanes=n,Pe(t,n),Nu(t),e[We]=t.current,Ju(e),new Qh(t)},t.version="19.2.0"},43:(e,t,n)=>{e.exports=n(288)},201:(e,t,n)=>{n.r(t),n.d(t,{HeroQueens:()=>o,applyHeroBonuses:()=>l,applyHeroCostModifier:()=>c,canQueenHealTwice:()=>d,getHealEnergyCost:()=>u,getHeroById:()=>i});var r=n(555);const o={GORLAK:{id:"gorlak",name:"Gorlak the Crusher",description:"Melee units gain +20% attack, ranged units do 10% less",icon:"\ud83d\udde1\ufe0f",portraitImage:"hero_red.png",bonuses:{meleeAttackBonus:.2,rangedAttackPenalty:-.1,bombardierRangePenalty:-1},heroAbility:{name:"Crushing Blow",description:"Units gain +20% attack for this turn and melee units can move one extra space",attackBonus:.2,meleeMoveBonus:1}},SORLORG:{id:"sorlorg",name:"Sorlorg the Precise",description:"Ranged units gain +20% attack, melee units do 10% less",icon:"\ud83c\udfaf",portraitImage:"hero_green.png",bonuses:{rangedAttackBonus:.2,meleeAttackPenalty:-.1},heroAbility:{name:"Perfect Aim",description:"Ranged units gain +1 range and +10% damage for this turn",rangedRangeBonus:1,rangedDamageBonus:.1}},SKRAZZIT:{id:"skrazzit",name:"Skrazzit the Swarm",description:"Units are 25% cheaper but 20% weaker attack, 10% weaker health. Start with 3 spawning spots",icon:"\ud83d\udc1c",portraitImage:"hero_blue.png",bonuses:{costMultiplier:.75,attackMultiplier:.8,healthMultiplier:.9,spawningSpotBonus:1},heroAbility:{name:"Resource Surge",description:"Food and minerals in stock are multiplied by 1.5, units gain +10% attack",resourceMultiplier:1.5,attackBonus:.1}},THORGRIM:{id:"thorgrim",name:"Thorgrim the Mighty",description:"Units are 25% more expensive but 20% stronger in attack and health",icon:"\u2694\ufe0f",portraitImage:"hero_yellow.png",bonuses:{costMultiplier:1.25,attackMultiplier:1.2,healthMultiplier:1.2},heroAbility:{name:"Ironclad",description:"Units gain +2 defense and +2 attack until their next turn",defenseBonus:2,attackBonus:2,lastsTurn:!0}},VEXXARA:{id:"vexxara",name:"Vexxara the Lifebinder",description:"Healing is 50% cheaper and queens can heal twice per turn",icon:"\ud83d\udc9a",portraitImage:"hero_black.png",bonuses:{healCostMultiplier:.5,queenDoubleHeal:!0},heroAbility:{name:"Divine Restoration",description:"All units restored to full health and energy, gain +10% attack boost",fullHeal:!0,fullEnergy:!0,attackBonus:.1}}};function i(e){return Object.values(o).find(t=>t.id===e)||null}const a=["scout","soldier","tank","drone"],s=["spitter","bombardier","queen"];function l(e,t,n){if(!n)return e;const o=i(n);if(!o)return e;let l=(0,r.A)({},e);const c=o.bonuses,u=a.includes(t),d=s.includes(t);return u&&c.meleeAttackBonus&&(l.attack=Math.ceil(l.attack*(1+c.meleeAttackBonus))),u&&c.meleeHealthBonus&&(l.maxHealth=l.maxHealth+c.meleeHealthBonus,l.health=l.health+c.meleeHealthBonus),u&&c.meleeAttackPenalty&&(l.attack=Math.floor(l.attack*(1+c.meleeAttackPenalty))),d&&c.rangedAttackBonus&&(l.attack=Math.floor(l.attack*(1+c.rangedAttackBonus))),d&&c.rangedAttackPenalty&&(l.attack=Math.floor(l.attack*(1+c.rangedAttackPenalty))),"bombardier"===t&&c.bombardierRangePenalty&&(l.attackRange=Math.max(1,l.attackRange+c.bombardierRangePenalty)),c.attackMultiplier&&(l.attack=Math.floor(l.attack*c.attackMultiplier)),c.healthMultiplier&&(l.maxHealth=Math.floor(l.maxHealth*c.healthMultiplier),l.health=Math.floor(l.health*c.healthMultiplier)),l}function c(e,t){if(!t)return e;const n=i(t);return n&&n.bonuses.costMultiplier?{food:Math.ceil(e.food*n.bonuses.costMultiplier),minerals:Math.ceil(e.minerals*n.bonuses.costMultiplier)}:e}function u(e,t){if(!t)return e;const n=i(t);return n&&n.bonuses.healCostMultiplier?Math.ceil(e*n.bonuses.healCostMultiplier):e}function d(e){var t;if(!e)return!1;const n=i(e);return(null===n||void 0===n||null===(t=n.bonuses)||void 0===t?void 0:t.queenDoubleHeal)||!1}},232:(e,t,n)=>{n.d(t,{MF:()=>de,j6:()=>ae,xZ:()=>se,om:()=>ie,Sx:()=>pe,Wp:()=>he,KO:()=>fe});var r=n(555),o=n(606),i=n(965),a=n(776);let s,l;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap;let f={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function g(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(v(this),n),y(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(e.apply(v(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];const i=e.call(v(this),t,...r);return d.set(i,t.sort?t.sort():[t]),y(i)}}function m(e){return"function"===typeof e?g(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)});u.set(e,t)}(e),t=e,(s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,f):e);var t}function y(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(y(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),p.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=m(e);return t!==e&&(h.set(e,t),p.set(t,e)),t}const v=e=>p.get(e);const b=["get","getKey","getAll","getAllKeys","count"],x=["put","add","delete","clear"],w=new Map;function _(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=x.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!b.includes(n))return;const i=async function(e){const t=this.transaction(e,o?"readwrite":"readonly");let i=t.store;for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return r&&(i=i.index(s.shift())),(await Promise.all([i[n](...s),o&&t.done]))[0]};return w.set(t,i),i}f=(e=>(0,r.A)((0,r.A)({},e),{},{get:(t,n,r)=>_(t,n)||e.get(t,n,r),has:(t,n)=>!!_(t,n)||e.has(t,n)}))(f);class k{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const S="@firebase/app",C="0.14.5",A=new i.Vy("@firebase/app"),E="@firebase/app-compat",T="@firebase/analytics-compat",R="@firebase/analytics",j="@firebase/app-check-compat",I="@firebase/app-check",P="@firebase/auth",M="@firebase/auth-compat",O="@firebase/database",N="@firebase/data-connect",D="@firebase/database-compat",F="@firebase/functions",q="@firebase/functions-compat",L="@firebase/installations",z="@firebase/installations-compat",H="@firebase/messaging",B="@firebase/messaging-compat",W="@firebase/performance",U="@firebase/performance-compat",V="@firebase/remote-config",G="@firebase/remote-config-compat",Q="@firebase/storage",K="@firebase/storage-compat",Y="@firebase/firestore",$="@firebase/ai",Z="@firebase/firestore-compat",X="firebase",J="[DEFAULT]",ee={[S]:"fire-core",[E]:"fire-core-compat",[R]:"fire-analytics",[T]:"fire-analytics-compat",[I]:"fire-app-check",[j]:"fire-app-check-compat",[P]:"fire-auth",[M]:"fire-auth-compat",[O]:"fire-rtdb",[N]:"fire-data-connect",[D]:"fire-rtdb-compat",[F]:"fire-fn",[q]:"fire-fn-compat",[L]:"fire-iid",[z]:"fire-iid-compat",[H]:"fire-fcm",[B]:"fire-fcm-compat",[W]:"fire-perf",[U]:"fire-perf-compat",[V]:"fire-rc",[G]:"fire-rc-compat",[Q]:"fire-gcs",[K]:"fire-gcs-compat",[Y]:"fire-fst",[Z]:"fire-fst-compat",[$]:"fire-vertex","fire-js":"fire-js",[X]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function oe(e,t){try{e.container.addComponent(t)}catch(n){A.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ie(e){const t=e.name;if(re.has(t))return A.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())oe(n,e);for(const n of ne.values())oe(n,e);return!0}function ae(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function se(e){return null!==e&&void 0!==e&&void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new a.FA("app","Firebase",le);class ue{constructor(e,t,n){this._isDeleted=!1,this._options=(0,r.A)({},e),this._config=(0,r.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new o.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const de="12.5.0";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=(0,r.A)({name:J,automaticDataCollectionEnabled:!0},t),s=i.name;if("string"!==typeof s||!s)throw ce.create("bad-app-name",{appName:String(s)});if(n||(n=(0,a.T9)()),!n)throw ce.create("no-options");const l=te.get(s);if(l){if((0,a.bD)(n,l.options)&&(0,a.bD)(i,l.config))return l;throw ce.create("duplicate-app",{appName:s})}const c=new o.h1(s);for(const r of re.values())c.addComponent(r);const u=new ue(n,i,c);return te.set(s,u),u}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J;const t=te.get(e);if(!t&&e===J&&(0,a.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function fe(e,t,n){var r;let i=null!==(r=ee[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void A.warn(e.join(" "))}ie(new o.uA("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const ge="firebase-heartbeat-store";let me=null;function ye(){return me||(me=function(e,t){let{blocked:n,upgrade:r,blocking:o,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),s=y(a);return r&&a.addEventListener("upgradeneeded",e=>{r(y(a.result),e.oldVersion,e.newVersion,y(a.transaction),e)}),n&&a.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{i&&e.addEventListener("close",()=>i()),o&&e.addEventListener("versionchange",e=>o(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ge)}catch(n){console.warn(n)}}}).catch(e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})})),me}async function ve(e,t){try{const n=(await ye()).transaction(ge,"readwrite"),r=n.objectStore(ge);await r.put(t,be(e)),await n.done}catch(n){if(n instanceof a.g)A.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});A.warn(e.message)}}}function be(e){return"".concat(e.name,"!").concat(e.options.appId)}class xe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _e(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=we();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){A.warn(n)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const o of e){const e=n.find(e=>e.agent===o.agent);if(e){if(e.dates.push(o.date),ke(n)>t){e.dates.pop();break}}else if(n.push({agent:o.agent,dates:[o.date]}),ke(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),o=(0,a.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return A.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class _e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.zW)()&&(0,a.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ye()).transaction(ge),n=await t.objectStore(ge).get(be(e));return await t.done,n}catch(t){if(t instanceof a.g)A.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});A.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ke(e){return(0,a.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var Se;Se="",ie(new o.uA("platform-logger",e=>new k(e),"PRIVATE")),ie(new o.uA("heartbeat",e=>new xe(e),"PRIVATE")),fe(S,C,Se),fe(S,C,"esm2020"),fe("fire-js","")},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function v(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}function b(){}function x(e,t,n){this.props=e,this.context=t,this.refs=y,this.updater=n||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var w=x.prototype=new b;w.constructor=x,m(w,v.prototype),w.isPureReactComponent=!0;var _=Array.isArray;function k(){}var S={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function A(e,t,r){var o=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==o?o:null,props:r}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function j(e,t,o,i,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case h:return j((u=e._init)(e._payload),t,o,i,a)}}if(u)return a=a(e),u=""===i?"."+R(e,0):i,_(a)?(o="",null!=u&&(o=u.replace(T,"$&/")+"/"),j(a,t,o,"",function(e){return e})):null!=a&&(E(a)&&(l=a,c=o+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+u,a=A(l.type,c,l.props)),t.push(a)),1;u=0;var d,p=""===i?".":i+":";if(_(e))for(var g=0;g<e.length;g++)u+=j(i=e[g],t,o,s=p+R(i,g),a);else if("function"===typeof(g=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=g.call(e),g=0;!(i=e.next()).done;)u+=j(i=i.value,t,o,s=p+R(i,g++),a);else if("object"===s){if("function"===typeof e.then)return j(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(k,k):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,o,i,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var r=[],o=0;return j(e,r,"","",function(e){return t.call(n,e,o++)}),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},O={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=O,t.Component=v,t.Fragment=o,t.Profiler=a,t.PureComponent=x,t.StrictMode=i,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=S,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return S.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=m({},e.props),o=e.key;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)!C.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(r[i]=t[i]);var i=arguments.length-2;if(1===i)r.children=n;else if(1<i){for(var a=Array(i),s=0;s<i;s++)a[s]=arguments[s+2];r.children=a}return A(e.type,o,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var r,o={},i=null;if(null!=t)for(r in void 0!==t.key&&(i=""+t.key),t)C.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(o[r]=t[r]);var a=arguments.length-2;if(1===a)o.children=n;else if(1<a){for(var s=Array(a),l=0;l<a;l++)s[l]=arguments[l+2];o.children=s}if(e&&e.defaultProps)for(r in a=e.defaultProps)void 0===o[r]&&(o[r]=a[r]);return A(e,i,o)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=S.T,n={};S.T=n;try{var r=e(),o=S.S;null!==o&&o(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(k,M)}catch(i){M(i)}finally{null!==t&&null!==n.types&&(t.types=n.types),S.T=t}},t.unstable_useCacheRefresh=function(){return S.H.useCacheRefresh()},t.use=function(e){return S.H.use(e)},t.useActionState=function(e,t,n){return S.H.useActionState(e,t,n)},t.useCallback=function(e,t){return S.H.useCallback(e,t)},t.useContext=function(e){return S.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return S.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return S.H.useEffect(e,t)},t.useEffectEvent=function(e){return S.H.useEffectEvent(e)},t.useId=function(){return S.H.useId()},t.useImperativeHandle=function(e,t,n){return S.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return S.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return S.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return S.H.useMemo(e,t)},t.useOptimistic=function(e,t){return S.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return S.H.useReducer(e,t,n)},t.useRef=function(e){return S.H.useRef(e)},t.useState=function(e){return S.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return S.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return S.H.useTransition()},t.version="19.2.0"},352:(e,t,n)=>{n.d(t,{GU:()=>a,P9:()=>l,eB:()=>s,mZ:()=>c,s1:()=>o,sv:()=>i,xr:()=>r});const r={QUEEN:{id:"queen",name:"Queen",cost:{food:0,minerals:0},hatchTime:0,maxHealth:60,attack:6,defense:2,moveRange:1,attackRange:2,resourceGatherRate:0,revealEnergyCost:20,description:"The heart of your colony. If she dies, you lose!",icon:"\ud83d\udc51\ud83d\udc1c"},SCOUT:{id:"scout",name:"Scout Ant",cost:{food:15,minerals:0},hatchTime:1,maxHealth:25,attack:8,defense:0,moveRange:3,attackRange:1,resourceGatherRate:3,description:"Fast, cheap, and weak. Perfect for early game exploration.",icon:"\ud83c\udfc3\ud83d\udc1c"},MARAUDER:{id:"soldier",name:"Marauder",cost:{food:20,minerals:5},hatchTime:1,maxHealth:35,attack:10,defense:1,moveRange:2,attackRange:1,resourceGatherRate:3,description:"Balanced fighter with good health and damage.",icon:"\u2694\ufe0f\ud83d\udc1c"},BULLET:{id:"tank",name:"Bullet Ant",cost:{food:35,minerals:15},hatchTime:2,maxHealth:55,attack:20,defense:2,moveRange:2,attackRange:1,resourceGatherRate:.5,description:"Expensive, but incredibly strong and durable.",icon:"\ud83d\udee1\ufe0f\ud83d\udc1c"},ACID:{id:"spitter",name:"Acid Ant",cost:{food:15,minerals:7},hatchTime:1,maxHealth:25,attack:8,defense:0,moveRange:2,attackRange:2,resourceGatherRate:.5,description:"Ranged glass cannon. High damage from a distance but fragile.",icon:"\ud83d\udca7\ud83d\udc1c"},BOMBER:{id:"bomber",name:"Acid Bomber",cost:{food:8,minerals:12},hatchTime:1,maxHealth:20,attack:18,defense:0,moveRange:2,attackRange:2,splashDamage:!0,splashRadius:1,resourceGatherRate:.5,description:"Deals splash damage to enemies in a small radius.",icon:"\ud83d\udca3\ud83d\udc1c"},BOMBARDIER:{id:"bombardier",name:"Bombardier",cost:{food:20,minerals:15},hatchTime:1,maxHealth:30,attack:15,defense:0,moveRange:2,attackRange:3,minAttackRange:2,cannotMoveAndAttack:!0,resourceGatherRate:0,description:"Long-range artillery. Cannot attack adjacent enemies or move and shoot.",icon:"\ud83c\udfaf\ud83d\udc1c"},DRONE:{id:"drone",name:"Worker Drone",cost:{food:10,minerals:0},hatchTime:0,maxHealth:15,attack:5,defense:0,moveRange:2,attackRange:1,canBuildAnthill:!0,resourceGatherRate:5,description:"Poor combatant but can build anthills to generate passive income.",icon:"\u26cf\ufe0f\ud83d\udc1c"},HEALER:{id:"healer",name:"Weaver Ant",cost:{food:15,minerals:20},hatchTime:1,maxHealth:20,attack:0,defense:1,moveRange:2,attackRange:0,resourceGatherRate:0,requiresQueenTier:"swarmQueen",maxEnergy:50,startingEnergy:25,energyRegen:10,healRange:1,healAmount:20,healEnergyCost:15,ensnareRange:3,ensnareDuration:3,ensnareEnergyCost:20,description:"Support unit that can heal allies and ensnare enemies. Requires Swarm Queen.",icon:"\u2728\ud83d\udc1c"},CORDYPHAGE:{id:"cordyphage",name:"Cordyphage",cost:{food:15,minerals:25},hatchTime:1,maxHealth:25,attack:0,defense:1,moveRange:2,attackRange:0,resourceGatherRate:0,requiresQueenTier:"swarmQueen",maxEnergy:50,startingEnergy:25,energyRegen:10,cordycepsRange:1,cordycepsEnergyCost:50,plagueRange:3,plagueDuration:3,plagueHealthLoss:.2,plagueEnergyCost:35,description:"Dark spellcaster that can mind control enemies with Cordyceps Purge and inflict Plague. Requires Swarm Queen.",icon:"\u2620\ufe0f\ud83d\udc1c"}};function o(e){return Object.values(r).find(t=>t.id===e)}const i={MOVES_PER_TURN:3,STARTING_RESOURCES:{food:25,minerals:0},HEX_GRID_SIZE:10,RESOURCE_SPAWN_COUNT:6,ANTHILL_BUILD_PROGRESS_REQUIRED:2,ANTHILL_BUILD_COST:5,ANTHILL_PASSIVE_INCOME:{food:5,minerals:7},QUEEN_BASE_ENERGY:50,QUEEN_BASE_ENERGY_REGEN:10,EGG_LAY_ENERGY_COST:5,HEAL_ENERGY_COST:10,HEAL_AMOUNT:15,QUEEN_BASE_FOOD_INCOME:5,TREE_DEFENSE_BONUS:1,CANNIBALISM_FOOD_GAIN:5,CANNIBALISM_MINERAL_GAIN:5,TRIANGLE_SIDE_LENGTH:15,SQUARE_SIZE:16},a={MELEE_ATTACK:{id:"meleeAttack",name:"Melee Attack",description:"+1 Attack for melee units",icon:"\u2694\ufe0f",maxTier:3,costs:[{food:15,minerals:10},{food:20,minerals:15},{food:25,minerals:20}]},RANGED_ATTACK:{id:"rangedAttack",name:"Ranged Attack",description:"+1 Attack for ranged units",icon:"\ud83c\udff9",maxTier:3,costs:[{food:15,minerals:10},{food:20,minerals:15},{food:25,minerals:20}]},DEFENSE:{id:"defense",name:"Defense",description:"+1 Defense for all units",icon:"\ud83d\udee1\ufe0f",maxTier:3,costs:[{food:20,minerals:15},{food:25,minerals:20},{food:30,minerals:25}]},CANNIBALISM:{id:"cannibalism",name:"Cannibalism",description:"+3 Food and +3 Minerals when melee units kill",icon:"\ud83c\udf56",maxTier:1,costs:[{food:15,minerals:10}]},BURROW:{id:"burrow",name:"Burrow",description:"Unlock burrow ability for all units (except Tank/Bombardier)",icon:"\ud83d\udd73\ufe0f",maxTier:1,costs:[{food:15,minerals:15}]},CONNECTED_TUNNELS:{id:"connectedTunnels",name:"Connected Tunnels",description:"Units on anthills can teleport to other friendly anthills",icon:"\ud83c\udf00",maxTier:1,requiresQueenTier:"swarmQueen",costs:[{food:15,minerals:15}]},CORDYCEPS_PURGE:{id:"cordycepsPurge",name:"Cordyceps Purge",description:"Unlocks mind control ability for Cordyphage (50\u26a1, Melee Range)",icon:"\ud83e\udde0",maxTier:1,requiresQueenTier:"swarmQueen",costs:[{food:20,minerals:20}]}},s={RECTANGLE:"rectangle",TRIANGLE:"triangle",SQUARE:"square"},l={NONE:null,TEAM_A:"A",TEAM_B:"B"},c={queen:{name:"Queen",spawningSpots:2,maxEnergy:50,energyRegen:7,foodIncome:5},broodQueen:{name:"Brood Queen",spawningSpots:4,maxEnergy:75,energyRegen:10,foodIncome:6,cost:{food:25,minerals:15}},swarmQueen:{name:"Swarm Queen",spawningSpots:6,maxEnergy:100,energyRegen:12,foodIncome:7,cost:{food:30,minerals:20}}}},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},451:(e,t,n)=>{n.r(t),n.d(t,{activateHeroAbility:()=>G,buildAnthill:()=>v,burrowAnt:()=>j,calculateArmyStrength:()=>a,canAfford:()=>f,canAffordQueenUpgrade:()=>R,canAffordUpgrade:()=>b,canBurrow:()=>P,canUnburrow:()=>M,completeAnthill:()=>p,cordycepsPurge:()=>q,createAnt:()=>u,createAnthillInProgress:()=>h,createEgg:()=>d,createInitialGameState:()=>s,deductCost:()=>g,deductEnergy:()=>S,endTurn:()=>m,ensnareEnemy:()=>F,getAntAttack:()=>w,getAntDefense:()=>_,getEggLayCost:()=>C,getSpawningPoolHexes:()=>U,getValidCordycepsTargets:()=>L,getValidEnsnareTargets:()=>W,getValidHealTargets:()=>B,getValidPlagueTargets:()=>H,getValidTeleportDestinations:()=>N,hasEnoughEnergy:()=>k,healAlly:()=>D,healAnt:()=>A,markAntMoved:()=>y,plagueEnemy:()=>z,purchaseUpgrade:()=>x,respawnResource:()=>c,revealArea:()=>E,teleportAnt:()=>O,unburrowAnt:()=>I,updateHeroPower:()=>V,upgradeQueen:()=>T});var r=n(555),o=n(624),i=n(352);function a(e,t){const n=e.players[t];let r=0;const o={scout:10,drone:5,spitter:20,soldier:20,tank:40,cordyphage:30,bomber:15,healer:35,bombardier:30,queen:0},i=["scout","drone","soldier","tank"],a=["spitter","bombardier","queen"];return Object.values(e.ants).filter(e=>e.owner===t&&!e.isDead).forEach(e=>{const t=o[e.type]||0;let s=0;i.includes(e.type)&&(s+=2*n.upgrades.meleeAttack),a.includes(e.type)&&(s+=2*n.upgrades.rangedAttack),s+=2*n.upgrades.defense;r+=t+s}),r}function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mapSize:t="large",playerCount:a=2,mapShape:s=i.eB.RECTANGLE,player1Color:c="#FF0000",player2Color:u="#0000FF",player3Color:d="#00FF00",player4Color:h="#FFFF00",player1Hero:p=null,player2Hero:f=null,player3Hero:g=null,player4Hero:m=null,player1Team:y=i.P9.NONE,player2Team:v=i.P9.NONE,player3Team:b=i.P9.NONE,player4Team:x=i.P9.NONE}=e,w={small:4,medium:5,large:6}[t]||6;let _=w,k=s;console.log("createInitialGameState called with:",{playerCount:a,mapShape:s,mapSize:t}),3===a?(_=8,k=i.eB.RECTANGLE,console.log("Using XL HEXAGON map for 3-player, gridRadius:",_)):s===i.eB.TRIANGLE?(_=i.sv.TRIANGLE_SIDE_LENGTH,console.log("Using TRIANGLE map, sideLength:",_)):s===i.eB.SQUARE?(_=i.sv.SQUARE_SIZE,console.log("Using SQUARE map, sideLength:",_)):console.log("Using RECTANGLE map (2-player), gridRadius:",w);const S=(e,t,n,o,a)=>({id:e,name:t,resources:(0,r.A)({},i.sv.STARTING_RESOURCES),color:n,heroId:o,team:a,upgrades:{meleeAttack:0,rangedAttack:0,defense:0,cannibalism:0},heroPower:0,heroAbilityActive:!1,heroAbilityEndsOnTurn:null}),C={player1:S("player1","Player 1",c,p,y),player2:S("player2","Player 2",u,f,v)};a>=3&&(C.player3=S("player3","Player 3",d,g,b)),a>=4&&(C.player4=S("player4","Player 4",h,m,x));const A={turn:1,currentPlayer:"player1",mapSize:t,mapShape:k,playerCount:a,gridRadius:k===i.eB.SQUARE||3===a?_:w,sideLength:_,players:C,stats:Object.keys(C).reduce((e,t)=>(e[t]={damageDealt:0,damageReceived:0,antsHatched:{scout:0,drone:0,soldier:0,tank:0,spitter:0,bomber:0,bombardier:0,healer:0,cordyphage:0},antsKilled:0,antsLost:0,foodMined:0,mineralsMined:0},e),{}),armyStrengthHistory:Object.keys(C).reduce((e,t)=>(e[t]=[],e),{}),ants:{},eggs:{},deadAnts:{},resources:l(_,a,k),anthills:{},trees:{},selectedAnt:null,selectedAction:null,gameOver:!1,winner:null},E=(0,o.getPlayerStartingPositions)(k,_,a),T=Object.keys(C),R=[p,f,g,m];T.forEach((e,t)=>{const r=t+1,o=E[t],a=R[t],s="ant_p".concat(r,"_queen");A.ants[s]={id:s,type:"queen",owner:e,position:o,health:i.xr.QUEEN.maxHealth,maxHealth:i.xr.QUEEN.maxHealth,energy:i.sv.QUEEN_BASE_ENERGY,maxEnergy:i.sv.QUEEN_BASE_ENERGY,queenTier:"queen",heroId:a};const{getNeighbors:l}=n(624),c=l(o);c.length>=3&&(A.ants["ant_p".concat(r,"_drone1")]={id:"ant_p".concat(r,"_drone1"),type:"drone",owner:e,position:c[0],health:i.xr.DRONE.maxHealth,maxHealth:i.xr.DRONE.maxHealth},A.ants["ant_p".concat(r,"_drone2")]={id:"ant_p".concat(r,"_drone2"),type:"drone",owner:e,position:c[1],health:i.xr.DRONE.maxHealth,maxHealth:i.xr.DRONE.maxHealth},A.ants["ant_p".concat(r,"_scout1")]={id:"ant_p".concat(r,"_scout1"),type:"scout",owner:e,position:c[2],health:i.xr.SCOUT.maxHealth,maxHealth:i.xr.SCOUT.maxHealth})});const j=[...Object.values(A.ants).map(e=>e.position),...Object.values(A.eggs).map(e=>e.position),...Object.values(A.resources).map(e=>e.position)],I=2===a?4:3===a?3:2;if(A.trees=function(e,t,r,a,s){const l={};if(2===t&&r===i.eB.RECTANGLE)return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;const r={},i=e-1,a=new Set(t.map(e=>"".concat(e.q,",").concat(e.r))),s=e=>a.has("".concat(e.q,",").concat(e.r)),l=[];for(let d=-e;d<=e;d++)for(let t=-e;t<0;t++){const n=-d-t;if(Math.abs(d)<=e&&Math.abs(t)<=e&&Math.abs(n)<=e){const e=new o.HexCoord(d,t),r=Math.max(Math.abs(d-0),Math.abs(t- -i),Math.abs(n-i));if(!s(e)&&r>=2){const n=new o.HexCoord(-d,-t),r=- -d- -t,a=Math.max(Math.abs(-d-0),Math.abs(-t-i),Math.abs(r- -i));!s(n)&&a>=2&&l.push(e)}}}console.log("Valid mirrored tree positions:",l.length);const c=l.sort(()=>Math.random()-.5).slice(0,n);let u=0;return c.forEach(e=>{r["tree_".concat(u)]={id:"tree_".concat(u),position:e,side:"north"},u++;const t=new o.HexCoord(-e.q,-e.r);r["tree_".concat(u)]={id:"tree_".concat(u),position:t,side:"south"},u++}),console.log("Total trees generated:",Object.keys(r).length),console.log("Tree positions:",Object.values(r).map(e=>"".concat(e.side," at (").concat(e.position.q,",").concat(e.position.r,")"))),r}(e,a,s);if(3===t&&r===i.eB.RECTANGLE)return function(e,t,r){const a={},{rotateHex120:s}=n(624),l=new Set(t.map(e=>"".concat(e.q,",").concat(e.r))),c=e=>l.has("".concat(e.q,",").concat(e.r)),u=(0,o.getPlayerStartingPositions)(i.eB.RECTANGLE,e,3),d=t=>{const n=-t.q-t.r;return Math.abs(t.q)<=e&&Math.abs(t.r)<=e&&Math.abs(n)<=e},h=e=>{const t=-e.q-e.r;return u.some(n=>Math.max(Math.abs(e.q-n.q),Math.abs(e.r-n.r),Math.abs(t-(-n.q-n.r)))<2)},p=[];for(let n=-e;n<=e;n++)for(let t=-e;t<=e;t++){const r=-n-t;if(Math.abs(n)<=e&&Math.abs(t)<=e&&Math.abs(r)<=e){const e=new o.HexCoord(n,t),i=Math.max(Math.abs(n),Math.abs(t),Math.abs(r));if(n>0&&t<0&&i>2){const t=s(e),n=s(t),r=d(e)&&d(t)&&d(n),o=!c(e)&&!c(t)&&!c(n),i=!h(e)&&!h(t)&&!h(n);r&&o&&i&&p.push(e)}}}const f=p.sort(()=>Math.random()-.5),g=f.slice(0,r);let m=0;return g.forEach(e=>{a["tree_".concat(m)]={id:"tree_".concat(m),position:e},m++;const t=s(e);a["tree_".concat(m)]={id:"tree_".concat(m),position:t},m++;const n=s(t);a["tree_".concat(m)]={id:"tree_".concat(m),position:n},m++}),console.log("Total trees generated for 3-player:",Object.keys(a).length),a}(e,a,s);const c=new Set(a.map(e=>"".concat(e.q,",").concat(e.r))),u=e=>c.has("".concat(e.q,",").concat(e.r));let d=[];r===i.eB.SQUARE&&(d=(0,o.generateSquareGrid)(e,Math.floor(.75*e)));const h=(0,o.getPlayerStartingPositions)(r,e,t),p=d.filter(e=>{if(u(e))return!1;return!h.some(t=>Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r),Math.abs(-e.q-e.r-(-t.q-t.r)))<2)}),f=p.sort(()=>Math.random()-.5).slice(0,s);let g=0;f.forEach(e=>{l["tree_".concat(g)]={id:"tree_".concat(g),position:e},g++});const m=(0,o.mirrorPositions)(f,t);return m.slice(s).forEach(e=>{u(e)||(l["tree_".concat(g)]={id:"tree_".concat(g),position:e},g++)}),l}(_,a,k,j,I),p||f||g||m){const{applyHeroBonuses:e}=n(201);Object.keys(A.ants).forEach(t=>{var n;const o=A.ants[t],a=null===(n=C[o.owner])||void 0===n?void 0:n.heroId;if(a){const n=(0,i.s1)(o.type),s={health:o.health,maxHealth:o.maxHealth,attack:n.attack},l=e(s,o.type,a);console.log("Applying hero bonuses to starting ".concat(o.type," (").concat(o.owner,"):"),{before:s,after:l,heroId:a}),A.ants[t]=(0,r.A)((0,r.A)({},o),{},{health:l.health,maxHealth:l.maxHealth});const c=l.attack-n.attack;0!==c&&(A.ants[t].bonusAttack=c)}})}return A}function l(e,t,r){const a={};if(2===t&&r===i.eB.RECTANGLE)return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;const t={},n=e-1,r=[];for(let l=-e;l<=e;l++)for(let t=-e;t<0;t++){const i=-l-t;if(Math.abs(l)<=e&&Math.abs(t)<=e&&Math.abs(i)<=e){const e=new o.HexCoord(l,t),a=Math.max(Math.abs(l-0),Math.abs(t- -n),Math.abs(i-n)),s=-l,c=-t,u=-i,d=Math.max(Math.abs(s-0),Math.abs(c-n),Math.abs(u- -n));a>=3&&d>=3&&r.push(e)}}console.log("Valid north positions found:",r.length),console.log("Sample valid positions:",r.slice(0,5).map(e=>"(".concat(e.q,",").concat(e.r,")")));const i=r.sort(()=>Math.random()-.5),a=i.slice(0,6);console.log("Selected north positions:",a.length),console.log("Selected positions:",a.map(e=>"(".concat(e.q,",").concat(e.r,")")));let s=0;return a.forEach((e,n)=>{const r=n<4?"food":"minerals";t["resource_".concat(s)]={id:"resource_".concat(s),type:r,position:e},s++;const i=new o.HexCoord(-e.q,-e.r);t["resource_".concat(s)]={id:"resource_".concat(s),type:r,position:i},s++}),console.log("Total resources generated:",Object.keys(t).length),console.log("Resources by type:",Object.values(t).reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{})),console.log("Resource positions:",Object.values(t).map(e=>"".concat(e.type," at (").concat(e.position.q,",").concat(e.position.r,")"))),t}(e);if(3===t&&r===i.eB.RECTANGLE)return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;const t={},{rotateHex120:r}=n(624),a=(0,o.getPlayerStartingPositions)(i.eB.RECTANGLE,e,3),s=t=>{const n=-t.q-t.r;return Math.abs(t.q)<=e&&Math.abs(t.r)<=e&&Math.abs(n)<=e},l=e=>{const t=-e.q-e.r;return a.some(n=>Math.max(Math.abs(e.q-n.q),Math.abs(e.r-n.r),Math.abs(t-(-n.q-n.r)))<3)},c=[];for(let n=-e;n<=e;n++)for(let t=-e;t<=e;t++){const i=-n-t;if(Math.abs(n)<=e&&Math.abs(t)<=e&&Math.abs(i)<=e){const e=new o.HexCoord(n,t),a=Math.max(Math.abs(n),Math.abs(t),Math.abs(i));if(n>0&&t<0&&a>2){const t=r(e),n=r(t),o=s(e)&&s(t)&&s(n),i=!l(e)&&!l(t)&&!l(n);o&&i&&c.push(e)}}}console.log("Valid sector positions for 3-player (all rotations valid):",c.length);const u=4,d=u+2,h=c.sort(()=>Math.random()-.5),p=h.slice(0,d);console.log("Selected sector positions:",p.length);let f=0;return p.forEach((e,n)=>{const o=n<u?"food":"minerals";t["resource_".concat(f)]={id:"resource_".concat(f),type:o,position:e},f++;const i=r(e);t["resource_".concat(f)]={id:"resource_".concat(f),type:o,position:i},f++;const a=r(i);t["resource_".concat(f)]={id:"resource_".concat(f),type:o,position:a},f++}),console.log("Total resources generated for 3-player:",Object.keys(t).length),console.log("Resources by type:",Object.values(t).reduce((e,t)=>(e[t.type]=(e[t.type]||0)+1,e),{})),t}(e);const s=Math.floor(i.sv.RESOURCE_SPAWN_COUNT/t),l=[],c=(0,o.getPlayerStartingPositions)(r,e,t);let u=[];r===i.eB.SQUARE&&(u=(0,o.generateSquareGrid)(e,Math.floor(.75*e))),u.forEach(e=>{c.some(t=>Math.max(Math.abs(e.q-t.q),Math.abs(e.r-t.r),Math.abs(-e.q-e.r-(-t.q-t.r)))<3)||l.push(e)});const d=l.sort(()=>Math.random()-.5).slice(0,s),h=Math.ceil(s/2);let p=0;d.forEach((e,t)=>{const n=t<h?"food":"minerals";a["resource_".concat(p)]={id:"resource_".concat(p),type:n,position:e},p++});return(0,o.mirrorPositions)(d,t).slice(s).forEach((e,t)=>{const n=t%s<h?"food":"minerals";a["resource_".concat(p)]={id:"resource_".concat(p),type:n,position:e},p++}),a}function c(e,t,n){const r=e.gridRadius||6,i=r-1,a=[];for(let s=-r;s<=r;s++){const t=n?-1:r;for(let l=n?-r:1;l<=t;l++){const t=-s-l;if(Math.abs(s)<=r&&Math.abs(l)<=r&&Math.abs(t)<=r){const r=new o.HexCoord(s,l),c=n?-i:i;if(Math.max(Math.abs(s-0),Math.abs(l-c),Math.abs(t- -c))>=3){const t=Object.values(e.ants).some(e=>e.position.q===r.q&&e.position.r===r.r),n=Object.values(e.eggs).some(e=>e.position.q===r.q&&e.position.r===r.r),o=Object.values(e.resources).some(e=>e.position.q===r.q&&e.position.r===r.r),i=Object.values(e.anthills).some(e=>e.position.q===r.q&&e.position.r===r.r);t||n||o||i||a.push(r)}}}}if(a.length>0){const e=a[Math.floor(Math.random()*a.length)];return{id:"resource_".concat(Date.now(),"_").concat(Math.floor(1e6*Math.random())),type:t,position:e}}return null}function u(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=(0,i.s1)(e);if(!a)throw new Error("Unknown ant type: ".concat(e));let s=a.maxHealth,l=a.maxHealth,c=a.attack;if(o){const{applyHeroBonuses:t}=n(201),r=t({health:s,maxHealth:l,attack:c},e.toLowerCase(),o);console.log("Creating ".concat(e," with heroId ").concat(o,":"),{before:{health:s,maxHealth:l,attack:c},after:r}),s=r.health,l=r.maxHealth,c=r.attack}const u={id:"ant_".concat(Date.now(),"_").concat(Math.floor(1e6*Math.random())),type:a.id,owner:t,position:r,health:s,maxHealth:l,hasMoved:!1};return o&&(u.heroId=o),c!==a.attack&&(u.bonusAttack=c-a.attack),a.maxEnergy&&(u.energy=void 0!==a.startingEnergy?a.startingEnergy:a.maxEnergy,u.maxEnergy=a.maxEnergy),"queen"===e.toLowerCase()&&(u.queenTier="queen"),u}function d(e,t,n,r){const o=(0,i.s1)(e);if(!o)throw new Error("Unknown ant type: ".concat(e));return{id:"egg_".concat(Date.now(),"_").concat(Math.floor(1e6*Math.random())),antType:o.id,owner:t,position:n,hatchTurn:r+o.hatchTime,health:5,maxHealth:5}}function h(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return{id:"anthill_".concat(Date.now(),"_").concat(Math.floor(1e6*Math.random())),resourceId:e,owner:t,position:n,resourceType:r,buildProgress:o,isComplete:!1,health:5,maxHealth:20,resourcesGathered:0}}function p(e){return(0,r.A)((0,r.A)({},e),{},{buildProgress:i.sv.ANTHILL_BUILD_PROGRESS_REQUIRED,isComplete:!0,health:20,maxHealth:20})}function f(e,t){let r=(0,i.s1)(t).cost;if(e.heroId){const{applyHeroCostModifier:t}=n(201);r=t(r,e.heroId)}return e.resources.food>=r.food&&e.resources.minerals>=r.minerals}function g(e,t){let o=(0,i.s1)(t).cost;if(e.heroId){const{applyHeroCostModifier:t}=n(201);o=t(o,e.heroId)}return(0,r.A)((0,r.A)({},e),{},{resources:{food:e.resources.food-o.food,minerals:e.resources.minerals-o.minerals}})}function m(e){const t=e.playerCount||2,n=parseInt(e.currentPlayer.replace("player","")),o="player".concat(n%t+1),s="player1"===o,l={},d={};Object.values(e.eggs).forEach(t=>{if(s&&t.hatchTurn<=e.turn){var n;const r=(null===(n=e.players[t.owner])||void 0===n?void 0:n.heroId)||null,o=u(t.antType,t.owner,t.position,r);l[o.id]=o}else d[t.id]=t});const h=(0,r.A)({},e.players);h[e.currentPlayer]&&(h[e.currentPlayer]=(0,r.A)((0,r.A)({},h[e.currentPlayer]),{},{revealedHexes:[]}));const p={},f=[];let g=(0,r.A)({},e.anthills),m=(0,r.A)({},e.resources);const y=[],v={};Object.keys(e.players).forEach(t=>{v[t]=(0,r.A)({},e.stats[t])}),Object.values(e.eggs).forEach(t=>{if(s&&t.hatchTurn<=e.turn){const e=t.antType.toLowerCase();void 0!==v[t.owner].antsHatched[e]&&v[t.owner].antsHatched[e]++}}),s&&(Object.values(g).forEach(e=>{if(e.isComplete){const t=i.sv.ANTHILL_PASSIVE_INCOME[e.resourceType];h[e.owner].resources[e.resourceType]+=t,"food"===e.resourceType?v[e.owner].foodMined=(v[e.owner].foodMined||0)+t:"minerals"===e.resourceType&&(v[e.owner].mineralsMined=(v[e.owner].mineralsMined||0)+t);const n=(e.resourcesGathered||0)+t;g[e.id]=(0,r.A)((0,r.A)({},e),{},{resourcesGathered:n}),f.push({amount:t,type:e.resourceType,position:e.position,anthillId:e.id,owner:e.owner}),n>=75&&y.push(e)}}),y.forEach(t=>{delete g[t.id];const n=Object.values(m).find(e=>e.position.q===t.position.q&&e.position.r===t.position.r);n&&delete m[n.id];const o=t.position.r<0,i=c((0,r.A)((0,r.A)({},e),{},{resources:m,anthills:g}),t.resourceType,o);i?(m[i.id]=i,console.log("Resource depleted at (".concat(t.position.q,",").concat(t.position.r,"), respawned at (").concat(i.position.q,",").concat(i.position.r,")"))):console.warn("Could not find empty spot to respawn ".concat(t.resourceType," on ").concat(o?"north":"south"," side"))}),Object.values(e.ants).forEach(e=>{if("queen"===e.type){const t=i.mZ[e.queenTier||"queen"].foodIncome;h[e.owner].resources.food+=t,f.push({amount:t,type:"food",position:e.position,queenId:e.id,owner:e.owner})}}));const b=[];Object.values(e.ants).forEach(e=>{if(e.owner===o){const t=(0,r.A)((0,r.A)({},e),{},{hasMoved:!1,hasAttacked:!1,hasBuilt:!1});if("queen"===e.type){const n=i.mZ[e.queenTier||"queen"],r=Math.min(e.maxEnergy,e.energy+n.energyRegen);t.energy=r}if("healer"===e.type&&e.maxEnergy){const n=i.xr.HEALER,r=Math.min(e.maxEnergy,(e.energy||0)+n.energyRegen);t.energy=r}if("cordyphage"===e.type&&e.maxEnergy){const n=i.xr.CORDYPHAGE,r=Math.min(e.maxEnergy,(e.energy||0)+n.energyRegen);t.energy=r}if(e.ensnared&&e.ensnared>0&&(t.ensnared=e.ensnared-1,t.ensnared<=0&&delete t.ensnared),e.plagued&&e.plagued>0){const n=i.xr.CORDYPHAGE,r=Math.ceil(e.maxHealth*n.plagueHealthLoss);t.health=Math.max(1,t.health-r),b.push({damage:r,position:e.position,antId:e.id}),t.plagued=e.plagued-1,t.plagued<=0&&delete t.plagued}p[e.id]=t}else p[e.id]=e}),Object.keys(p).forEach(e=>{const t=p[e];t.owner===o&&(p[e]=(0,r.A)((0,r.A)({},t),{},{hasMoved:!1,hasAttacked:!1,hasBuilt:!1}))});const x=h[e.currentPlayer];x&&x.heroAbilityActive&&x.heroAbilityEndsOnTurn&&x.heroAbilityEndsOnTurn<=e.turn&&(h[e.currentPlayer]=(0,r.A)((0,r.A)({},h[e.currentPlayer]),{},{heroAbilityActive:!1,heroAbilityEndsOnTurn:null})),h[e.currentPlayer]=(0,r.A)((0,r.A)({},h[e.currentPlayer]),{},{revealedHexes:[]});const w=(0,r.A)((0,r.A)({},e),{},{turn:s?e.turn+1:e.turn,currentPlayer:o,players:h,ants:(0,r.A)((0,r.A)({},p),l),eggs:d,resources:m,anthills:g,stats:v,selectedAnt:null,selectedAction:null});if(s){const t={};Object.keys(e.players).forEach(e=>{var n;const r=a(w,e);t[e]=[...(null===(n=w.armyStrengthHistory)||void 0===n?void 0:n[e])||[],r]}),w.armyStrengthHistory=t}return{gameState:w,resourceGains:f,plagueDamages:b}}function y(e,t){return(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},e.ants[t]),{},{hasMoved:!0})})})}function v(e,t,n){const o=e.ants[t],a=e.resources[n];if(!o||!a)return e;if(!(0,i.s1)(o.type).canBuildAnthill)return e;if(Math.max(Math.abs(o.position.q-a.position.q),Math.abs(o.position.r-a.position.r),Math.abs(-o.position.q-o.position.r-(-a.position.q-a.position.r)))>0)return e;const s=(0,r.A)({},e.anthills),l=Object.values(s).find(e=>e.position.q===a.position.q&&e.position.r===a.position.r);if(!l){const l=e.players[o.owner];if(l.resources.food<i.sv.ANTHILL_BUILD_COST)return e;const c=(0,r.A)((0,r.A)({},e.players),{},{[o.owner]:(0,r.A)((0,r.A)({},l),{},{resources:(0,r.A)((0,r.A)({},l.resources),{},{food:l.resources.food-i.sv.ANTHILL_BUILD_COST})})}),u=h(n,o.owner,a.position,a.type,1);return s[u.id]=u,(0,r.A)((0,r.A)({},e),{},{anthills:s,players:c,ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{hasMoved:!0,hasAttacked:!0,hasBuilt:!0})})})}return l.owner!==o.owner||l.isComplete?e:(l.buildProgress+=1,l.buildProgress>=i.sv.ANTHILL_BUILD_PROGRESS_REQUIRED?s[l.id]=p(l):s[l.id]=l,(0,r.A)((0,r.A)({},e),{},{anthills:s,ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{hasMoved:!0,hasAttacked:!0,hasBuilt:!0})})}))}function b(e,t,n){const r=Object.values(i.GU).find(e=>e.id===t);if(!r)return!1;if(r.requiresQueenTier&&(!n||n.queenTier!==r.requiresQueenTier))return!1;const o=e.upgrades[t]||0;if(o>=r.maxTier)return!1;const a=r.costs[o];return e.resources.food>=a.food&&e.resources.minerals>=a.minerals}function x(e,t){const n=Object.values(i.GU).find(e=>e.id===t);if(!n)return e;const o=e.players[e.currentPlayer],a=Object.values(e.ants).find(t=>"queen"===t.type&&t.owner===e.currentPlayer),s=o.upgrades[t]||0;if(s>=n.maxTier)return e;if(!b(o,t,a))return e;const l=n.costs[s];return(0,r.A)((0,r.A)({},e),{},{players:(0,r.A)((0,r.A)({},e.players),{},{[e.currentPlayer]:(0,r.A)((0,r.A)({},o),{},{resources:{food:o.resources.food-l.food,minerals:o.resources.minerals-l.minerals},upgrades:(0,r.A)((0,r.A)({},o.upgrades),{},{[t]:s+1})})})})}function w(e,t){const r=(0,i.s1)(e.type);let o=r.attack;if(e.bonusAttack&&(o+=e.bonusAttack),r.attackRange<=1){const e=t.upgrades.meleeAttack||0;if(e>0){o+=Math.max(e,Math.floor(.1*r.attack*e))}}else{const e=t.upgrades.rangedAttack||0;if(e>0){o+=Math.max(e,Math.floor(.1*r.attack*e))}}if(t.heroAbilityActive&&t.heroId){const{getHeroById:e}=n(201),i=e(t.heroId),a=null===i||void 0===i?void 0:i.heroAbility;a&&("gorlak"===t.heroId&&a.attackBonus?o=Math.floor(o*(1+a.attackBonus)):"sorlorg"===t.heroId&&r.attackRange>1&&a.rangedDamageBonus?o=Math.floor(o*(1+a.rangedDamageBonus)):"skrazzit"===t.heroId&&a.attackBonus?o=Math.floor(o*(1+a.attackBonus)):"thorgrim"===t.heroId&&a.attackBonus?o+=a.attackBonus:"vexxara"===t.heroId&&a.attackBonus&&(o=Math.floor(o*(1+a.attackBonus))))}return o}function _(e,t,r){const o=(0,i.s1)(e.type);let a=o.defense;const s=t.upgrades.defense||0;if(s>0){a+=Math.max(s,Math.floor(.1*o.defense*s))}if(r&&r.anthills){Object.values(r.anthills).some(t=>t.position.q===e.position.q&&t.position.r===e.position.r)&&(a+=2)}if(r&&r.trees){Object.values(r.trees).some(t=>t.position.q===e.position.q&&t.position.r===e.position.r)&&(a+=i.sv.TREE_DEFENSE_BONUS)}if(t.heroAbilityActive&&t.heroId){const{getHeroById:e}=n(201),r=e(t.heroId),o=null===r||void 0===r?void 0:r.heroAbility;o&&"thorgrim"===t.heroId&&o.defenseBonus&&(a+=o.defenseBonus)}return a}function k(e,t){return e.energy>=t}function S(e,t){return(0,r.A)((0,r.A)({},e),{},{energy:Math.max(0,e.energy-t)})}function C(){return i.sv.EGG_LAY_ENERGY_COST}function A(e,t,o){const a=e.ants[t],s=e.ants[o];if(!a||!s)return e;if("queen"!==a.type&&"healer"!==a.type)return e;const l="healer"===a.type,c=l?i.xr.HEALER.healAmount:i.sv.HEAL_AMOUNT,u=e.players[a.owner],{getHealEnergyCost:d,canQueenHealTwice:h}=n(201),p=l?i.xr.HEALER.healEnergyCost:i.sv.HEAL_ENERGY_COST,f="queen"===a.type?d(p,null===u||void 0===u?void 0:u.heroId):p;if(!k(a,f))return e;if(a.owner!==s.owner)return e;const g=Math.min(s.maxHealth,s.health+c),m="queen"===a.type&&h(null===u||void 0===u?void 0:u.heroId),y=!0===a.hasHealed,v=a.healCount>=2;if(a.hasAttacked&&!m)return e;if(m&&v)return e;const b=(0,r.A)((0,r.A)({},s),{},{health:g});return delete b.plagued,delete b.ensnared,(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},S(a,f)),{},{hasAttacked:!m||(!!y||a.hasAttacked),hasHealed:!0,healCount:(a.healCount||0)+1}),[o]:b})})}function E(e,t,o){var a;const s=e.ants[t];if(!s||"queen"!==s.type)return e;const l=i.xr.QUEEN;if(!k(s,l.revealEnergyCost))return e;if("queen"===(s.queenTier||"queen"))return e;const{getNeighbors:c}=n(624),u=[o,...c(o)],d=(null===(a=e.players[s.owner])||void 0===a?void 0:a.revealedHexes)||[];return(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},S(s,l.revealEnergyCost)),{},{hasAttacked:!0})}),players:(0,r.A)((0,r.A)({},e.players),{},{[s.owner]:(0,r.A)((0,r.A)({},e.players[s.owner]),{},{revealedHexes:[...d,...u.map(e=>e.toString())]})})})}function T(e,t){const n=e.ants[t];if(!n||"queen"!==n.type)return e;const o=n.queenTier||"queen";let a=null;if("queen"===o)a="broodQueen";else{if("broodQueen"!==o)return e;a="swarmQueen"}const s=i.mZ[a],l=e.players[n.owner];return l.resources.food<s.cost.food||l.resources.minerals<s.cost.minerals?e:(0,r.A)((0,r.A)({},e),{},{players:(0,r.A)((0,r.A)({},e.players),{},{[n.owner]:(0,r.A)((0,r.A)({},l),{},{resources:{food:l.resources.food-s.cost.food,minerals:l.resources.minerals-s.cost.minerals}})}),ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},n),{},{queenTier:a,maxEnergy:s.maxEnergy,energy:Math.min(n.energy,s.maxEnergy)})})})}function R(e,t){const n=e.ants[t];if(!n||"queen"!==n.type)return!1;const r=n.queenTier||"queen";if("swarmQueen"===r)return!1;const o="queen"===r?"broodQueen":"swarmQueen",a=i.mZ[o],s=e.players[n.owner];return s.resources.food>=a.cost.food&&s.resources.minerals>=a.cost.minerals}function j(e,t){const n=e.ants[t];if(!n)return e;return e.players[n.owner].upgrades.burrow?"tank"===n.type||"bombardier"===n.type||n.isBurrowed?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},n),{},{isBurrowed:!0,hasMoved:!0})})}):e}function I(e,t){const n=e.ants[t];if(!n||!n.isBurrowed)return e;return Object.values(e.ants).some(e=>e.id!==t&&e.position.q===n.position.q&&e.position.r===n.position.r)?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},n),{},{isBurrowed:!1,hasMoved:!0})})})}function P(e,t){if(!t)return!1;return!!e.players[t.owner].upgrades.burrow&&("queen"!==t.type&&"tank"!==t.type&&"bombardier"!==t.type&&(!t.isBurrowed&&!t.hasMoved))}function M(e,t){const n=e.ants[t];if(!n||!n.isBurrowed)return!1;if(n.hasMoved)return!1;return!Object.values(e.ants).some(e=>e.id!==t&&e.position.q===n.position.q&&e.position.r===n.position.r)}function O(e,t,n){const o=e.ants[t];if(!o)return e;if(!e.players[o.owner].upgrades.connectedTunnels)return e;const i=e.anthills[n];if(!i)return e;if(i.owner!==o.owner)return e;if(!i.isComplete)return e;return Object.values(e.ants).some(e=>e.id!==t&&e.position.q===i.position.q&&e.position.r===i.position.r)?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{position:(0,r.A)({},i.position),hasMoved:!0,hasAttacked:!0})})})}function N(e,t){const n=e.ants[t];if(!n)return[];if(!e.players[n.owner].upgrades.connectedTunnels)return[];const r=Object.values(e.anthills).find(e=>e.owner===n.owner&&e.isComplete&&e.position.q===n.position.q&&e.position.r===n.position.r);return r?Object.values(e.anthills).filter(t=>{if(t.id===r.id)return!1;if(t.owner!==n.owner)return!1;if(!t.isComplete)return!1;return!Object.values(e.ants).some(e=>e.position.q===t.position.q&&e.position.r===t.position.r)}):[]}function D(e,t,o){const a=e.ants[t],s=e.ants[o];if(!a||!s)return e;if("healer"!==a.type)return e;if(a.owner!==s.owner)return e;const l=i.xr.HEALER,c=e.players[a.owner],{getHealEnergyCost:u}=n(201),d=u(l.healEnergyCost,null===c||void 0===c?void 0:c.heroId);if((a.energy||0)<d)return e;if(Math.max(Math.abs(a.position.q-s.position.q),Math.abs(a.position.r-s.position.r),Math.abs(-a.position.q-a.position.r-(-s.position.q-s.position.r)))>l.healRange)return e;const h=Math.min(s.maxHealth,s.health+l.healAmount),p=(0,r.A)((0,r.A)({},s),{},{health:h});return delete p.plagued,delete p.ensnared,(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},a),{},{energy:a.energy-d,hasAttacked:!0}),[o]:p})})}function F(e,t,n){const o=e.ants[t],a=e.ants[n];if(!o||!a)return e;if("healer"!==o.type)return e;if(o.owner===a.owner)return e;if(a.ensnared)return e;const s=i.xr.HEALER;if((o.energy||0)<s.ensnareEnergyCost)return e;return Math.max(Math.abs(o.position.q-a.position.q),Math.abs(o.position.r-a.position.r),Math.abs(-o.position.q-o.position.r-(-a.position.q-a.position.r)))>s.ensnareRange?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{energy:o.energy-s.ensnareEnergyCost,hasAttacked:!0}),[n]:(0,r.A)((0,r.A)({},a),{},{ensnared:s.ensnareDuration})})})}function q(e,t,n){const o=e.ants[t],a=e.ants[n];if(!o||!a)return e;if("cordyphage"!==o.type)return e;if(o.owner===a.owner)return e;if("queen"===a.type)return e;const s=i.xr.CORDYPHAGE,l=e.players[o.owner];if(!l.upgrades.cordycepsPurge||0===l.upgrades.cordycepsPurge)return e;if((o.energy||0)<s.cordycepsEnergyCost)return e;return Math.max(Math.abs(o.position.q-a.position.q),Math.abs(o.position.r-a.position.r),Math.abs(-o.position.q-o.position.r-(-a.position.q-a.position.r)))>s.cordycepsRange?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{energy:o.energy-s.cordycepsEnergyCost,hasAttacked:!0}),[n]:(0,r.A)((0,r.A)({},a),{},{owner:o.owner,hasMoved:!0,hasAttacked:!0})})})}function L(e,t){const n=e.ants[t];if(!n||"cordyphage"!==n.type)return[];const r=i.xr.CORDYPHAGE,o=e.players[n.owner];return o.upgrades.cordycepsPurge&&0!==o.upgrades.cordycepsPurge?(n.energy||0)<r.cordycepsEnergyCost?[]:Object.values(e.ants).filter(e=>{if(e.owner===n.owner)return!1;if("queen"===e.type)return!1;return Math.max(Math.abs(n.position.q-e.position.q),Math.abs(n.position.r-e.position.r),Math.abs(-n.position.q-n.position.r-(-e.position.q-e.position.r)))<=r.cordycepsRange}):[]}function z(e,t,n){const o=e.ants[t],a=e.ants[n];if(!o||!a)return e;if("cordyphage"!==o.type)return e;if(o.owner===a.owner)return e;if(a.plagued)return e;const s=i.xr.CORDYPHAGE;if((o.energy||0)<s.plagueEnergyCost)return e;return Math.max(Math.abs(o.position.q-a.position.q),Math.abs(o.position.r-a.position.r),Math.abs(-o.position.q-o.position.r-(-a.position.q-a.position.r)))>s.plagueRange?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{energy:o.energy-s.plagueEnergyCost,hasAttacked:!0}),[n]:(0,r.A)((0,r.A)({},a),{},{plagued:s.plagueDuration})})})}function H(e,t){const n=e.ants[t];if(!n||"cordyphage"!==n.type)return[];const r=i.xr.CORDYPHAGE;return(n.energy||0)<r.plagueEnergyCost?[]:Object.values(e.ants).filter(e=>{if(e.owner===n.owner)return!1;if(e.plagued)return!1;return Math.max(Math.abs(n.position.q-e.position.q),Math.abs(n.position.r-e.position.r),Math.abs(-n.position.q-n.position.r-(-e.position.q-e.position.r)))<=r.plagueRange})}function B(e,t){const r=e.ants[t];if(!r||"healer"!==r.type)return[];const o=i.xr.HEALER,a=e.players[r.owner],{getHealEnergyCost:s}=n(201),l=s(o.healEnergyCost,null===a||void 0===a?void 0:a.heroId);return(r.energy||0)<l?[]:Object.values(e.ants).filter(e=>{if(e.owner!==r.owner)return!1;if(e.health>=e.maxHealth)return!1;return Math.max(Math.abs(r.position.q-e.position.q),Math.abs(r.position.r-e.position.r),Math.abs(-r.position.q-r.position.r-(-e.position.q-e.position.r)))<=o.healRange})}function W(e,t){const n=e.ants[t];if(!n||"healer"!==n.type)return[];const r=i.xr.HEALER;return(n.energy||0)<r.ensnareEnergyCost?[]:Object.values(e.ants).filter(e=>{if(e.owner===n.owner)return!1;if(e.ensnared)return!1;return Math.max(Math.abs(n.position.q-e.position.q),Math.abs(n.position.r-e.position.r),Math.abs(-n.position.q-n.position.r-(-e.position.q-e.position.r)))<=r.ensnareRange})}function U(e,t){let r=i.mZ[e.queenTier||"queen"].spawningSpots;if(e.heroId){const{getHeroById:t}=n(201),o=t(e.heroId);o&&o.bonuses&&o.bonuses.spawningSpotBonus&&(r+=o.bonuses.spawningSpotBonus)}return t(e.position).slice(0,r)}function V(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e.players[t])return e;const i=e.players[t];if(i.heroPower>=100)return e;const a=n/150*100*o,s=Math.min(100,(i.heroPower||0)+a);return(0,r.A)((0,r.A)({},e),{},{players:(0,r.A)((0,r.A)({},e.players),{},{[t]:(0,r.A)((0,r.A)({},i),{},{heroPower:s})})})}function G(e,t){const n=e.players[t];if(!n)return e;if(n.heroPower<100)return e;if(n.heroAbilityActive)return e;const o=n.heroId;if(!o)return e;const i=(0,r.A)({},e.ants),a=(0,r.A)({},e.players),s=Object.values(i).filter(e=>e.owner===t);switch(o){case"gorlak":case"sorlorg":case"thorgrim":a[t]=(0,r.A)((0,r.A)({},a[t]),{},{heroAbilityEndsOnTurn:e.turn+1});break;case"skrazzit":a[t]=(0,r.A)((0,r.A)({},a[t]),{},{resources:{food:Math.floor(1.5*n.resources.food),minerals:Math.floor(1.5*n.resources.minerals)},heroAbilityEndsOnTurn:e.turn+1});break;case"vexxara":s.forEach(e=>{const t=(0,r.A)((0,r.A)({},e),{},{health:e.maxHealth});void 0!==e.maxEnergy&&(t.energy=e.maxEnergy),i[e.id]=t}),a[t]=(0,r.A)((0,r.A)({},a[t]),{},{heroAbilityEndsOnTurn:e.turn+1})}return a[t]=(0,r.A)((0,r.A)({},a[t]),{},{heroPower:0,heroAbilityActive:!0}),(0,r.A)((0,r.A)({},e),{},{players:a,ants:i})}},555:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function i(e,t,n){return(t=o(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{A:()=>s})},579:(e,t,n)=>{e.exports=n(799)},606:(e,t,n)=>{n.d(t,{h1:()=>s,uA:()=>o});var r=n(776);class o{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const i="[DEFAULT]";class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(r)return null;throw o}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(o)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(r,o);const i=this.instances.get(r);return i&&e(i,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const o of n)try{o(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(o=t,o===i?void 0:o),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var o;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class s{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},624:(e,t,n)=>{n.r(t),n.d(t,{HexCoord:()=>r,generateSquareGrid:()=>p,generateTriangleGrid:()=>h,getMovementRange:()=>d,getMovementRangeWithPaths:()=>u,getNeighbors:()=>o,getPlayerStartingPositions:()=>y,hexDistance:()=>i,hexToPixel:()=>s,hexesInRange:()=>a,isValidHex:()=>c,isValidSquareHex:()=>f,mirrorPositions:()=>v,pixelToHex:()=>l,rotateHex120:()=>g,rotateHex90:()=>m});class r{constructor(e,t){this.q=e,this.r=t}toString(){return"".concat(this.q,",").concat(this.r)}static fromString(e){const[t,n]=e.split(",").map(Number);return new r(t,n)}equals(e){return this.q===e.q&&this.r===e.r}}function o(e){return[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}].map(t=>new r(e.q+t.q,e.r+t.r))}function i(e,t){return(Math.abs(e.q-t.q)+Math.abs(e.q+e.r-t.q-t.r)+Math.abs(e.r-t.r))/2}function a(e,t){const n=[];for(let o=-t;o<=t;o++)for(let i=Math.max(-t,-o-t);i<=Math.min(t,-o+t);i++){const t=new r(e.q+o,e.r+i);n.push(t)}return n}function s(e,t){return{x:t*(1.5*e.q),y:t*(Math.sqrt(3)/2*e.q+Math.sqrt(3)*e.r)}}function l(e,t,n){return function(e,t){const n=-e-t;let o=Math.round(e),i=Math.round(t),a=Math.round(n);const s=Math.abs(o-e),l=Math.abs(i-t),c=Math.abs(a-n);s>l&&s>c?o=-i-a:l>c&&(i=-o-a);return new r(o,i)}(2/3*e/n,(-1/3*e+Math.sqrt(3)/3*t)/n)}function c(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rectangle";if("square"===n){return f(e,t,Math.floor(.75*t))}if("triangle"===n){const n=t,r=-e.q-e.r;return e.r<=0&&e.q>=-(n-1)&&e.q<=n-1&&r>=-(n-1)&&r<=n-1}return Math.abs(e.q)<=t&&Math.abs(e.r)<=t&&Math.abs(e.q+e.r)<=t}function u(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"rectangle";const s=new Set,l=[[e,0,[]]];s.add(e.toString());const u=[];for(;l.length>0;){const[e,d,h]=l.shift();if(d>0&&!i.some(t=>t.equals(e))&&u.push({hex:e,path:[...h,e]}),d<t){const t=o(e);for(const o of t){const t=o.toString();s.has(t)||!c(o,n,a)||r.some(e=>e.equals(o))||(s.add(t),l.push([o,d+1,[...h,e]]))}}}return u}function d(e,t,n){return u(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:"rectangle").map(e=>e.hex)}function h(e){const t=[];for(let n=-(e-1);n<=e-1;n++){const o=Math.max(-(e-1),-n-(e-1)),i=Math.min(0,e-1-n);for(let e=o;e<=i;e++)t.push(new r(n,e))}return t}function p(e,t){const n=[],o=Math.floor(e/2),i=Math.floor(t/2);for(let a=-o;a<=o;a++)for(let e=-i;e<=i;e++){const t=a,o=e-Math.floor((a-(1&a))/2);n.push(new r(t,o))}return n}function f(e,t,n){const r=Math.floor(t/2),o=Math.floor(n/2),i=e.q,a=e.r+Math.floor((e.q-(1&e.q))/2);return i>=-r&&i<=r&&a>=-o&&a<=o}function g(e){return new r(-e.q-e.r,e.q)}function m(e){return new r(-e.r,e.q+e.r)}function y(e,t){if("triangle"===e||"rectangle"===e&&3===(arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)){const e=t-1;return[new r(e-1,-(e-1)),new r(0,e-1),new r(-(e-1),0)]}if("square"===e){const e=t,n=Math.floor(.75*t),o=Math.floor(e/2),i=Math.floor(n/2),a=(e,t)=>{const n=e,o=t-Math.floor((e-(1&e))/2);return new r(n,o)};return[a(0,1-i),a(o-1,0),a(0,i-1),a(1-o,0)]}{const e=t-1;return[new r(0,e),new r(0,-e)]}}function v(e,t){if(2===t)return e.map(e=>new r(-e.q,-e.r));if(3===t){const t=[...e];return e.forEach(e=>{const n=g(e),r=g(n);t.push(n,r)}),t}if(4===t){const t=[...e];return e.forEach(e=>{const n=m(e),r=m(n),o=m(r);t.push(n,r,o)}),t}return e}},672:(e,t,n)=>{var r=n(43);function o(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var a={d:{f:i,r:function(){throw Error(o(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},s=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(o(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=a.p;try{if(l.T=null,a.p=2,e)return e()}finally{l.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),o="string"===typeof t.integrity?t.integrity:void 0,i="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:o,fetchPriority:i}):"script"===n&&a.d.X(e,{crossOrigin:r,integrity:o,fetchPriority:i,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.0"},776:(e,t,n)=>{n.d(t,{cY:()=>x,FA:()=>O,g:()=>M,gz:()=>K,vA:()=>i,Hk:()=>a,K3:()=>l,u:()=>h,KA:()=>u,Uj:()=>d,gR:()=>H,Fy:()=>k,A4:()=>p,bD:()=>V,dI:()=>Y,T9:()=>b,yU:()=>v,Ku:()=>X,qc:()=>z,zJ:()=>w,Im:()=>W,zW:()=>I,jZ:()=>T,$g:()=>j,lV:()=>R,Cv:()=>L,$L:()=>D,kH:()=>U,gE:()=>_,Am:()=>Q,yw:()=>B,OE:()=>Z,kj:()=>$,As:()=>F,P1:()=>A,eX:()=>P});var r=n(555);const o={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+o.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},s=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):55296===(64512&o)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<e.length;o+=3){const t=e[o],i=o+1<e.length,a=i?e[o+1]:0,s=o+2<e.length,l=s?e[o+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;s||(h=64,i||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(s(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){const i=e[n++];t[r++]=String.fromCharCode((31&o)<<6|63&i)}else if(o>239&&o<365){const i=((7&o)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&o)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<e.length;){const t=n[e.charAt(o++)],i=o<e.length?n[e.charAt(o)]:0;++o;const a=o<e.length?n[e.charAt(o)]:64;++o;const s=o<e.length?n[e.charAt(o)]:64;if(++o,null==t||null==i||null==a||null==s)throw new c;const l=t<<2|i>>4;if(r.push(l),64!==a){const e=i<<4&240|a>>2;if(r.push(e),64!==s){const e=a<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=s(e);return l.encodeByteArray(t,!0)},d=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return l.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function p(e){return f(void 0,e)}function f(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&g(n)&&(e[n]=f(e[n],t[n]));return e}function g(e){return"__proto__"!==e}const m=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,y=()=>{try{return m()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/Battle-Ants",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},v=e=>{const t=(e=>{var t;return null===(t=y())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},b=()=>{var e;return null===(e=y())||void 0===e?void 0:e.config};class x{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function w(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function _(e){return(await fetch(e,{credentials:"include"})).ok}function k(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",o=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=(0,r.A)({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:o,exp:o+3600,auth_time:o,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(a)),""].join(".")}const S={};let C=!1;function A(e,t){if("undefined"===typeof window||"undefined"===typeof document||!w(window.location.host)||S[e]===t||S[e]||C)return;function n(e){return"__firebase__banner__".concat(e)}S[e]=t;const r="__firebase__banner",o=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(S))S[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{C=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),s=n("learnmore"),l=document.getElementById(s)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,s);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}o?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function E(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function T(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(E())}function R(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function j(){return!0===o.NODE_CLIENT||!0===o.NODE_ADMIN}function I(){try{return"object"===typeof indexedDB}catch(e){return!1}}function P(){return new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},o.onupgradeneeded=()=>{n=!1},o.onerror=()=>{var e;t((null===(e=o.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})}class M extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,M.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,O.prototype.create)}}class O{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],o=r?function(e,t){return e.replace(N,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",i="".concat(this.serviceName,": ").concat(o," (").concat(n,").");return new M(n,i,t)}}const N=/\{\$([^}]+)}/g;function D(e){return JSON.parse(e)}function F(e){return JSON.stringify(e)}const q=function(e){let t={},n={},r={},o="";try{const i=e.split(".");t=D(h(i[0])||""),n=D(h(i[1])||""),o=i[2],r=n.d||{},delete n.d}catch(i){}return{header:t,claims:n,data:r,signature:o}},L=function(e){const t=q(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},z=function(e){const t=q(e).claims;return"object"===typeof t&&!0===t.admin};function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function B(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function W(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function U(e,t,n){const r={};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=t.call(n,e[o],o,e));return r}function V(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const o of n){if(!r.includes(o))return!1;const n=e[o],i=t[o];if(G(n)&&G(i)){if(!V(n,i))return!1}else if(n!==i)return!1}for(const o of r)if(!n.includes(o))return!1;return!0}function G(e){return null!==e&&"object"===typeof e}function Q(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}class K{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,o,i=this.chain_[0],a=this.chain_[1],s=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=l^a&(s^l),o=1518500249):(r=a^s^l,o=1859775393):u<60?(r=a&s|l&(a|s),o=2400959708):(r=a^s^l,o=3395469782);const e=(i<<5|i>>>27)+r+c+o+n[u]&4294967295;c=l,l=s,s=4294967295&(a<<30|a>>>2),a=i,i=e}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const o=this.buf_;let i=this.inbuf_;for(;r<t;){if(0===i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(o[i]=e.charCodeAt(r),++i,++r,i===this.blockSize){this.compress_(o),i=0;break}}else for(;r<t;)if(o[i]=e[r],++i,++r,i===this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}function Y(e,t){return"".concat(e," failed: ").concat(t," argument ")}const $=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);if(o>=55296&&o<=56319){const t=o-55296;r++,i(r<e.length,"Surrogate pair missing trail surrogate.");o=65536+(t<<10)+(e.charCodeAt(r)-56320)}o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):o<65536?(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},Z=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function X(e){return e&&e._delegate?e._delegate:e}},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function o(e,t,r){var o=null;if(void 0!==r&&(o=""+r),void 0!==t.key&&(o=""+t.key),"key"in t)for(var i in r={},t)"key"!==i&&(r[i]=t[i]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:o,ref:void 0!==t?t:null,props:r}}t.Fragment=r,t.jsx=o,t.jsxs=o},800:(e,t,n)=>{n.d(t,{get:()=>Oo,C3:()=>Wo,Zy:()=>qo,KR:()=>Ro,TF:()=>Io,hZ:()=>Po,yo:()=>Mo});var r=n(555),o=n(232),i=n(606),a=n(776),s=n(965);const l="@firebase/database",c="1.1.0";let u="";function d(e){u=e}class h{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,a.As)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,a.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class p{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,a.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const f=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new h(t)}}catch(t){}return new p},g=f("localStorage"),m=f("sessionStorage"),y=new s.Vy("@firebase/database"),v=function(){let e=1;return function(){return e++}}(),b=function(e){const t=(0,a.kj)(e),n=new a.gz;n.update(t);const r=n.digest();return a.K3.encodeByteArray(r)},x=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=x.apply(null,n):e+="object"===typeof n?(0,a.As)(n):n,e+=" "}return e};let w=null,_=!0;const k=function(e,t){(0,a.vA)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(y.logLevel=s.$b.VERBOSE,w=y.log.bind(y),t&&m.set("logging_enabled",!0)):"function"===typeof e?w=e:(w=null,m.remove("logging_enabled"))},S=function(){if(!0===_&&(_=!1,null===w&&!0===m.get("logging_enabled")&&k(!0)),w){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=x.apply(null,t);w(r)}},C=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];S(e,...n)}},A=function(){const e="FIREBASE INTERNAL ERROR: "+x(...arguments);y.error(e)},E=function(){const e="FIREBASE FATAL ERROR: ".concat(x(...arguments));throw y.error(e),new Error(e)},T=function(){const e="FIREBASE WARNING: "+x(...arguments);y.warn(e)},R=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},j="[MIN_NAME]",I="[MAX_NAME]",P=function(e,t){if(e===t)return 0;if(e===j||t===I)return-1;if(t===j||e===I)return 1;{const n=z(e),r=z(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},M=function(e,t){return e===t?0:e<t?-1:1},O=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+(0,a.As)(t))},N=function(e){if("object"!==typeof e||null===e)return(0,a.As)(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=(0,a.As)(t[r]),n+=":",n+=N(e[t[r]]);return n+="}",n},D=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let o=0;o<n;o+=t)o+t>n?r.push(e.substring(o,n)):r.push(e.substring(o,o+t));return r};function F(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const q=function(e){(0,a.vA)(!R(e),"Invalid JSON number");const t=1023;let n,r,o,i,s;0===e?(r=0,o=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=i+t,o=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,o=Math.round(e/Math.pow(2,-1074))));const l=[];for(s=52;s;s-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(s=11;s;s-=1)l.push(r%2?1:0),r=Math.floor(r/2);l.push(n?1:0),l.reverse();const c=l.join("");let u="";for(s=0;s<64;s+=8){let e=parseInt(c.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const L=new RegExp("^-?(0*)\\d{1,10}$"),z=function(e){if(L.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},H=function(e){try{e()}catch(t){setTimeout(()=>{const e=t.stack||"";throw T("Exception was thrown by user callback.",e),t},Math.floor(0))}},B=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class W{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,(0,o.xZ)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then(e=>this.appCheck=e)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){T('Provided AppCheck credentials for the app named "'.concat(this.appName,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class U{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(S("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',T(e)}}class V{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}V.OWNER="owner";const G="5",Q=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,K="ac",Y="websocket",$="long_polling";class Z{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=o,this.persistenceKey=i,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=s,this.emulatorOptions=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=g.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&g.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function X(e,t,n){let r;if((0,a.vA)("string"===typeof t,"typeof type must == string"),(0,a.vA)("object"===typeof n,"typeof params must == object"),t===Y)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==$)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const o=[];return F(n,(e,t)=>{o.push(e+"="+t)}),r+o.join("&")}class J{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;(0,a.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,a.A4)(this.counters_)}}const ee={},te={};function ne(e){const t=e.toString();return ee[t]||(ee[t]=new J),ee[t]}class re{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&H(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const oe="start";class ie{constructor(e,t,n,r,o,i,a){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=o,this.transportSessionId=i,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=C(e),this.stats_=ne(t),this.urlFn=e=>(this.appCheckToken&&(e[K]=this.appCheckToken),X(t,$,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new re(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if((0,a.$g)()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ae(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[o,i,a,s,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,o===oe)n.id=i,n.password=a;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,()=>{n.onClosed_()})):n.onClosed_()}},function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[o,i]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(o,i)},()=>{this.onClosed_()},this.urlFn);const e={};e[oe]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=G,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[K]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Q.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ie.forceAllow_=!0}static forceDisallow(){ie.forceDisallow_=!0}static isAvailable(){return!(0,a.$g)()&&(!!ie.forceAllow_||!ie.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=(0,a.KA)(t),r=D(n,1840);for(let o=0;o<r.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,a.$g)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,a.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ae{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,a.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ae.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(o){S("frame writing exception"),o.stack&&S(o.stack),S(o)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||S("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(r),n()})}addTag(e,t){(0,a.$g)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{S("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}},Math.floor(1))}}let se=null;"undefined"!==typeof MozWebSocket?se=MozWebSocket:"undefined"!==typeof WebSocket&&(se=WebSocket);class le{constructor(e,t,n,r,o,i,a){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=C(this.connId),this.stats_=ne(t),this.connURL=le.connectionURL_(t,i,a,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,o){const i={};return i.v=G,!(0,a.$g)()&&"undefined"!==typeof location&&location.hostname&&Q.test(location.hostname)&&(i.r="f"),t&&(i.s=t),n&&(i.ls=n),r&&(i[K]=r),o&&(i.p=o),X(e,Y,i)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,g.set("previous_websocket_failure",!0);try{let e;if((0,a.$g)()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(G,"/").concat(u,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:"/Battle-Ants",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new se(this.connURL,[],e)}catch(n){this.log_("Error instantiating WebSocket.");const e=n.message||n.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){le.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==se&&!le.forceDisallow_}static previouslyFailed(){return g.isInMemoryStorage||!0===g.get("previous_websocket_failure")}markConnectionHealthy(){g.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=(0,a.$L)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,a.vA)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=(0,a.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=D(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}le.responsesRequiredToBeHealthy=2,le.healthyTimeout=3e4;class ce{static get ALL_TRANSPORTS(){return[ie,le]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(e){this.initTransports_(e)}initTransports_(e){const t=le&&le.isAvailable();let n=t&&!le.previouslyFailed();if(e.webSocketOnly&&(t||T("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[le];else{const e=this.transports_=[];for(const t of ce.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ce.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ce.globalTransportInitialized_=!1;class ue{constructor(e,t,n,r,o,i,a,s,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=o,this.onMessage_=i,this.onReady_=a,this.onDisconnect_=s,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=C("c:"+this.id+":"),this.transportManager_=new ce(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=B(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=O("t",e),n=O("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=O("t",e),n=O("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=O("t",e);if("d"in e){const n=e.d;if("h"===t){const e=(0,r.A)({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?A("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):A("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),G!==n&&T("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),B(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):B(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(g.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class de{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class he{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,a.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const o=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<o.length;e++)o[e].callback.apply(o[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let o=0;o<r.length;o++)if(r[o].callback===t&&(!n||n===r[o].context))return void r.splice(o,1)}validateEventType_(e){(0,a.vA)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class pe extends he{static getInstance(){return new pe}constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,a.jZ)()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return(0,a.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class fe{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function ge(){return new fe("")}function me(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function ye(e){return e.pieces_.length-e.pieceNum_}function ve(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new fe(e.pieces_,t)}function be(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function we(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new fe(t,0)}function _e(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof fe)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new fe(n,0)}function ke(e){return e.pieceNum_>=e.pieces_.length}function Se(e,t){const n=me(e),r=me(t);if(null===n)return t;if(n===r)return Se(ve(e),ve(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Ce(e,t){const n=xe(e,0),r=xe(t,0);for(let o=0;o<n.length&&o<r.length;o++){const e=P(n[o],r[o]);if(0!==e)return e}return n.length===r.length?0:n.length<r.length?-1:1}function Ae(e,t){if(ye(e)!==ye(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Ee(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(ye(e)>ye(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Te{constructor(e,t){this.errorPrefix_=t,this.parts_=xe(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,a.OE)(this.parts_[n]);Re(this)}}function Re(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+je(e))}function je(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Ie extends he{static getInstance(){return new Ie}constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}getInitialEvent(e){return(0,a.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Pe=1e3;class Me extends de{constructor(e,t,n,r,o,i,s,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=o,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.authOverride_=l,this.id=Me.nextPersistentConnectionId_++,this.log_=C("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pe,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!(0,a.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Ie.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&pe.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,o={r:r,a:e,b:t};this.log_((0,a.As)(o)),(0,a.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new a.cY,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const o=e._queryIdentifier,i=e._path.toString();this.log_("Listen called for "+i+" "+o),this.listens.has(i)||this.listens.set(i,new Map),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,a.vA)(!this.listens.get(i).has(o),"listen() called twice for same path/queryId.");const s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(i).set(o,s),this.connected_&&this.sendListen_(s)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const o={p:n};e.tag&&(o.q=t._queryObject,o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,o=>{const i=o.d,a=o.s;Me.warnOnListenWarnings_(i,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",o),"ok"!==a&&this.removeListen_(n,r),e.onComplete&&e.onComplete(a,i))})}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&(0,a.gR)(e,"w")){const n=(0,a.yw)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();T("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||(0,a.qc)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=(0,a.Cv)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,a.vA)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const o={p:e};r&&(o.q=n,o.t=r),this.sendRequest("n",o)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const o={p:t,d:n};this.log_("onDisconnect "+e,o),this.sendRequest(e,o,e=>{r&&setTimeout(()=>{r(e.s,e.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,o){this.initConnection_();const i={p:t,d:n};void 0!==o&&(i.h=o),this.outstandingPuts_.push({action:e,request:i,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)})}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,a.As)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):A("Unrecognized action received from server: "+(0,a.As)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,a.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Pe),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=Math.max(0,(new Date).getTime()-this.lastConnectionAttemptTime_);let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Me.nextConnectionId_++,o=this.lastSessionId;let i=!1,s=null;const l=function(){s?s.close():(i=!0,n())},c=function(e){(0,a.vA)(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);i?S("getToken() completed but was canceled"):(S("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,s=new ue(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{T(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},o))}catch(A){this.log_("Failed to get token: "+A),i||(this.repoInfo_.nodeAdmin&&T(A),l())}}}interrupt(e){S("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){S("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,a.Im)(this.interruptReasons_)&&(this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>N(e)).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new fe(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){S("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){S("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";(0,a.$g)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+u.replace(/\./g,"-")]=1,(0,a.jZ)()?e["framework.cordova"]=1:(0,a.lV)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pe.getInstance().currentlyOnline();return(0,a.Im)(this.interruptReasons_)&&e}}Me.nextPersistentConnectionId_=0,Me.nextConnectionId_=0;class Oe{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Oe(e,t)}}class Ne{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Oe(j,e),r=new Oe(j,t);return 0!==this.compare(n,r)}minPost(){return Oe.MIN}}let De;class Fe extends Ne{static get __EMPTY_NODE(){return De}static set __EMPTY_NODE(e){De=e}compare(e,t){return P(e.name,t.name)}isDefinedOn(e){throw(0,a.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Oe.MIN}maxPost(){return new Oe(I,De)}makePost(e,t){return(0,a.vA)("string"===typeof e,"KeyIndex indexValue must always be a string."),new Oe(e,De)}toString(){return".key"}}const qe=new Fe;class Le{constructor(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=o,this.nodeStack_=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse_?e.left:e.right;else{if(0===i){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ze{constructor(e,t,n,r,o){this.key=e,this.value=t,this.color=null!=n?n:ze.RED,this.left=null!=r?r:He.EMPTY_NODE,this.right=null!=o?o:He.EMPTY_NODE}copy(e,t,n,r,o){return new ze(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=o?o:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const o=n(e,r.key);return r=o<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===o?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return He.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return He.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ze.RED=!0,ze.BLACK=!1;class He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new He(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,ze.BLACK,null,null))}remove(e){return new He(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ze.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Le(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Le(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Le(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Le(this.root_,null,this.comparator_,!0,e)}}function Be(e,t){return P(e.name,t.name)}function We(e,t){return P(e,t)}let Ue;He.EMPTY_NODE=new class{copy(e,t,n,r,o){return this}insert(e,t,n){return new ze(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Ve=function(e){return"number"===typeof e?"number:"+q(e):"string:"+e},Ge=function(e){if(e.isLeafNode()){const t=e.val();(0,a.vA)("string"===typeof t||"number"===typeof t||"object"===typeof t&&(0,a.gR)(t,".sv"),"Priority must be a string or number.")}else(0,a.vA)(e===Ue||e.isEmpty(),"priority of unexpected type.");(0,a.vA)(e===Ue||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Qe,Ke,Ye;class $e{static set __childrenNodeConstructor(e){Qe=e}static get __childrenNodeConstructor(){return Qe}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$e.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,a.vA)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Ge(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new $e(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:$e.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return ke(e)?this:".priority"===me(e)?this.priorityNode_:$e.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:$e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=me(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,a.vA)(".priority"!==n||1===ye(e),".priority must be the last token in a path"),this.updateImmediateChild(n,$e.__childrenNodeConstructor.EMPTY_NODE.updateChild(ve(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ve(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?q(this.value_):this.value_,this.lazyHash_=b(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===$e.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof $e.__childrenNodeConstructor?-1:((0,a.vA)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=$e.VALUE_TYPE_ORDER.indexOf(t),o=$e.VALUE_TYPE_ORDER.indexOf(n);return(0,a.vA)(r>=0,"Unknown leaf type: "+t),(0,a.vA)(o>=0,"Unknown leaf type: "+n),r===o?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}$e.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Ze=new class extends Ne{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),o=n.compareTo(r);return 0===o?P(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Oe.MIN}maxPost(){return new Oe(I,new $e("[PRIORITY-POST]",Ye))}makePost(e,t){const n=Ke(e);return new Oe(t,new $e("[PRIORITY-POST]",n))}toString(){return".priority"}},Xe=Math.log(2);class Je{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Xe,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const et=function(e,t,n,r){e.sort(t);const o=function(t,r){const i=r-t;let a,s;if(0===i)return null;if(1===i)return a=e[t],s=n?n(a):a,new ze(s,a.node,ze.BLACK,null,null);{const l=parseInt(i/2,10)+t,c=o(t,l),u=o(l+1,r);return a=e[l],s=n?n(a):a,new ze(s,a.node,ze.BLACK,c,u)}},i=function(t){let r=null,i=null,a=e.length;const s=function(t,r){const i=a-t,s=a;a-=t;const c=o(i+1,s),u=e[i],d=n?n(u):u;l(new ze(d,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(i=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?s(r,ze.BLACK):(s(r,ze.BLACK),s(r,ze.RED))}return i}(new Je(e.length));return new He(r||t,i)};let tt;const nt={};class rt{static get Default(){return(0,a.vA)(nt&&Ze,"ChildrenNode.ts has not been loaded"),tt=tt||new rt({".priority":nt},{".priority":Ze}),tt}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=(0,a.yw)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof He?t:null}hasIndex(e){return(0,a.gR)(this.indexSet_,e.toString())}addIndex(e,t){(0,a.vA)(e!==qe,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let o=!1;const i=t.getIterator(Oe.Wrap);let s,l=i.getNext();for(;l;)o=o||e.isDefinedOn(l.node),n.push(l),l=i.getNext();s=o?et(n,e.getCompare()):nt;const c=e.toString(),u=(0,r.A)({},this.indexSet_);u[c]=e;const d=(0,r.A)({},this.indexes_);return d[c]=s,new rt(d,u)}addToIndexes(e,t){const n=(0,a.kH)(this.indexes_,(n,r)=>{const o=(0,a.yw)(this.indexSet_,r);if((0,a.vA)(o,"Missing index implementation for "+r),n===nt){if(o.isDefinedOn(e.node)){const n=[],r=t.getIterator(Oe.Wrap);let i=r.getNext();for(;i;)i.name!==e.name&&n.push(i),i=r.getNext();return n.push(e),et(n,o.getCompare())}return nt}{const r=t.get(e.name);let o=n;return r&&(o=o.remove(new Oe(e.name,r))),o.insert(e,e.node)}});return new rt(n,this.indexSet_)}removeFromIndexes(e,t){const n=(0,a.kH)(this.indexes_,n=>{if(n===nt)return n;{const r=t.get(e.name);return r?n.remove(new Oe(e.name,r)):n}});return new rt(n,this.indexSet_)}}let ot;class it{static get EMPTY_NODE(){return ot||(ot=new it(new He(We),null,rt.Default))}constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ge(this.priorityNode_),this.children_.isEmpty()&&(0,a.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ot}updatePriority(e){return this.children_.isEmpty()?this:new it(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?ot:t}}getChild(e){const t=me(e);return null===t?this:this.getImmediateChild(t).getChild(ve(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,a.vA)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Oe(e,t);let r,o;t.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),o=this.indexMap_.addToIndexes(n,this.children_));const i=r.isEmpty()?ot:this.priorityNode_;return new it(r,i,o)}}updateChild(e,t){const n=me(e);if(null===n)return t;{(0,a.vA)(".priority"!==me(e)||1===ye(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(ve(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,o=!0;if(this.forEachChild(Ze,(i,a)=>{t[i]=a.val(e),n++,o&&it.INTEGER_REGEXP_.test(i)?r=Math.max(r,Number(i)):o=!1}),!e&&o&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ve(this.getPriority().val())+":"),this.forEachChild(Ze,(t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":b(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Oe(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Oe(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Oe(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{const n=this.children_.getIteratorFrom(e.name,Oe.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{const n=this.children_.getReverseIteratorFrom(e.name,Oe.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===at?-1:0}withIndex(e){if(e===qe||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new it(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===qe||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Ze),n=t.getIterator(Ze);let r=e.getNext(),o=n.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=e.getNext(),o=n.getNext()}return null===r&&null===o}return!1}return!1}}resolveIndex_(e){return e===qe?null:this.indexMap_.get(e.toString())}}it.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const at=new class extends it{constructor(){super(new He(We),it.EMPTY_NODE,rt.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return it.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Oe,{MIN:{value:new Oe(j,it.EMPTY_NODE)},MAX:{value:new Oe(I,at)}}),Fe.__EMPTY_NODE=it.EMPTY_NODE,$e.__childrenNodeConstructor=it,Ue=at,function(e){Ye=e}(at);const st=!0;function lt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return it.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),(0,a.vA)(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new $e(e,lt(t))}if(e instanceof Array||!st){let n=it.EMPTY_NODE;return F(e,(t,r)=>{if((0,a.gR)(e,t)&&"."!==t.substring(0,1)){const e=lt(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}}),n.updatePriority(lt(t))}{const n=[];let r=!1;if(F(e,(e,t)=>{if("."!==e.substring(0,1)){const o=lt(t);o.isEmpty()||(r=r||!o.getPriority().isEmpty(),n.push(new Oe(e,o)))}}),0===n.length)return it.EMPTY_NODE;const o=et(n,Be,e=>e.name,We);if(r){const e=et(n,Ze.getCompare());return new it(o,lt(t),new rt({".priority":e},{".priority":Ze}))}return new it(o,lt(t),rt.Default)}}!function(e){Ke=e}(lt);class ct extends Ne{constructor(e){super(),this.indexPath_=e,(0,a.vA)(!ke(e)&&".priority"!==me(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),o=n.compareTo(r);return 0===o?P(e.name,t.name):o}makePost(e,t){const n=lt(e),r=it.EMPTY_NODE.updateChild(this.indexPath_,n);return new Oe(t,r)}maxPost(){const e=it.EMPTY_NODE.updateChild(this.indexPath_,at);return new Oe(I,e)}toString(){return xe(this.indexPath_,0).join("/")}}const ut=new class extends Ne{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?P(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Oe.MIN}maxPost(){return Oe.MAX}makePost(e,t){const n=lt(e);return new Oe(t,n)}toString(){return".value"}};function dt(e){return{type:"value",snapshotNode:e}}function ht(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function pt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function ft(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class gt{constructor(e){this.index_=e}updateChild(e,t,n,r,o,i){(0,a.vA)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=i&&(n.isEmpty()?e.hasChild(t)?i.trackChildChange(pt(t,s)):(0,a.vA)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?i.trackChildChange(ht(t,n)):i.trackChildChange(ft(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Ze,(e,r)=>{t.hasChild(e)||n.trackChildChange(pt(e,r))}),t.isLeafNode()||t.forEachChild(Ze,(t,r)=>{if(e.hasChild(t)){const o=e.getImmediateChild(t);o.equals(r)||n.trackChildChange(ft(t,r,o))}else n.trackChildChange(ht(t,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?it.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class mt{constructor(e){this.indexedFilter_=new gt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=mt.getStartPost_(e),this.endPost_=mt.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,o,i){return this.matches(new Oe(t,n))||(n=it.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,o,i)}updateFullNode(e,t,n){t.isLeafNode()&&(t=it.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(it.EMPTY_NODE);const o=this;return t.forEachChild(Ze,(e,t)=>{o.matches(new Oe(e,t))||(r=r.updateImmediateChild(e,it.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class yt{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new mt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,o,i){return this.rangedFilter_.matches(new Oe(t,n))||(n=it.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,o,i):this.fullLimitUpdateChild_(e,t,n,o,i)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=it.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=it.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(it.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,it.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,o){let i;if(this.reverse_){const e=this.index_.getCompare();i=(t,n)=>e(n,t)}else i=this.index_.getCompare();const s=e;(0,a.vA)(s.numChildren()===this.limit_,"");const l=new Oe(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(s.hasChild(t)){const e=s.getImmediateChild(t);let a=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=a&&(a.name===t||s.hasChild(a.name));)a=r.getChildAfterChild(this.index_,a,this.reverse_);const d=null==a?1:i(a,l);if(u&&!n.isEmpty()&&d>=0)return null!=o&&o.trackChildChange(ft(t,n,e)),s.updateImmediateChild(t,n);{null!=o&&o.trackChildChange(pt(t,e));const n=s.updateImmediateChild(t,it.EMPTY_NODE);return null!=a&&this.rangedFilter_.matches(a)?(null!=o&&o.trackChildChange(ht(a.name,a.node)),n.updateImmediateChild(a.name,a.node)):n}}return n.isEmpty()?e:u&&i(c,l)>=0?(null!=o&&(o.trackChildChange(pt(c.name,c.node)),o.trackChildChange(ht(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,it.EMPTY_NODE)):e}}class vt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ze}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,a.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:j}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,a.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:I}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,a.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ze}copy(){const e=new vt;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function bt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===Ze?n="$priority":e.index_===ut?n="$value":e.index_===qe?n="$key":((0,a.vA)(e.index_ instanceof ct,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=(0,a.As)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=(0,a.As)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+(0,a.As)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=(0,a.As)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+(0,a.As)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function xt(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Ze&&(t.i=e.index_.toString()),t}class wt extends de{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,a.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=C("p:rest:"),this.listens_={}}listen(e,t,n,r){const o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);const i=wt.getListenId_(e,n),s={};this.listens_[i]=s;const l=bt(e._queryParams);this.restRequest_(o+".json",l,(e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(o,l,!1,n),(0,a.yw)(this.listens_,i)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}})}unlisten(e,t){const n=wt.getListenId_(e,t);delete this.listens_[n]}get(e){const t=bt(e._queryParams),n=e._path.toString(),r=new a.cY;return this.restRequest_(n+".json",t,(e,t)=>{let o=t;404===e&&(o=null,e=null),null===e?(this.onDataUpdate_(n,o,!1,null),r.resolve(o)):r.reject(new Error(o))}),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(r=>{let[o,i]=r;o&&o.accessToken&&(t.auth=o.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,a.Am)(t);this.log_("Sending REST request for "+s);const l=new XMLHttpRequest;l.onreadystatechange=()=>{if(n&&4===l.readyState){this.log_("REST Response for "+s+" received. status:",l.status,"response:",l.responseText);let t=null;if(l.status>=200&&l.status<300){try{t=(0,a.$L)(l.responseText)}catch(e){T("Failed to parse JSON response for "+s+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&T("Got unsuccessful REST response for "+s+" Status: "+l.status),n(l.status);n=null}},l.open("GET",s,!0),l.send()})}}class _t{constructor(){this.rootNode_=it.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function kt(){return{value:null,children:new Map}}function St(e,t,n){if(ke(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=me(t);e.children.has(r)||e.children.set(r,kt());St(e.children.get(r),t=ve(t),n)}}function Ct(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,r)=>{Ct(r,new fe(t.toString()+"/"+e),n)})}class At{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=(0,r.A)({},e);return this.last_&&F(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class Et{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new At(e);const n=1e4+2e4*Math.random();B(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;F(e,(e,r)=>{r>0&&(0,a.gR)(this.statsToReport_,e)&&(t[e]=r,n=!0)}),n&&this.server_.reportStats(t),B(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Tt;function Rt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Tt||(Tt={}));class jt{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Tt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(ke(this.path)){if(null!=this.affectedTree.value)return(0,a.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new fe(e));return new jt(ge(),t,this.revert)}}return(0,a.vA)(me(this.path)===e,"operationForChild called for unrelated child."),new jt(ve(this.path),this.affectedTree,this.revert)}}class It{constructor(e,t){this.source=e,this.path=t,this.type=Tt.LISTEN_COMPLETE}operationForChild(e){return ke(this.path)?new It(this.source,ge()):new It(this.source,ve(this.path))}}class Pt{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Tt.OVERWRITE}operationForChild(e){return ke(this.path)?new Pt(this.source,ge(),this.snap.getImmediateChild(e)):new Pt(this.source,ve(this.path),this.snap)}}class Mt{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Tt.MERGE}operationForChild(e){if(ke(this.path)){const t=this.children.subtree(new fe(e));return t.isEmpty()?null:t.value?new Pt(this.source,ge(),t.value):new Mt(this.source,ge(),t)}return(0,a.vA)(me(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Mt(this.source,ve(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Ot{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ke(e))return this.isFullyInitialized()&&!this.filtered_;const t=me(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Nt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Dt(e,t,n,r,o,i){const s=r.filter(e=>e.type===n);s.sort((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw(0,a.Hk)("Should only compare child_ events.");const r=new Oe(t.childName,t.snapshotNode),o=new Oe(n.childName,n.snapshotNode);return e.index_.compare(r,o)}(e,t,n)),s.forEach(n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,i);o.forEach(o=>{o.respondsTo(n.type)&&t.push(o.createEvent(r,e.query_))})})}function Ft(e,t){return{eventCache:e,serverCache:t}}function qt(e,t,n,r){return Ft(new Ot(t,n,r),e.serverCache)}function Lt(e,t,n,r){return Ft(e.eventCache,new Ot(t,n,r))}function zt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ht(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Bt;class Wt{static fromObject(e){let t=new Wt(null);return F(e,(e,n)=>{t=t.set(new fe(e),n)}),t}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Bt||(Bt=new He(M)),Bt);this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:ge(),value:this.value};if(ke(e))return null;{const n=me(e),r=this.children.get(n);if(null!==r){const o=r.findRootMostMatchingPathAndValue(ve(e),t);if(null!=o){return{path:_e(new fe(n),o.path),value:o.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ke(e))return this;{const t=me(e),n=this.children.get(t);return null!==n?n.subtree(ve(e)):new Wt(null)}}set(e,t){if(ke(e))return new Wt(t,this.children);{const n=me(e),r=(this.children.get(n)||new Wt(null)).set(ve(e),t),o=this.children.insert(n,r);return new Wt(this.value,o)}}remove(e){if(ke(e))return this.children.isEmpty()?new Wt(null):new Wt(null,this.children);{const t=me(e),n=this.children.get(t);if(n){const r=n.remove(ve(e));let o;return o=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&o.isEmpty()?new Wt(null):new Wt(this.value,o)}return this}}get(e){if(ke(e))return this.value;{const t=me(e),n=this.children.get(t);return n?n.get(ve(e)):null}}setTree(e,t){if(ke(e))return t;{const n=me(e),r=(this.children.get(n)||new Wt(null)).setTree(ve(e),t);let o;return o=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Wt(this.value,o)}}fold(e){return this.fold_(ge(),e)}fold_(e,t){const n={};return this.children.inorderTraversal((r,o)=>{n[r]=o.fold_(_e(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,ge(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(ke(e))return null;{const r=me(e),o=this.children.get(r);return o?o.findOnPath_(ve(e),_e(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ge(),t)}foreachOnPath_(e,t,n){if(ke(e))return this;{this.value&&n(t,this.value);const r=me(e),o=this.children.get(r);return o?o.foreachOnPath_(ve(e),_e(t,r),n):new Wt(null)}}foreach(e){this.foreach_(ge(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(_e(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}class Ut{constructor(e){this.writeTree_=e}static empty(){return new Ut(new Wt(null))}}function Vt(e,t,n){if(ke(t))return new Ut(new Wt(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const o=r.path;let i=r.value;const a=Se(o,t);return i=i.updateChild(a,n),new Ut(e.writeTree_.set(o,i))}{const r=new Wt(n),o=e.writeTree_.setTree(t,r);return new Ut(o)}}}function Gt(e,t,n){let r=e;return F(n,(e,n)=>{r=Vt(r,_e(t,e),n)}),r}function Qt(e,t){if(ke(t))return Ut.empty();{const n=e.writeTree_.setTree(t,new Wt(null));return new Ut(n)}}function Kt(e,t){return null!=Yt(e,t)}function Yt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Se(n.path,t)):null}function $t(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ze,(e,n)=>{t.push(new Oe(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new Oe(e,n.value))}),t}function Zt(e,t){if(ke(t))return e;{const n=Yt(e,t);return new Ut(null!=n?new Wt(n):e.writeTree_.subtree(t))}}function Xt(e){return e.writeTree_.isEmpty()}function Jt(e,t){return en(ge(),e.writeTree_,t)}function en(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal((t,o)=>{".priority"===t?((0,a.vA)(null!==o.value,"Priority writes must always be leaf nodes"),r=o.value):n=en(_e(e,t),o,n)}),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(_e(e,".priority"),r)),n}}function tn(e,t){return gn(t,e)}function nn(e,t){const n=e.allWrites.findIndex(e=>e.writeId===t);(0,a.vA)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let o=r.visible,i=!1,s=e.allWrites.length-1;for(;o&&s>=0;){const t=e.allWrites[s];t.visible&&(s>=n&&rn(t,r.path)?o=!1:Ee(r.path,t.path)&&(i=!0)),s--}if(o){if(i)return function(e){e.visibleWrites=an(e.allWrites,on,ge()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=Qt(e.visibleWrites,r.path);else{F(r.children,t=>{e.visibleWrites=Qt(e.visibleWrites,_e(r.path,t))})}return!0}return!1}function rn(e,t){if(e.snap)return Ee(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Ee(_e(e.path,n),t))return!0;return!1}function on(e){return e.visible}function an(e,t,n){let r=Ut.empty();for(let o=0;o<e.length;++o){const i=e[o];if(t(i)){const e=i.path;let t;if(i.snap)Ee(n,e)?(t=Se(n,e),r=Vt(r,t,i.snap)):Ee(e,n)&&(t=Se(e,n),r=Vt(r,ge(),i.snap.getChild(t)));else{if(!i.children)throw(0,a.Hk)("WriteRecord should have .snap or .children");if(Ee(n,e))t=Se(n,e),r=Gt(r,t,i.children);else if(Ee(e,n))if(t=Se(e,n),ke(t))r=Gt(r,ge(),i.children);else{const e=(0,a.yw)(i.children,me(t));if(e){const n=e.getChild(ve(t));r=Vt(r,ge(),n)}}}}}return r}function sn(e,t,n,r,o){if(r||o){const i=Zt(e.visibleWrites,t);if(!o&&Xt(i))return n;if(o||null!=n||Kt(i,ge())){const i=function(e){return(e.visible||o)&&(!r||!~r.indexOf(e.writeId))&&(Ee(e.path,t)||Ee(t,e.path))};return Jt(an(e.allWrites,i,t),n||it.EMPTY_NODE)}return null}{const r=Yt(e.visibleWrites,t);if(null!=r)return r;{const r=Zt(e.visibleWrites,t);if(Xt(r))return n;if(null!=n||Kt(r,ge())){return Jt(r,n||it.EMPTY_NODE)}return null}}}function ln(e,t,n,r){return sn(e.writeTree,e.treePath,t,n,r)}function cn(e,t){return function(e,t,n){let r=it.EMPTY_NODE;const o=Yt(e.visibleWrites,t);if(o)return o.isLeafNode()||o.forEachChild(Ze,(e,t)=>{r=r.updateImmediateChild(e,t)}),r;if(n){const o=Zt(e.visibleWrites,t);return n.forEachChild(Ze,(e,t)=>{const n=Jt(Zt(o,new fe(e)),t);r=r.updateImmediateChild(e,n)}),$t(o).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}return $t(Zt(e.visibleWrites,t)).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}(e.writeTree,e.treePath,t)}function un(e,t,n,r){return function(e,t,n,r,o){(0,a.vA)(r||o,"Either existingEventSnap or existingServerSnap must exist");const i=_e(t,n);if(Kt(e.visibleWrites,i))return null;{const t=Zt(e.visibleWrites,i);return Xt(t)?o.getChild(n):Jt(t,o.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function dn(e,t){return function(e,t){return Yt(e.visibleWrites,t)}(e.writeTree,_e(e.treePath,t))}function hn(e,t,n,r,o,i){return function(e,t,n,r,o,i,a){let s;const l=Zt(e.visibleWrites,t),c=Yt(l,ge());if(null!=c)s=c;else{if(null==n)return[];s=Jt(l,n)}if(s=s.withIndex(a),s.isEmpty()||s.isLeafNode())return[];{const e=[],t=a.getCompare(),n=i?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a);let l=n.getNext();for(;l&&e.length<o;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,o,i)}function pn(e,t,n){return function(e,t,n,r){const o=_e(t,n),i=Yt(e.visibleWrites,o);if(null!=i)return i;if(r.isCompleteForChild(n))return Jt(Zt(e.visibleWrites,o),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function fn(e,t){return gn(_e(e.treePath,t),e.writeTree)}function gn(e,t){return{treePath:e,writeTree:t}}class mn{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;(0,a.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,a.vA)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const o=r.type;if("child_added"===t&&"child_removed"===o)this.changeMap.set(n,ft(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===o)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===o)this.changeMap.set(n,pt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===o)this.changeMap.set(n,ht(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==o)throw(0,a.Hk)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ft(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const yn=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class vn{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Ot(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return pn(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ht(this.viewCache_),o=hn(this.writes_,r,t,1,n,e);return 0===o.length?null:o[0]}}function bn(e,t,n,r,o){const i=new mn;let s,l;if(n.type===Tt.OVERWRITE){const c=n;c.source.fromUser?s=_n(e,t,c.path,c.snap,r,o,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered()&&!ke(c.path),s=wn(e,t,c.path,c.snap,r,o,l,i))}else if(n.type===Tt.MERGE){const c=n;c.source.fromUser?s=function(e,t,n,r,o,i,a){let s=t;return r.foreach((r,l)=>{const c=_e(n,r);kn(t,me(c))&&(s=_n(e,s,c,l,o,i,a))}),r.foreach((r,l)=>{const c=_e(n,r);kn(t,me(c))||(s=_n(e,s,c,l,o,i,a))}),s}(e,t,c.path,c.children,r,o,i):((0,a.vA)(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered(),s=Cn(e,t,c.path,c.children,r,o,l,i))}else if(n.type===Tt.ACK_USER_WRITE){const l=n;s=l.revert?function(e,t,n,r,o,i){let s;if(null!=dn(r,n))return t;{const l=new vn(r,t,o),c=t.eventCache.getNode();let u;if(ke(n)||".priority"===me(n)){let n;if(t.serverCache.isFullyInitialized())n=ln(r,Ht(t));else{const e=t.serverCache.getNode();(0,a.vA)(e instanceof it,"serverChildren would be complete if leaf node"),n=cn(r,e)}u=e.filter.updateFullNode(c,n,i)}else{const o=me(n);let a=pn(r,o,t.serverCache);null==a&&t.serverCache.isCompleteForChild(o)&&(a=c.getImmediateChild(o)),u=null!=a?e.filter.updateChild(c,o,a,ve(n),l,i):t.eventCache.getNode().hasChild(o)?e.filter.updateChild(c,o,it.EMPTY_NODE,ve(n),l,i):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(s=ln(r,Ht(t)),s.isLeafNode()&&(u=e.filter.updateFullNode(u,s,i)))}return s=t.serverCache.isFullyInitialized()||null!=dn(r,ge()),qt(t,u,s,e.filter.filtersNodes())}}(e,t,l.path,r,o,i):function(e,t,n,r,o,i,a){if(null!=dn(o,n))return t;const s=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(ke(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return wn(e,t,n,l.getNode().getChild(n),o,i,s,a);if(ke(n)){let r=new Wt(null);return l.getNode().forEachChild(qe,(e,t)=>{r=r.set(new fe(e),t)}),Cn(e,t,n,r,o,i,s,a)}return t}{let c=new Wt(null);return r.foreach((e,t)=>{const r=_e(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))}),Cn(e,t,n,c,o,i,s,a)}}(e,t,l.path,l.affectedTree,r,o,i)}else{if(n.type!==Tt.LISTEN_COMPLETE)throw(0,a.Hk)("Unknown operation type: "+n.type);s=function(e,t,n,r,o){const i=t.serverCache,a=Lt(t,i.getNode(),i.isFullyInitialized()||ke(n),i.isFiltered());return xn(e,a,n,r,yn,o)}(e,t,n.path,r,i)}const c=i.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const o=r.getNode().isLeafNode()||r.getNode().isEmpty(),i=zt(e);(n.length>0||!e.eventCache.isFullyInitialized()||o&&!r.getNode().equals(i)||!r.getNode().getPriority().equals(i.getPriority()))&&n.push(dt(zt(t)))}}(t,s,c),{viewCache:s,changes:c}}function xn(e,t,n,r,o,i){const s=t.eventCache;if(null!=dn(r,n))return t;{let l,c;if(ke(n))if((0,a.vA)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ht(t),o=cn(r,n instanceof it?n:it.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),o,i)}else{const n=ln(r,Ht(t));l=e.filter.updateFullNode(t.eventCache.getNode(),n,i)}else{const u=me(n);if(".priority"===u){(0,a.vA)(1===ye(n),"Can't have a priority with additional path components");const o=s.getNode();c=t.serverCache.getNode();const i=un(r,n,o,c);l=null!=i?e.filter.updatePriority(o,i):s.getNode()}else{const a=ve(n);let d;if(s.isCompleteForChild(u)){c=t.serverCache.getNode();const e=un(r,n,s.getNode(),c);d=null!=e?s.getNode().getImmediateChild(u).updateChild(a,e):s.getNode().getImmediateChild(u)}else d=pn(r,u,t.serverCache);l=null!=d?e.filter.updateChild(s.getNode(),u,d,a,o,i):s.getNode()}}return qt(t,l,s.isFullyInitialized()||ke(n),e.filter.filtersNodes())}}function wn(e,t,n,r,o,i,a,s){const l=t.serverCache;let c;const u=a?e.filter:e.filter.getIndexedFilter();if(ke(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=me(n);if(!l.isCompleteForPath(n)&&ye(n)>1)return t;const o=ve(n),i=l.getNode().getImmediateChild(e).updateChild(o,r);c=".priority"===e?u.updatePriority(l.getNode(),i):u.updateChild(l.getNode(),e,i,o,yn,null)}const d=Lt(t,c,l.isFullyInitialized()||ke(n),u.filtersNodes());return xn(e,d,n,o,new vn(o,d,i),s)}function _n(e,t,n,r,o,i,a){const s=t.eventCache;let l,c;const u=new vn(o,t,i);if(ke(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,a),l=qt(t,c,!0,e.filter.filtersNodes());else{const o=me(n);if(".priority"===o)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=qt(t,c,s.isFullyInitialized(),s.isFiltered());else{const i=ve(n),c=s.getNode().getImmediateChild(o);let d;if(ke(i))d=r;else{const e=u.getCompleteChild(o);d=null!=e?".priority"===be(i)&&e.getChild(we(i)).isEmpty()?e:e.updateChild(i,r):it.EMPTY_NODE}if(c.equals(d))l=t;else{l=qt(t,e.filter.updateChild(s.getNode(),o,d,i,u,a),s.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function kn(e,t){return e.eventCache.isCompleteForChild(t)}function Sn(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function Cn(e,t,n,r,o,i,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=ke(n)?r:new Wt(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal((n,r)=>{if(u.hasChild(n)){const l=Sn(0,t.serverCache.getNode().getImmediateChild(n),r);c=wn(e,c,new fe(n),l,o,i,a,s)}}),l.children.inorderTraversal((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=Sn(0,t.serverCache.getNode().getImmediateChild(n),r);c=wn(e,c,new fe(n),l,o,i,a,s)}}),c}class An{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new gt(n.getIndex()),o=(i=n).loadsAllData()?new gt(i.getIndex()):i.hasLimit()?new yt(i):new mt(i);var i;this.processor_=function(e){return{filter:e}}(o);const a=t.serverCache,s=t.eventCache,l=r.updateFullNode(it.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(it.EMPTY_NODE,s.getNode(),null),u=new Ot(l,a.isFullyInitialized(),r.filtersNodes()),d=new Ot(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ft(d,u),this.eventGenerator_=new Nt(this.query_)}get query(){return this.query_}}function En(e,t){const n=Ht(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!ke(t)&&!n.getImmediateChild(me(t)).isEmpty())?n.getChild(t):null}function Tn(e){return 0===e.eventRegistrations_.length}function Rn(e,t,n){const r=[];if(n){(0,a.vA)(null==t,"A cancel should cancel all event registrations.");const o=e.query._path;e.eventRegistrations_.forEach(e=>{const t=e.createCancelEvent(n,o);t&&r.push(t)})}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const o=e.eventRegistrations_[r];if(o.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(o)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function jn(e,t,n,r){t.type===Tt.MERGE&&null!==t.source.queryId&&((0,a.vA)(Ht(e.viewCache_),"We should always have a full cache before handling merges"),(0,a.vA)(zt(e.viewCache_),"Missing event cache, even though we have a server cache"));const o=e.viewCache_,i=bn(e.processor_,o,t,n,r);var s,l;return s=e.processor_,l=i.viewCache,(0,a.vA)(l.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),(0,a.vA)(l.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed"),(0,a.vA)(i.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=i.viewCache,In(e,i.changes,i.viewCache.eventCache.getNode(),null)}function In(e,t,n,r){const o=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const o=[],i=[];return t.forEach(t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&i.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}),Dt(e,o,"child_removed",t,r,n),Dt(e,o,"child_added",t,r,n),Dt(e,o,"child_moved",i,r,n),Dt(e,o,"child_changed",t,r,n),Dt(e,o,"value",t,r,n),o}(e.eventGenerator_,t,n,o)}let Pn,Mn;class On{constructor(){this.views=new Map}}function Nn(e,t,n,r){const o=t.source.queryId;if(null!==o){const i=e.views.get(o);return(0,a.vA)(null!=i,"SyncTree gave us an op for an invalid query."),jn(i,t,n,r)}{let o=[];for(const i of e.views.values())o=o.concat(jn(i,t,n,r));return o}}function Dn(e,t,n,r,o){const i=t._queryIdentifier,a=e.views.get(i);if(!a){let e=ln(n,o?r:null),i=!1;e?i=!0:r instanceof it?(e=cn(n,r),i=!1):(e=it.EMPTY_NODE,i=!1);const a=Ft(new Ot(e,i,!1),new Ot(r,o,!1));return new An(t,a)}return a}function Fn(e,t,n,r,o,i){const a=Dn(e,t,r,o,i);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(Ze,(e,t)=>{r.push(ht(e,t))});return n.isFullyInitialized()&&r.push(dt(n.getNode())),In(e,r,n.getNode(),t)}(a,n)}function qn(e,t,n,r){const o=t._queryIdentifier,i=[];let s=[];const l=Wn(e);if("default"===o)for(const[a,c]of e.views.entries())s=s.concat(Rn(c,n,r)),Tn(c)&&(e.views.delete(a),c.query._queryParams.loadsAllData()||i.push(c.query));else{const t=e.views.get(o);t&&(s=s.concat(Rn(t,n,r)),Tn(t)&&(e.views.delete(o),t.query._queryParams.loadsAllData()||i.push(t.query)))}return l&&!Wn(e)&&i.push(new((0,a.vA)(Pn,"Reference.ts has not been loaded"),Pn)(t._repo,t._path)),{removed:i,events:s}}function Ln(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function zn(e,t){let n=null;for(const r of e.views.values())n=n||En(r,t);return n}function Hn(e,t){if(t._queryParams.loadsAllData())return Un(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Bn(e,t){return null!=Hn(e,t)}function Wn(e){return null!=Un(e)}function Un(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let Vn=1;class Gn{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Wt(null),this.pendingWriteTree_={visibleWrites:Ut.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Qn(e,t,n,r,o){return function(e,t,n,r,o){(0,a.vA)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:o}),o&&(e.visibleWrites=Vt(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,o),o?nr(e,new Pt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Kn(e,t,n,r){!function(e,t,n,r){(0,a.vA)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Gt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const o=Wt.fromObject(n);return nr(e,new Mt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,o))}function Yn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(nn(e.pendingWriteTree_,t)){let t=new Wt(null);return null!=r.snap?t=t.set(ge(),!0):F(r.children,e=>{t=t.set(new fe(e),!0)}),nr(e,new jt(r.path,t,n))}return[]}function $n(e,t,n){return nr(e,new Pt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function Zn(e,t,n,r){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=t._path,a=e.syncPointTree_.get(i);let s=[];if(a&&("default"===t._queryIdentifier||Bn(a,t))){const l=qn(a,t,n,r);0===a.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));const c=l.removed;if(s=l.events,!o){const n=-1!==c.findIndex(e=>e._queryParams.loadsAllData()),o=e.syncPointTree_.findOnPath(i,(e,t)=>Wn(t));if(n&&!o){const t=e.syncPointTree_.subtree(i);if(!t.isEmpty()){const n=function(e){return e.fold((e,t,n)=>{if(t&&Wn(t)){return[Un(t)]}{let e=[];return t&&(e=Ln(t)),F(n,(t,n)=>{e=e.concat(n)}),e}})}(t);for(let t=0;t<n.length;++t){const r=n[t],o=r.query,i=ir(e,r);e.listenProvider_.startListening(dr(o),ar(e,o),i.hashFn,i.onComplete)}}}if(!o&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(dr(t),n)}else c.forEach(t=>{const n=e.queryToTagMap.get(sr(t));e.listenProvider_.stopListening(dr(t),n)})}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=sr(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return s}function Xn(e,t,n,r){const o=lr(e,r);if(null!=o){const r=cr(o),i=r.path,a=r.queryId,s=Se(i,t);return ur(e,i,new Pt(Rt(a),s,n))}return[]}function Jn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const o=t._path;let i=null,s=!1;e.syncPointTree_.foreachOnPath(o,(e,t)=>{const n=Se(e,o);i=i||zn(t,n),s=s||Wn(t)});let l,c=e.syncPointTree_.get(o);if(c?(s=s||Wn(c),i=i||zn(c,ge())):(c=new On,e.syncPointTree_=e.syncPointTree_.set(o,c)),null!=i)l=!0;else{l=!1,i=it.EMPTY_NODE;e.syncPointTree_.subtree(o).foreachChild((e,t)=>{const n=zn(t,ge());n&&(i=i.updateImmediateChild(e,n))})}const u=Bn(c,t);if(!u&&!t._queryParams.loadsAllData()){const n=sr(t);(0,a.vA)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=Vn++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let d=Fn(c,t,n,tn(e.pendingWriteTree_,o),i,l);if(!u&&!s&&!r){const n=Hn(c,t);d=d.concat(function(e,t,n){const r=t._path,o=ar(e,t),i=ir(e,n),s=e.listenProvider_.startListening(dr(t),o,i.hashFn,i.onComplete),l=e.syncPointTree_.subtree(r);if(o)(0,a.vA)(!Wn(l.value),"If we're adding a query, it shouldn't be shadowed");else{const t=l.fold((e,t,n)=>{if(!ke(e)&&t&&Wn(t))return[Un(t).query];{let e=[];return t&&(e=e.concat(Ln(t).map(e=>e.query))),F(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(dr(r),ar(e,r))}}return s}(e,t,n))}return d}function er(e,t,n){const r=e.pendingWriteTree_,o=e.syncPointTree_.findOnPath(t,(e,n)=>{const r=zn(n,Se(e,t));if(r)return r});return sn(r,t,o,n,!0)}function tr(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,(e,t)=>{const o=Se(e,n);r=r||zn(t,o)});let o=e.syncPointTree_.get(n);o?r=r||zn(o,ge()):(o=new On,e.syncPointTree_=e.syncPointTree_.set(n,o));const i=null!=r,a=i?new Ot(r,!0,!1):null;return function(e){return zt(e.viewCache_)}(Dn(o,t,tn(e.pendingWriteTree_,t._path),i?a.getNode():it.EMPTY_NODE,i))}function nr(e,t){return rr(t,e.syncPointTree_,null,tn(e.pendingWriteTree_,ge()))}function rr(e,t,n,r){if(ke(e.path))return or(e,t,n,r);{const o=t.get(ge());null==n&&null!=o&&(n=zn(o,ge()));let i=[];const a=me(e.path),s=e.operationForChild(a),l=t.children.get(a);if(l&&s){const e=n?n.getImmediateChild(a):null,t=fn(r,a);i=i.concat(rr(s,l,e,t))}return o&&(i=i.concat(Nn(o,e,r,n))),i}}function or(e,t,n,r){const o=t.get(ge());null==n&&null!=o&&(n=zn(o,ge()));let i=[];return t.children.inorderTraversal((t,o)=>{const a=n?n.getImmediateChild(t):null,s=fn(r,t),l=e.operationForChild(t);l&&(i=i.concat(or(l,o,a,s)))}),o&&(i=i.concat(Nn(o,e,r,n))),i}function ir(e,t){const n=t.query,r=ar(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||it.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=lr(e,n);if(r){const n=cr(r),o=n.path,i=n.queryId,a=Se(o,t);return ur(e,o,new It(Rt(i),a))}return[]}(e,n._path,r):function(e,t){return nr(e,new It({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return Zn(e,n,null,r)}}}}function ar(e,t){const n=sr(t);return e.queryToTagMap.get(n)}function sr(e){return e._path.toString()+"$"+e._queryIdentifier}function lr(e,t){return e.tagToQueryMap.get(t)}function cr(e){const t=e.indexOf("$");return(0,a.vA)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new fe(e.substr(0,t))}}function ur(e,t,n){const r=e.syncPointTree_.get(t);(0,a.vA)(r,"Missing sync point for query tag that we're tracking");return Nn(r,n,tn(e.pendingWriteTree_,t),null)}function dr(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,a.vA)(Mn,"Reference.ts has not been loaded"),Mn)(e._repo,e._path):e}class hr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new hr(t)}node(){return this.node_}}class pr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=_e(this.path_,e);return new pr(this.syncTree_,t)}node(){return er(this.syncTree_,this.path_)}}const fr=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},gr=function(e,t,n){return e&&"object"===typeof e?((0,a.vA)(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?mr(e[".sv"],t,n):"object"===typeof e[".sv"]?yr(e[".sv"],t):void(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},mr=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,a.vA)(!1,"Unexpected server value: "+e)},yr=function(e,t,n){e.hasOwnProperty("increment")||(0,a.vA)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&(0,a.vA)(!1,"Unexpected increment value: "+r);const o=t.node();if((0,a.vA)(null!==o&&"undefined"!==typeof o,"Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;const i=o.getValue();return"number"!==typeof i?r:i+r},vr=function(e,t,n,r){return xr(t,new pr(n,e),r)},br=function(e,t,n){return xr(e,new hr(t),n)};function xr(e,t,n){const r=e.getPriority().val(),o=gr(r,t.getImmediateChild(".priority"),n);let i;if(e.isLeafNode()){const r=e,i=gr(r.getValue(),t,n);return i!==r.getValue()||o!==r.getPriority().val()?new $e(i,lt(o)):e}{const r=e;return i=r,o!==r.getPriority().val()&&(i=i.updatePriority(new $e(o))),r.forEachChild(Ze,(e,r)=>{const o=xr(r,t.getImmediateChild(e),n);o!==r&&(i=i.updateImmediateChild(e,o))}),i}}class wr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function _r(e,t){let n=t instanceof fe?t:new fe(t),r=e,o=me(n);for(;null!==o;){const e=(0,a.yw)(r.node.children,o)||{children:{},childCount:0};r=new wr(o,r,e),n=ve(n),o=me(n)}return r}function kr(e){return e.node.value}function Sr(e,t){e.node.value=t,Rr(e)}function Cr(e){return e.node.childCount>0}function Ar(e,t){F(e.node.children,(n,r)=>{t(new wr(n,e,r))})}function Er(e,t,n,r){n&&!r&&t(e),Ar(e,e=>{Er(e,t,!0,r)}),n&&r&&t(e)}function Tr(e){return new fe(null===e.parent?e.name:Tr(e.parent)+"/"+e.name)}function Rr(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===kr(e)&&!Cr(e)}(n),o=(0,a.gR)(e.node.children,t);r&&o?(delete e.node.children[t],e.node.childCount--,Rr(e)):r||o||(e.node.children[t]=n.node,e.node.childCount++,Rr(e))}(e.parent,e.name,e)}const jr=/[\[\].#$\/\u0000-\u001F\u007F]/,Ir=/[\[\].#$\u0000-\u001F\u007F]/,Pr=10485760,Mr=function(e){return"string"===typeof e&&0!==e.length&&!jr.test(e)},Or=function(e){return"string"===typeof e&&0!==e.length&&!Ir.test(e)},Nr=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!R(e)||e&&"object"===typeof e&&(0,a.gR)(e,".sv")},Dr=function(e,t,n,r){r&&void 0===t||Fr((0,a.dI)(e,"value"),t,n)},Fr=function(e,t,n){const r=n instanceof fe?new Te(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+je(r));if("function"===typeof t)throw new Error(e+"contains a function "+je(r)+" with contents = "+t.toString());if(R(t))throw new Error(e+"contains "+t.toString()+" "+je(r));if("string"===typeof t&&t.length>Pr/3&&(0,a.OE)(t)>Pr)throw new Error(e+"contains a string greater than "+Pr+" utf8 bytes "+je(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,o=!1;if(F(t,(t,i)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!Mr(t)))throw new Error(e+" contains an invalid key ("+t+") "+je(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=(0,a.OE)(t),Re(e)}(r,t),Fr(e,i,r),function(e){const t=e.parts_.pop();e.byteLength_-=(0,a.OE)(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)}),n&&o)throw new Error(e+' contains ".value" child '+je(r)+" in addition to actual children.")}},qr=function(e,t,n,r){if(r&&void 0===t)return;const o=(0,a.dI)(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(o+" must be an object containing the children to replace.");const i=[];F(t,(e,t)=>{const r=new fe(e);if(Fr(o,t,_e(n,r)),".priority"===be(r)&&!Nr(t))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(r)}),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const o=xe(r);for(let t=0;t<o.length;t++)if(".priority"===o[t]&&t===o.length-1);else if(!Mr(o[t]))throw new Error(e+"contains an invalid key ("+o[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Ce);let o=null;for(n=0;n<t.length;n++){if(r=t[n],null!==o&&Ee(o,r))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+r.toString());o=r}}(o,i)},Lr=function(e,t,n,r){if((!r||void 0!==n)&&!Or(n))throw new Error((0,a.dI)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},zr=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Lr(e,t,n,r)},Hr=function(e,t){if(".info"===me(t))throw new Error(e+" failed = Can't modify data under /.info/")},Br=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!Mr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Or(e)}(n))throw new Error((0,a.dI)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Wr{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ur(e,t){let n=null;for(let r=0;r<t.length;r++){const o=t[r],i=o.getPath();null===n||Ae(i,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:i}),n.events.push(o)}n&&e.eventLists_.push(n)}function Vr(e,t,n){Ur(e,n),Qr(e,e=>Ae(e,t))}function Gr(e,t,n){Ur(e,n),Qr(e,e=>Ee(e,t)||Ee(t,e))}function Qr(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const o=e.eventLists_[r];if(o){t(o.path)?(Kr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Kr(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();w&&S("event: "+n.toString()),H(r)}}}const Yr="repo_interrupt",$r=25;class Zr{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Wr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=kt(),this.transactionQueueTree_=new wr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Xr(e,t,n){if(e.stats_=ne(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new wt(e.repoInfo_,(t,n,r,o)=>{to(e,t,n,r,o)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>no(e,!0),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,a.As)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new Me(e.repoInfo_,t,(t,n,r,o)=>{to(e,t,n,r,o)},t=>{no(e,t)},t=>{!function(e,t){F(t,(t,n)=>{ro(e,t,n)})}(e,t)},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){const n=e.toString();return te[n]||(te[n]=t()),te[n]}(e.repoInfo_,()=>new Et(e.stats_,e.server_)),e.infoData_=new _t,e.infoSyncTree_=new Gn({startListening:(t,n,r,o)=>{let i=[];const a=e.infoData_.getNode(t._path);return a.isEmpty()||(i=$n(e.infoSyncTree_,t._path,a),setTimeout(()=>{o("ok")},0)),i},stopListening:()=>{}}),ro(e,"connected",!1),e.serverSyncTree_=new Gn({startListening:(t,n,r,o)=>(e.server_.listen(t,r,n,(n,r)=>{const i=o(n,r);Gr(e.eventQueue_,t._path,i)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function Jr(e){const t=e.infoData_.getNode(new fe(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function eo(e){return fr({timestamp:Jr(e)})}function to(e,t,n,r,o){e.dataUpdateCount++;const i=new fe(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(o)if(r){const t=(0,a.kH)(n,e=>lt(e));s=function(e,t,n,r){const o=lr(e,r);if(o){const r=cr(o),i=r.path,a=r.queryId,s=Se(i,t),l=Wt.fromObject(n);return ur(e,i,new Mt(Rt(a),s,l))}return[]}(e.serverSyncTree_,i,t,o)}else{const t=lt(n);s=Xn(e.serverSyncTree_,i,t,o)}else if(r){const t=(0,a.kH)(n,e=>lt(e));s=function(e,t,n){const r=Wt.fromObject(n);return nr(e,new Mt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,i,t)}else{const t=lt(n);s=$n(e.serverSyncTree_,i,t)}let l=i;s.length>0&&(l=po(e,i)),Gr(e.eventQueue_,l,s)}function no(e,t){ro(e,"connected",t),!1===t&&function(e){lo(e,"onDisconnectEvents");const t=eo(e),n=kt();Ct(e.onDisconnect_,ge(),(r,o)=>{const i=vr(r,o,e.serverSyncTree_,t);St(n,r,i)});let r=[];Ct(n,ge(),(t,n)=>{r=r.concat($n(e.serverSyncTree_,t,n));const o=vo(e,t);po(e,o)}),e.onDisconnect_=kt(),Gr(e.eventQueue_,ge(),r)}(e)}function ro(e,t,n){const r=new fe("/.info/"+t),o=lt(n);e.infoData_.updateSnapshot(r,o);const i=$n(e.infoSyncTree_,r,o);Gr(e.eventQueue_,r,i)}function oo(e){return e.nextWriteId_++}function io(e,t,n,r,o){lo(e,"set",{path:t.toString(),value:n,priority:r});const i=eo(e),a=lt(n,r),s=er(e.serverSyncTree_,t),l=br(a,s,i),c=oo(e),u=Qn(e.serverSyncTree_,t,l,c,!0);Ur(e.eventQueue_,u),e.server_.put(t.toString(),a.val(!0),(n,r)=>{const i="ok"===n;i||T("set at "+t+" failed: "+n);const a=Yn(e.serverSyncTree_,c,!i);Gr(e.eventQueue_,t,a),co(e,o,n,r)});const d=vo(e,t);po(e,d),Gr(e.eventQueue_,d,[])}function ao(e,t,n){let r;r=".info"===me(t._path)?Zn(e.infoSyncTree_,t,n):Zn(e.serverSyncTree_,t,n),Vr(e.eventQueue_,t._path,r)}function so(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Yr)}function lo(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];S(t,...r)}function co(e,t,n,r){t&&H(()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let o=e;r&&(o+=": "+r);const i=new Error(o);i.code=e,t(i)}})}function uo(e,t,n){return er(e.serverSyncTree_,t,n)||it.EMPTY_NODE}function ho(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||yo(e,t),kr(t)){const n=go(e,t);(0,a.vA)(n.length>0,"Sending zero length transaction queue");n.every(e=>0===e.status)&&function(e,t,n){const r=n.map(e=>e.currentWriteId),o=uo(e,t,r);let i=o;const s=o.hash();for(let u=0;u<n.length;u++){const e=n[u];(0,a.vA)(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=Se(t,e.path);i=i.updateChild(r,e.currentOutputSnapshotRaw)}const l=i.val(!0),c=t;e.server_.put(c.toString(),l,r=>{lo(e,"transaction put response",{path:c.toString(),status:r});let o=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,o=o.concat(Yn(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();yo(e,_r(e.transactionQueueTree_,t)),ho(e,e.transactionQueueTree_),Gr(e.eventQueue_,t,o);for(let e=0;e<r.length;e++)H(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{T("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}po(e,t)}},s)}(e,Tr(t),n)}else Cr(t)&&Ar(t,t=>{ho(e,t)})}function po(e,t){const n=fo(e,t),r=Tr(n);return function(e,t,n){if(0===t.length)return;const r=[];let o=[];const i=t.filter(e=>0===e.status),s=i.map(e=>e.currentWriteId);for(let l=0;l<t.length;l++){const i=t[l],c=Se(n,i.path);let u,d=!1;if((0,a.vA)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===i.status)d=!0,u=i.abortReason,o=o.concat(Yn(e.serverSyncTree_,i.currentWriteId,!0));else if(0===i.status)if(i.retryCount>=$r)d=!0,u="maxretry",o=o.concat(Yn(e.serverSyncTree_,i.currentWriteId,!0));else{const n=uo(e,i.path,s);i.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){Fr("transaction failed: Data returned ",r,i.path);let t=lt(r);"object"===typeof r&&null!=r&&(0,a.gR)(r,".priority")||(t=t.updatePriority(n.getPriority()));const l=i.currentWriteId,c=eo(e),u=br(t,n,c);i.currentOutputSnapshotRaw=t,i.currentOutputSnapshotResolved=u,i.currentWriteId=oo(e),s.splice(s.indexOf(l),1),o=o.concat(Qn(e.serverSyncTree_,i.path,u,i.currentWriteId,i.applyLocally)),o=o.concat(Yn(e.serverSyncTree_,l,!0))}else d=!0,u="nodata",o=o.concat(Yn(e.serverSyncTree_,i.currentWriteId,!0))}Gr(e.eventQueue_,n,o),o=[],d&&(t[l].status=2,function(e){setTimeout(e,Math.floor(0))}(t[l].unwatcher),t[l].onComplete&&("nodata"===u?r.push(()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot)):r.push(()=>t[l].onComplete(new Error(u),!1,null))))}yo(e,e.transactionQueueTree_);for(let a=0;a<r.length;a++)H(r[a]);ho(e,e.transactionQueueTree_)}(e,go(e,n),r),r}function fo(e,t){let n,r=e.transactionQueueTree_;for(n=me(t);null!==n&&void 0===kr(r);)r=_r(r,n),n=me(t=ve(t));return r}function go(e,t){const n=[];return mo(e,t,n),n.sort((e,t)=>e.order-t.order),n}function mo(e,t,n){const r=kr(t);if(r)for(let o=0;o<r.length;o++)n.push(r[o]);Ar(t,t=>{mo(e,t,n)})}function yo(e,t){const n=kr(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Sr(t,n.length>0?n:void 0)}Ar(t,t=>{yo(e,t)})}function vo(e,t){const n=Tr(fo(e,t)),r=_r(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,t=>{bo(e,t)}),bo(e,r),Er(r,t=>{bo(e,t)}),n}function bo(e,t){const n=kr(t);if(n){const r=[];let o=[],i=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,a.vA)(i===t-1,"All SENT items should be at beginning of queue."),i=t,n[t].status=3,n[t].abortReason="set"):((0,a.vA)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),o=o.concat(Yn(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===i?Sr(t,void 0):n.length=i+1,Gr(e.eventQueue_,Tr(t),o);for(let e=0;e<r.length;e++)H(r[e])}}const xo=function(e,t){const n=wo(e),r=n.namespace;"firebase.com"===n.domain&&E(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||E("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&T("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const o="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Z(n.host,n.secure,r,o,t,"",r!==n.subdomain),path:new fe(n.pathString)}},wo=function(e){let t="",n="",r="",o="",i="",a=!0,s="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(s=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let d=e.indexOf("?");-1===d&&(d=e.length),t=e.substring(0,Math.min(u,d)),u<d&&(o=function(e){let t="";const n=e.split("/");for(let o=0;o<n.length;o++)if(n[o].length>0){let e=n[o];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(r){}t+="/"+e}return t}(e.substring(u,d)));const h=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):T("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,d)));c=t.indexOf(":"),c>=0?(a="https"===s||"wss"===s,l=parseInt(t.substring(c+1),10)):c=t.length;const p=t.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),i=r}"ns"in h&&(i=h.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:a,scheme:s,pathString:o,namespace:i}},_o="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class ko{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,a.As)(this.snapshot.exportVal())}}class So{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Co{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,a.vA)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ao{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return ke(this._path)?null:be(this._path)}get ref(){return new Eo(this._repo,this._path)}get _queryIdentifier(){const e=xt(this._queryParams),t=N(e);return"{}"===t?"default":t}get _queryObject(){return xt(this._queryParams)}isEqual(e){if(!((e=(0,a.Ku)(e))instanceof Ao))return!1;const t=this._repo===e._repo,n=Ae(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Eo extends Ao{constructor(e,t){super(e,t,new vt,!1)}get parent(){const e=we(this._path);return null===e?null:new Eo(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class To{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new fe(e),n=jo(this.ref,e);return new To(this._node.getChild(t),n,Ze)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,(t,n)=>e(new To(n,jo(this.ref,t),Ze)))}hasChild(e){const t=new fe(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Ro(e,t){return(e=(0,a.Ku)(e))._checkNotDeleted("ref"),void 0!==t?jo(e._root,t):e._root}function jo(e,t){return null===me((e=(0,a.Ku)(e))._path)?zr("child","path",t,!1):Lr("child","path",t,!1),new Eo(e._repo,_e(e._path,t))}function Io(e){return Hr("remove",e._path),Po(e,null)}function Po(e,t){e=(0,a.Ku)(e),Hr("set",e._path),Dr("set",t,e._path,!1);const n=new a.cY;return io(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}function Mo(e,t){qr("update",t,e._path,!1);const n=new a.cY;return function(e,t,n,r){lo(e,"update",{path:t.toString(),value:n});let o=!0;const i=eo(e),a={};if(F(n,(n,r)=>{o=!1,a[n]=vr(_e(t,n),lt(r),e.serverSyncTree_,i)}),o)S("update() called with empty data.  Don't do anything."),co(0,r,"ok",void 0);else{const o=oo(e),i=Kn(e.serverSyncTree_,t,a,o);Ur(e.eventQueue_,i),e.server_.merge(t.toString(),n,(n,i)=>{const a="ok"===n;a||T("update at "+t+" failed: "+n);const s=Yn(e.serverSyncTree_,o,!a),l=s.length>0?po(e,t):t;Gr(e.eventQueue_,l,s),co(0,r,n,i)}),F(n,n=>{const r=vo(e,_e(t,n));po(e,r)}),Gr(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}function Oo(e){e=(0,a.Ku)(e);const t=new Co(()=>{}),n=new No(t);return function(e,t,n){const r=tr(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then(r=>{const o=lt(r).withIndex(t._queryParams.getIndex());let i;if(Jn(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())i=$n(e.serverSyncTree_,t._path,o);else{const n=ar(e.serverSyncTree_,t);i=Xn(e.serverSyncTree_,t._path,o,n)}return Gr(e.eventQueue_,t._path,i),Zn(e.serverSyncTree_,t,n,null,!0),o},n=>(lo(e,"get for query "+(0,a.As)(t)+" failed: "+n),Promise.reject(new Error(n))))}(e._repo,e,n).then(t=>new To(t,new Eo(e._repo,e._path),e._queryParams.getIndex()))}class No{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new ko("value",this,new To(e.snapshotNode,new Eo(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new So(this,e,t):null}matches(e){return e instanceof No&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Do{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new So(this,e,t):null}createEvent(e,t){(0,a.vA)(null!=e.childName,"Child events should have a childName.");const n=jo(new Eo(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new ko(e.type,this,new To(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Do&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}function Fo(e,t,n,r,o){let i;if("object"===typeof r&&(i=void 0,o=r),"function"===typeof r&&(i=r),o&&o.onlyOnce){const t=n,r=(n,r)=>{ao(e._repo,e,s),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const a=new Co(n,i||void 0),s="value"===t?new No(a):new Do(t,a);return function(e,t,n){let r;r=".info"===me(t._path)?Jn(e.infoSyncTree_,t,n):Jn(e.serverSyncTree_,t,n),Vr(e.eventQueue_,t._path,r)}(e._repo,e,s),()=>ao(e._repo,e,s)}function qo(e,t,n,r){return Fo(e,"value",t,n,r)}!function(e){(0,a.vA)(!Pn,"__referenceConstructor has already been defined"),Pn=e}(Eo),function(e){(0,a.vA)(!Mn,"__referenceConstructor has already been defined"),Mn=e}(Eo);const Lo={};let zo=!1;function Ho(e,t,n,r,o){let i=r||e.options.databaseURL;void 0===i&&(e.options.projectId||E("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),S("Using default host for project ",e.options.projectId),i="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let a,s,l=xo(i,o),c=l.repoInfo;"undefined"!==typeof process&&(s={NODE_ENV:"production",PUBLIC_URL:"/Battle-Ants",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FIREBASE_DATABASE_EMULATOR_HOST),s?(a=!0,i="http://".concat(s,"?ns=").concat(c.namespace),l=xo(i,o),c=l.repoInfo):a=!l.repoInfo.secure;const u=o&&a?new V(V.OWNER):new U(e.name,e.options,t);Br("Invalid Firebase Database URL",l),ke(l.path)||E("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(e,t,n,r){let o=Lo[t.name];o||(o={},Lo[t.name]=o);let i=o[e.toURLString()];i&&E("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return i=new Zr(e,zo,n,r),o[e.toURLString()]=i,i}(c,e,u,new W(e,n));return new Bo(d,e)}class Bo{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Xr(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Eo(this._repo,ge())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=Lo[t];n&&n[e.key]===e||E("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),so(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&E("Cannot call "+e+" on a deleted database.")}}function Wo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,o.Sx)(),t=arguments.length>1?arguments[1]:void 0;const n=(0,o.j6)(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(0,a.yU)("database");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=(0,a.Ku)(e),e._checkNotDeleted("useEmulator");const o="".concat(t,":").concat(n),i=e._repoInternal;if(e._instanceStarted){if(o===e._repoInternal.repoInfo_.host&&(0,a.bD)(r,i.repoInfo_.emulatorOptions))return;E("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&E('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new V(V.OWNER);else if(r.mockUserToken){const t="string"===typeof r.mockUserToken?r.mockUserToken:(0,a.Fy)(r.mockUserToken,e.app.options.projectId);s=new V(t)}(0,a.zJ)(t)&&((0,a.gE)(t),(0,a.P1)("Database",!0));!function(e,t,n,r){const o=t.lastIndexOf(":"),i=t.substring(0,o),s=(0,a.zJ)(i);e.repoInfo_=new Z(t,s,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0,n),r&&(e.authTokenProvider_=r)}(i,o,r,s)}(n,...e)}return n}Me.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Me.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Uo;d(o.MF),(0,o.om)(new i.uA("database",(e,t)=>{let{instanceIdentifier:n}=t;return Ho(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)},"PUBLIC").setMultipleInstances(!0)),(0,o.KO)(l,c,Uo),(0,o.KO)(l,c,"esm2020")},853:(e,t,n)=>{e.exports=n(896)},867:(e,t,n)=>{n.r(t),n.d(t,{attackAnthill:()=>d,attackEgg:()=>u,bombardierSplashAttack:()=>v,calculateDamage:()=>p,canAttack:()=>g,checkWinCondition:()=>c,createDeadAnt:()=>s,detonateBomber:()=>h,getValidTargets:()=>m,moveAnt:()=>y,resolveAmbush:()=>b,resolveCombat:()=>f});var r=n(555),o=n(352),i=n(624),a=n(451);function s(e){return{id:"dead_".concat(e.id,"_").concat(Date.now()),position:e.position,owner:e.owner,createdAt:Date.now()}}function l(e,t,n){if(t===n)return!0;const r=e.players[t],o=e.players[n];return!(null===r||void 0===r||!r.team||null===o||void 0===o||!o.team)&&r.team===o.team}function c(e,t,n){const r=e.playerCount||2,o=Object.values(e.ants).filter(e=>"queen"===e.type&&!e.isDead&&e.owner!==n);if(2===r)return{gameOver:!0,winner:t,winningTeam:null};const i=e.players?Object.keys(e.players).filter(t=>{var n;return"A"===(null===(n=e.players[t])||void 0===n?void 0:n.team)}):[],a=e.players?Object.keys(e.players).filter(t=>{var n;return"B"===(null===(n=e.players[t])||void 0===n?void 0:n.team)}):[];if(i.length>0&&a.length>0){const e=o.filter(e=>i.includes(e.owner)).length,n=o.filter(e=>a.includes(e.owner)).length;return 0===e&&n>0?{gameOver:!0,winner:t,winningTeam:"B"}:0===n&&e>0?{gameOver:!0,winner:t,winningTeam:"A"}:{gameOver:!1,winner:null,winningTeam:null}}const s=new Set(o.map(e=>e.owner));if(1===s.size){return{gameOver:!0,winner:[...s][0],winningTeam:null}}return{gameOver:!1,winner:null,winningTeam:null}}function u(e,t,i){const s=e.ants[t],c=e.eggs[i];if(!s||!c)return{gameState:e,damageDealt:[],attackAnimation:null};if(s.owner===c.owner||l(e,s.owner,c.owner))return{gameState:e,damageDealt:[],attackAnimation:null};const u=(0,o.s1)(s.type),d=e.players[s.owner],h=(0,a.getAntAttack)(s,d),p=s.health/s.maxHealth,f=Math.min(1,p+.05),g=Math.floor(h*f),m=[{damage:g,position:c.position}],y=c.health-g,{updateHeroPower:v}=n(451);let b=v(e,s.owner,g);const x=(0,r.A)({},b.eggs);y<=0?delete x[i]:x[i]=(0,r.A)((0,r.A)({},c),{},{health:y});const w={attackerId:t,targetPosition:c.position,isRanged:u.attackRange>1};return{gameState:(0,r.A)((0,r.A)({},b),{},{eggs:x}),damageDealt:m,attackAnimation:w}}function d(e,t,i){const s=e.ants[t],c=e.anthills[i];if(!s||!c)return{gameState:e,damageDealt:[],attackAnimation:null};if(s.owner===c.owner||l(e,s.owner,c.owner))return{gameState:e,damageDealt:[],attackAnimation:null};const u=(0,o.s1)(s.type),d=e.players[s.owner],h=(0,a.getAntAttack)(s,d),p=s.health/s.maxHealth,f=Math.min(1,p+.05),g=Math.floor(h*f),m=[{damage:g,position:c.position}],y=c.health-g,{updateHeroPower:v}=n(451);let b=v(e,s.owner,g);const x=(0,r.A)({},b.anthills);y<=0?delete x[i]:x[i]=(0,r.A)((0,r.A)({},c),{},{health:y});const w={attackerId:t,targetPosition:c.position,isRanged:u.attackRange>1};return{gameState:(0,r.A)((0,r.A)({},b),{},{anthills:x}),damageDealt:m,attackAnimation:w}}function h(e,t){const a=e.ants[t];if(!a||"bomber"!==a.type)return e;const l=o.xr.BOMBER,u=(0,r.A)({},e.ants);let d=(0,r.A)((0,r.A)({},e),{},{ants:u});const p=(0,i.getNeighbors)(a.position),f=Object.values(u).filter(e=>e.id!==t&&p.some(t=>t.equals(e.position))),g=[],{updateHeroPower:m}=n(451);d.stats||(d.stats={player1:{},player2:{}}),f.forEach(e=>{const t=(0,o.s1)(e.type).defense,n=Math.max(1,l.attack-Math.floor(t)),i=e.health-n;if(g.push({damage:n,position:e.position}),d=m(d,a.owner,n),d=m(d,e.owner,n,.65),d.stats[a.owner].damageDealt=(d.stats[a.owner].damageDealt||0)+n,d.stats[e.owner].damageReceived=(d.stats[e.owner].damageReceived||0)+n,i<=0){const t=s(e);if(d.deadAnts=(0,r.A)((0,r.A)({},d.deadAnts),{},{[t.id]:t}),delete u[e.id],d.stats[a.owner].antsKilled=(d.stats[a.owner].antsKilled||0)+1,d.stats[e.owner].antsLost=(d.stats[e.owner].antsLost||0)+1,"queen"===e.type){d.ants=u;const t=c(d,a.owner,e.owner);d.gameOver=t.gameOver,d.winner=t.winner,d.winningTeam=t.winningTeam}"bomber"===e.type&&(d=h(d,e.id))}else u[e.id]=(0,r.A)((0,r.A)({},e),{},{health:i})});const y=s(a);return d.deadAnts=(0,r.A)((0,r.A)({},d.deadAnts),{},{[y.id]:y}),delete u[t],{gameState:(0,r.A)((0,r.A)({},d),{},{ants:u}),damageDealt:g}}function p(e,t,n){const r=n.players[e.owner],o=n.players[t.owner],i=(0,a.getAntAttack)(e,r),s=(0,a.getAntDefense)(t,o,n),l=e.health/e.maxHealth,c=i*Math.min(1,l+.05);return Math.max(1,Math.floor(c-s))}function f(e,t,a){const l=e.ants[t],u=e.ants[a];if(!l||!u)return{gameState:e,damageDealt:[],attackAnimation:null};const d=(0,o.s1)(l.type),f=p(l,u,e),g=[{damage:f,position:u.position}],m={attackerId:t,targetPosition:u.position,isRanged:d.attackRange>1},y=(0,r.A)({},e.ants);let v=(0,r.A)({},e);const{updateHeroPower:b}=n(451);v=b(v,l.owner,f),v=b(v,u.owner,f,.65),v.stats||(v.stats={player1:{},player2:{}}),v.stats[l.owner].damageDealt=(v.stats[l.owner].damageDealt||0)+f,v.stats[u.owner].damageReceived=(v.stats[u.owner].damageReceived||0)+f;const x=u.health-f;if(x<=0){const e=s(u);v.deadAnts=(0,r.A)((0,r.A)({},v.deadAnts),{},{[e.id]:e}),delete y[a],v.stats[l.owner].antsKilled=(v.stats[l.owner].antsKilled||0)+1,v.stats[u.owner].antsLost=(v.stats[u.owner].antsLost||0)+1;const t=v.players[l.owner];if(d.attackRange<=1&&t.upgrades.cannibalism>0&&(v.players=(0,r.A)((0,r.A)({},v.players),{},{[l.owner]:(0,r.A)((0,r.A)({},t),{},{resources:(0,r.A)((0,r.A)({},t.resources),{},{food:t.resources.food+o.sv.CANNIBALISM_FOOD_GAIN,minerals:t.resources.minerals+o.sv.CANNIBALISM_MINERAL_GAIN})})})),"queen"===u.type){v.ants=y;const e=c(v,l.owner,u.owner);v.gameOver=e.gameOver,v.winner=e.winner,v.winningTeam=e.winningTeam}if("bomber"===u.type)return v.ants=y,v=h(v,a),{gameState:v,damageDealt:g,attackAnimation:m}}else y[a]=(0,r.A)((0,r.A)({},u),{},{health:x});if(d.splashDamage&&d.splashRadius){Object.values(y).filter(e=>e.id!==a&&e.owner!==l.owner&&(0,i.hexDistance)(e.position,u.position)<=d.splashRadius).forEach(e=>{const t=Math.floor(.5*f);g.push({damage:t,position:e.position}),v=b(v,l.owner,t),v=b(v,e.owner,t),v.stats[l.owner].damageDealt=(v.stats[l.owner].damageDealt||0)+t,v.stats[e.owner].damageReceived=(v.stats[e.owner].damageReceived||0)+t;const n=e.health-t;if(n<=0){const t=s(e);v.deadAnts=(0,r.A)((0,r.A)({},v.deadAnts),{},{[t.id]:t}),delete y[e.id],v.stats[l.owner].antsKilled=(v.stats[l.owner].antsKilled||0)+1,v.stats[e.owner].antsLost=(v.stats[e.owner].antsLost||0)+1,"queen"===e.type&&(v.gameOver=!0,v.winner=l.owner)}else y[e.id]=(0,r.A)((0,r.A)({},e),{},{health:n})})}const w=(0,o.s1)(u.type),_=(0,i.hexDistance)(l.position,u.position),k=y[a]&&y[a].health>0,S=_<=1&&d.attackRange<=1&&w.attackRange<=1;if(k&&S){const e=p(y[a],l,(0,r.A)((0,r.A)({},v),{},{ants:y}));g.push({damage:e,position:l.position}),v=b(v,u.owner,e),v=b(v,l.owner,e),v.stats[u.owner].damageDealt=(v.stats[u.owner].damageDealt||0)+e,v.stats[l.owner].damageReceived=(v.stats[l.owner].damageReceived||0)+e;const n=l.health-e;if(n<=0){const e=s(l);v.deadAnts=(0,r.A)((0,r.A)({},v.deadAnts),{},{[e.id]:e}),delete y[t],v.stats[u.owner].antsKilled=(v.stats[u.owner].antsKilled||0)+1,v.stats[l.owner].antsLost=(v.stats[l.owner].antsLost||0)+1;const n=v.players[u.owner];if(n.upgrades.cannibalism>0&&(v.players=(0,r.A)((0,r.A)({},v.players),{},{[u.owner]:(0,r.A)((0,r.A)({},n),{},{resources:(0,r.A)((0,r.A)({},n.resources),{},{food:n.resources.food+o.sv.CANNIBALISM_FOOD_GAIN,minerals:n.resources.minerals+o.sv.CANNIBALISM_MINERAL_GAIN})})})),"queen"===l.type){v.ants=y;const e=c(v,u.owner,l.owner);v.gameOver=e.gameOver,v.winner=e.winner,v.winningTeam=e.winningTeam}if("bomber"===l.type)return v.ants=y,v=h(v,t),{gameState:v,damageDealt:g,attackAnimation:m}}else y[t]=(0,r.A)((0,r.A)({},l),{},{health:n})}return{gameState:(0,r.A)((0,r.A)({},v),{},{ants:y}),damageDealt:g,attackAnimation:m}}function g(e,t,r){if(!e||!t)return!1;if(e.owner===t.owner)return!1;if(l(r,e.owner,t.owner))return!1;if("bomber"===e.type)return!1;if(e.isBurrowed&&"soldier"!==e.type)return!1;const a=(0,o.s1)(e.type),s=(0,i.hexDistance)(e.position,t.position);let c=a.attackRange;const u=r.players[e.owner];if(null!==u&&void 0!==u&&u.heroAbilityActive&&"sorlorg"===(null===u||void 0===u?void 0:u.heroId)&&a.attackRange>1){var d;const{getHeroById:e}=n(201),t=e("sorlorg");null!==t&&void 0!==t&&null!==(d=t.heroAbility)&&void 0!==d&&d.rangedRangeBonus&&(c+=t.heroAbility.rangedRangeBonus)}return!(s>c)&&(!(a.minAttackRange&&s<a.minAttackRange)&&(!a.cannotMoveAndAttack||!e.hasMoved))}function m(e,t){const n=t.ants[e];if(!n)return[];const r=(0,o.s1)(n.type),a=r.minAttackRange||0;return Object.values(t.ants).filter(e=>{if(e.owner===n.owner)return!1;if(l(t,n.owner,e.owner))return!1;const o=(0,i.hexDistance)(e.position,n.position);return o>=a&&o<=r.attackRange})}function y(e,t,n){const o=e.ants[t];return o?"queen"===o.type?e:(0,r.A)((0,r.A)({},e),{},{ants:(0,r.A)((0,r.A)({},e.ants),{},{[t]:(0,r.A)((0,r.A)({},o),{},{position:n})})}):e}function v(e,t,a){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const c=e.ants[t];if(!c||"bombardier"!==c.type)return{gameState:e,damageDealt:[],attackAnimation:null};const u=o.xr.BOMBARDIER,d=(e.players[c.owner],(0,i.hexDistance)(c.position,a));if(d<u.minAttackRange||d>u.attackRange)return{gameState:e,damageDealt:[],attackAnimation:null};const p=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],f=p[l%6],g=p[(l+5)%6],m=[a,{q:a.q+f.q,r:a.r+f.r},{q:a.q+g.q,r:a.r+g.r}],y=Object.values(e.ants).filter(e=>m.some(t=>t.q===e.position.q&&t.r===e.position.r)),v=(0,r.A)({},e.ants),b=[];let x=(0,r.A)({},e);const{updateHeroPower:w}=n(451);x.stats||(x.stats={player1:{},player2:{}}),y.forEach(t=>{const n=(0,o.s1)(t.type),i=(e.players[t.owner],n.defense),a=Math.max(1,u.attack-Math.floor(i)),l=t.health-a;if(b.push({damage:a,position:t.position}),x=w(x,c.owner,a),x=w(x,t.owner,a),x.stats[c.owner].damageDealt=(x.stats[c.owner].damageDealt||0)+a,x.stats[t.owner].damageReceived=(x.stats[t.owner].damageReceived||0)+a,l<=0){const e=s(t);if(x.deadAnts=(0,r.A)((0,r.A)({},x.deadAnts),{},{[e.id]:e}),delete v[t.id],x.stats[c.owner].antsKilled=(x.stats[c.owner].antsKilled||0)+1,x.stats[t.owner].antsLost=(x.stats[t.owner].antsLost||0)+1,"queen"===t.type&&(x.gameOver=!0,x.winner=c.owner),"bomber"===t.type){x.ants=v;const e=h(x,t.id);x=e.gameState,e.damageDealt&&b.push(...e.damageDealt)}}else v[t.id]=(0,r.A)((0,r.A)({},t),{},{health:l})});const _={attackerId:t,targetPosition:a,isRanged:!0,isSplash:!0};return{gameState:(0,r.A)((0,r.A)({},x),{},{ants:v}),damageDealt:b,attackAnimation:_}}function b(e,t,i){const a=e.ants[t],l=e.ants[i];if(!a||!l)return{gameState:e,damageDealt:[],attackAnimations:[],ambushOccurred:!1};const c=(0,o.s1)(a.type),u=(0,o.s1)(l.type);let d=(0,r.A)({},e),f=[],g=[];if(u.attackRange>1)return{gameState:d,damageDealt:f,attackAnimations:g,ambushOccurred:!0};const m=p(l,a,d);f.push({damage:m,position:a.position}),g.push({attackerId:i,targetPosition:a.position,isRanged:!1});const{updateHeroPower:y}=n(451);d=y(d,l.owner,m),d=y(d,a.owner,m,.65),d.stats||(d.stats={player1:{},player2:{}}),d.stats[l.owner].damageDealt=(d.stats[l.owner].damageDealt||0)+m,d.stats[a.owner].damageReceived=(d.stats[a.owner].damageReceived||0)+m;const v=(0,r.A)({},d.ants),b=a.health-m;if(b<=0){const e=s(a);d.deadAnts=(0,r.A)((0,r.A)({},d.deadAnts),{},{[e.id]:e}),delete v[t],d.stats[l.owner].antsKilled=(d.stats[l.owner].antsKilled||0)+1,d.stats[a.owner].antsLost=(d.stats[a.owner].antsLost||0)+1;const n=d.players[l.owner];return n.upgrades.cannibalism>0&&(d.players=(0,r.A)((0,r.A)({},d.players),{},{[l.owner]:(0,r.A)((0,r.A)({},n),{},{resources:(0,r.A)((0,r.A)({},n.resources),{},{food:n.resources.food+o.sv.CANNIBALISM_FOOD_GAIN,minerals:n.resources.minerals+o.sv.CANNIBALISM_MINERAL_GAIN})})})),"queen"===a.type&&(d.gameOver=!0,d.winner=l.owner),"bomber"===a.type&&(d.ants=v,d=h(d,t)),{gameState:(0,r.A)((0,r.A)({},d),{},{ants:v}),damageDealt:f,attackAnimations:g,ambushOccurred:!0}}if(v[t]=(0,r.A)((0,r.A)({},a),{},{health:b}),c.attackRange<=1){const e=p(v[t],l,(0,r.A)((0,r.A)({},d),{},{ants:v}));f.push({damage:e,position:l.position}),g.push({attackerId:t,targetPosition:l.position,isRanged:!1}),d=y(d,a.owner,e),d=y(d,l.owner,e,.65),d.stats[a.owner].damageDealt=(d.stats[a.owner].damageDealt||0)+e,d.stats[l.owner].damageReceived=(d.stats[l.owner].damageReceived||0)+e;const n=l.health-e;if(n<=0){const e=s(l);d.deadAnts=(0,r.A)((0,r.A)({},d.deadAnts),{},{[e.id]:e}),delete v[i],d.stats[a.owner].antsKilled=(d.stats[a.owner].antsKilled||0)+1,d.stats[l.owner].antsLost=(d.stats[l.owner].antsLost||0)+1;const t=d.players[a.owner];t.upgrades.cannibalism>0&&(d.players=(0,r.A)((0,r.A)({},d.players),{},{[a.owner]:(0,r.A)((0,r.A)({},t),{},{resources:(0,r.A)((0,r.A)({},t.resources),{},{food:t.resources.food+o.sv.CANNIBALISM_FOOD_GAIN,minerals:t.resources.minerals+o.sv.CANNIBALISM_MINERAL_GAIN})})})),"queen"===l.type&&(d.gameOver=!0,d.winner=a.owner),"bomber"===l.type&&(d.ants=v,d=h(d,i))}else v[i]=(0,r.A)((0,r.A)({},l),{},{health:n})}return{gameState:(0,r.A)((0,r.A)({},d),{},{ants:v}),damageDealt:f,attackAnimations:g,ambushOccurred:!0}}},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<i(o,t)))break e;e[r]=t,e[n]=o,n=r}}function r(e){return 0===e.length?null:e[0]}function o(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,a=o>>>1;r<a;){var s=2*(r+1)-1,l=e[s],c=s+1,u=e[c];if(0>i(l,n))c<o&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[s]=n,r=s);else{if(!(c<o&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,g=!1,m=!1,y=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)o(u);else{if(!(t.startTime<=e))break;o(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(m=!1,w(e),!g)if(null!==r(c))g=!0,S||(S=!0,k());else{var t=r(u);null!==t&&P(_,t.startTime-e)}}var k,S=!1,C=-1,A=5,E=-1;function T(){return!!y||!(t.unstable_now()-E<A)}function R(){if(y=!1,S){var e=t.unstable_now();E=e;var n=!0;try{e:{g=!1,m&&(m=!1,b(C),C=-1),f=!0;var i=p;try{t:{for(w(e),h=r(c);null!==h&&!(h.expirationTime>e&&T());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,w(e),n=!0;break t}h===r(c)&&o(c),w(e)}else o(c);h=r(c)}if(null!==h)n=!0;else{var l=r(u);null!==l&&P(_,l.startTime-e),n=!1}}break e}finally{h=null,p=i,f=!1}n=void 0}}finally{n?k():S=!1}}}if("function"===typeof x)k=function(){x(R)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,I=j.port2;j.port1.onmessage=R,k=function(){I.postMessage(null)}}else k=function(){v(R,0)};function P(e,n){C=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){y=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,o,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(m?(b(C),C=-1):m=!0,P(_,i-a))):(e.sortIndex=s,n(c,e),g||f||(g=!0,S||(S=!0,k()))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)},965:(e,t,n)=>{n.d(t,{$b:()=>o,Vy:()=>c});const r=[];var o;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(o||(o={}));const i={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},a=o.INFO,s={[o.DEBUG]:"log",[o.VERBOSE]:"log",[o.INFO]:"info",[o.WARN]:"warn",[o.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=s[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class c{constructor(e){this.name=e,this._logLevel=a,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in o))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,o.DEBUG,...t),this._logHandler(this,o.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,o.VERBOSE,...t),this._logHandler(this,o.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,o.INFO,...t),this._logHandler(this,o.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,o.WARN,...t),this._logHandler(this,o.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,o.ERROR,...t),this._logHandler(this,o.ERROR,...t)}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+".f7e1684b.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="my-vibe-game-web:";n.l=(r,o,i,a)=>{if(e[r])e[r].push(o);else{var s,l;if(void 0!==i)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[o];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/Battle-Ants/",(()=>{var e={792:0};n.f.j=(t,r)=>{var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var i=new Promise((n,r)=>o=e[t]=[n,r]);r.push(o[2]=i);var a=n.p+n.u(t),s=new Error;n.l(a,r=>{if(n.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+a+")",s.name="ChunkLoadError",s.type=i,s.request=a,o[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var o,i,[a,s,l]=r,c=0;if(a.some(t=>0!==e[t])){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(l)l(n)}for(t&&t(r);c<a.length;c++)i=a[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkmy_vibe_game_web=self.webpackChunkmy_vibe_game_web||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n(43),o=n(391),i=n(555),a=n(451),s=n(867),l=n(352),c=n(624),u=n(800),d=n(232);(0,d.KO)("firebase","12.5.0","app");const h=(0,d.Wp)({apiKey:"AIzaSyAm_eP1oO4JRCw_g2LbA3M2JzbEw8Yyt2E",authDomain:"ants-a151c.firebaseapp.com",databaseURL:"https://ants-a151c-default-rtdb.firebaseio.com",projectId:"ants-a151c",storageBucket:"ants-a151c.firebasestorage.app",messagingSenderId:"153169207809",appId:"1:153169207809:web:55925d1a6d46fb41471600",measurementId:"G-H0G894F8BZ"}),p=(0,u.C3)(h);function f(e){if(!e)return null;const t=(0,i.A)((0,i.A)({},e),{},{ants:{},eggs:{},resources:{},anthills:{},trees:{},deadAnts:{}});return e.ants&&Object.entries(e.ants).forEach(e=>{let[n,r]=e;r&&r.position?t.ants[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping ant with undefined position:",n,r)}),e.eggs&&Object.entries(e.eggs).forEach(e=>{let[n,r]=e;r&&r.position?t.eggs[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping egg with undefined position:",n,r)}),e.resources&&Object.entries(e.resources).forEach(e=>{let[n,r]=e;r&&r.position?t.resources[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping resource with undefined position:",n,r)}),e.anthills&&Object.entries(e.anthills).forEach(e=>{let[n,r]=e;r&&r.position?t.anthills[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping anthill with undefined position:",n,r)}),e.trees&&Object.entries(e.trees).forEach(e=>{let[n,r]=e;r&&r.position?t.trees[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping tree with undefined position:",n,r)}),e.deadAnts&&Object.entries(e.deadAnts).forEach(e=>{let[n,r]=e;r&&r.position?t.deadAnts[n]=(0,i.A)((0,i.A)({},r),{},{position:{q:r.position.q,r:r.position.r}}):console.warn("Skipping dead ant with undefined position:",n,r)}),t}async function g(e,t){const n=(0,u.KR)(p,"games/".concat(e,"/gameState")),r=f(t);return new Promise((e,t)=>{(0,u.hZ)(n,r).then(()=>{console.log("Firebase write completed successfully"),e()}).catch(e=>{console.error("Firebase write failed:",e),t(e)})})}function m(e,t){const n=(0,u.KR)(p,"games/".concat(e,"/gameState")),r=(0,u.Zy)(n,e=>{if(e.exists()){const n=Date.now(),r=function(e){const t=(0,i.A)((0,i.A)({},e),{},{ants:{},eggs:{},resources:{},anthills:{},trees:{},deadAnts:{}});return e.ants&&Object.entries(e.ants).forEach(e=>{let[n,r]=e;t.ants[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),e.eggs&&Object.entries(e.eggs).forEach(e=>{let[n,r]=e;t.eggs[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),e.resources&&Object.entries(e.resources).forEach(e=>{let[n,r]=e;t.resources[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),e.anthills&&Object.entries(e.anthills).forEach(e=>{let[n,r]=e;t.anthills[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),e.trees&&Object.entries(e.trees).forEach(e=>{let[n,r]=e;t.trees[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),e.deadAnts&&Object.entries(e.deadAnts).forEach(e=>{let[n,r]=e;t.deadAnts[n]=(0,i.A)((0,i.A)({},r),{},{position:new c.HexCoord(r.position.q,r.position.r)})}),t}(e.val());if(r.lastUpdateTimestamp){const e=n-r.lastUpdateTimestamp;console.log("Firebase sync delay: ".concat(e,"ms"))}t(r)}},e=>{console.error("Firebase subscription error:",e)});return r}function y(e,t){const n=new Set,r=new Set([t]);e.players&&Object.keys(e.players).forEach(n=>{((t,n)=>{var r,o;if(t===n)return!0;const i=null===(r=e.players)||void 0===r?void 0:r[t],a=null===(o=e.players)||void 0===o?void 0:o[n];return!(null===i||void 0===i||!i.team||null===a||void 0===a||!a.team)&&i.team===a.team})(t,n)&&r.add(n)});return e.ants&&Object.values(e.ants).forEach(o=>{if(r.has(o.owner)){0;let r="scout"===o.type||"queen"===o.type?2:1;if(e.anthills){Object.values(e.anthills).find(e=>e.position.q===o.position.q&&e.position.r===o.position.r&&e.owner===t)&&(r+=1)}for(let e=-r;e<=r;e++)for(let t=-r;t<=r;t++){const i=-e-t;if(Math.abs(e)<=r&&Math.abs(t)<=r&&Math.abs(i)<=r){const i=new c.HexCoord(o.position.q+e,o.position.r+t);(0,c.hexDistance)(o.position,i)<=r&&n.add("".concat(i.q,",").concat(i.r))}}}}),e.anthills&&Object.values(e.anthills).forEach(e=>{r.has(e.owner)&&n.add("".concat(e.position.q,",").concat(e.position.r))}),r.forEach(t=>{var r,o;null!==(r=e.players)&&void 0!==r&&null!==(o=r[t])&&void 0!==o&&o.revealedHexes&&e.players[t].revealedHexes.forEach(e=>{n.add(e)})}),e.deadAnts&&Object.values(e.deadAnts).forEach(e=>{if(r.has(e.owner)){const t=1;for(let r=-t;r<=t;r++)for(let o=-t;o<=t;o++){const i=-r-o;if(Math.abs(r)<=t&&Math.abs(o)<=t&&Math.abs(i)<=t){const i=new c.HexCoord(e.position.q+r,e.position.r+o);(0,c.hexDistance)(e.position,i)<=t&&n.add("".concat(i.q,",").concat(i.r))}}}}),n}function v(e,t){const n=new Set;if(!e.ants)return n;const r=new Set([t]);e.players&&Object.keys(e.players).forEach(n=>{((t,n)=>{var r,o;if(t===n)return!0;const i=null===(r=e.players)||void 0===r?void 0:r[t],a=null===(o=e.players)||void 0===o?void 0:o[n];return!(null===i||void 0===i||!i.team||null===a||void 0===a||!a.team)&&i.team===a.team})(t,n)&&r.add(n)});const o=Object.values(e.ants).filter(e=>!r.has(e.owner)&&e.isBurrowed);Object.values(e.ants).filter(e=>r.has(e.owner)&&"scout"===e.type).forEach(t=>{let i=2;if(e.anthills){Object.values(e.anthills).find(e=>e.position.q===t.position.q&&e.position.r===t.position.r&&r.has(e.owner))&&(i+=1)}o.forEach(e=>{(0,c.hexDistance)(t.position,e.position)<=i&&n.add(e.id)})});const i=[];return r.forEach(t=>{var n,r;const o=(null===(n=e.players)||void 0===n||null===(r=n[t])||void 0===r?void 0:r.revealedHexes)||[];i.push(...o)}),o.forEach(e=>{const t="".concat(e.position.q,",").concat(e.position.r);i.includes(t)&&n.add(e.id)}),n}function b(e,t){const n=y(e,t),r=v(e,t),o={};e.ants&&Object.entries(e.ants).forEach(i=>{let[a,s]=i;if(!s.position)return;const l="".concat(s.position.q,",").concat(s.position.r);s.owner===t?o[a]=s:(n.has(l)||r.has(a))&&(function(e,t,n){const r=(t,n)=>{var r,o;if(t===n)return!0;const i=null===(r=e.players)||void 0===r?void 0:r[t],a=null===(o=e.players)||void 0===o?void 0:o[n];return!(null===i||void 0===i||!i.team||null===a||void 0===a||!a.team)&&i.team===a.team};if(!t||r(t.owner,n))return!1;if(!e.trees||!Object.values(e.trees).find(e=>e.position.q===t.position.q&&e.position.r===t.position.r))return!1;const o=e.ants?Object.values(e.ants).filter(e=>r(e.owner,n)&&!e.isDead):[];for(const i of o)if(1===(0,c.hexDistance)(i.position,t.position))return!1;return!0}(e,s,t)||(o[a]=s))});const a={};e.eggs&&Object.entries(e.eggs).forEach(e=>{let[t,r]=e;if(!r.position)return;const o="".concat(r.position.q,",").concat(r.position.r);n.has(o)&&(a[t]=r)});const s=e.resources||{},l={};Object.entries(e.anthills||{}).forEach(e=>{let[r,o]=e;if(!o.position)return;const i="".concat(o.position.q,",").concat(o.position.r);(o.owner===t||n.has(i))&&(l[r]=o)});const u={};e.deadAnts&&Object.entries(e.deadAnts).forEach(e=>{let[t,r]=e;if(!r.position)return;const o="".concat(r.position.q,",").concat(r.position.r);n.has(o)&&(u[t]=r)});const d={};return Object.entries(e.players||{}).forEach(e=>{let[n,r]=e;d[n]=n===t?r:{name:r.name,color:r.color,heroId:r.heroId,resources:{food:"??",minerals:"??"},upgrades:r.upgrades||{},queenTier:r.queenTier,energy:r.energy,heroAbilityActive:r.heroAbilityActive,heroPower:r.heroPower}}),(0,i.A)((0,i.A)({},e),{},{ants:o,eggs:a,resources:s,anthills:l,deadAnts:u,players:d})}var x=n(579);const w=function(e){let{onStartGame:t,onEnterLobby:n,onEnterLocalSetup:o,onEnterAISetup:i,onEnterOnlineMultiplayer:a}=e;const[s,l]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async()=>{try{const e=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;try{const n=(0,u.KR)(p,"games"),r=await(0,u.get)(n);if(!r.exists())return console.log("No rooms to clean up"),{deleted:0,errors:0};const o=r.val(),i=Date.now(),a=60*e*60*1e3;let s=0,l=0;for(const[e,c]of Object.entries(o))try{c.createdAt&&i-c.createdAt>a?(await(0,u.TF)((0,u.KR)(p,"games/".concat(e))),s++,console.log("Deleted old room: ".concat(e))):c.createdAt||(await(0,u.TF)((0,u.KR)(p,"games/".concat(e))),s++,console.log("Deleted legacy room (no timestamp): ".concat(e)))}catch(t){console.error("Error deleting room ".concat(e,":"),t),l++}return console.log("Cleanup complete: ".concat(s," rooms deleted, ").concat(l," errors")),{deleted:s,errors:l}}catch(t){throw console.error("Error during room cleanup:",t),t}}(24);e.deleted>0&&console.log("Cleaned up ".concat(e.deleted," old rooms"))}catch(e){console.error("Error cleaning up old rooms:",e)}})()},[]),(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/antwars_background.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"20px"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/title_screen_title.png"),alt:"Ant Wars",style:{maxWidth:"500px",width:"90%",marginBottom:"40px",marginTop:"-60px",filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.5))"}}),(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"25px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxWidth:"400px",width:"100%",border:"2px solid rgba(192, 192, 192, 0.3)"},children:[(0,x.jsx)("button",{onClick:()=>{i()},style:{width:"100%",padding:"15px",fontSize:"18px",marginBottom:"15px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Versus AI"}),(0,x.jsx)("button",{onClick:()=>{a()},style:{width:"100%",padding:"15px",fontSize:"18px",marginBottom:"15px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Online Multiplayer"}),(0,x.jsx)("button",{onClick:()=>{o()},style:{width:"100%",padding:"15px",fontSize:"18px",marginBottom:"15px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Local Game (Hot Seat)"}),(0,x.jsx)("div",{style:{marginTop:"5px",padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"5px",fontSize:"12px",color:"#ccc",border:"1px solid rgba(192, 192, 192, 0.2)",textAlign:"center"},children:"Choose your game mode to begin your ant empire!"})]})]})};const _=function(e){let{onEnterGameLobby:t,onBack:n}=e;const[o,i]=(0,r.useState)("main"),[a,s]=(0,r.useState)(!1),[l,c]=(0,r.useState)(""),[d,h]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[m,y]=(0,r.useState)(2),[v,b]=(0,r.useState)([]),[w,_]=(0,r.useState)(null),[k,S]=(0,r.useState)("");(0,r.useEffect)(()=>{if("browse"===o){C();const e=(0,u.KR)(p,"lobbies"),t=(0,u.Zy)(e,()=>{C()});return()=>t()}},[o]);const C=async()=>{try{const e=await async function(){try{const e=(0,u.KR)(p,"lobbies"),t=await(0,u.get)(e);if(!t.exists())return[];const n=[],r=Date.now()-36e5;return t.forEach(e=>{var t,o,i,a;const s=e.val(),l=s.playerCount||2;let c=0;null!==(t=s.player1)&&void 0!==t&&t.id&&c++,null!==(o=s.player2)&&void 0!==o&&o.id&&c++,null!==(i=s.player3)&&void 0!==i&&i.id&&c++,null!==(a=s.player4)&&void 0!==a&&a.id&&c++,!s.gameStarted&&c<l&&s.createdAt>r&&n.push({roomCode:s.roomCode,gameName:s.gameName,hasPassword:s.hasPassword,createdAt:s.createdAt,mapSize:s.mapSize,fogOfWar:s.fogOfWar,playerCount:l,joinedCount:c})}),n.sort((e,t)=>t.createdAt-e.createdAt),n}catch(e){throw console.error("Error getting available lobbies:",e),e}}();b(e)}catch(e){console.error("Error loading games:",e)}},A=async()=>{if(l.trim())if(!f||d.trim()){s(!0);try{const e=Math.floor(1e3+9e3*Math.random()).toString(),n="player_".concat(Date.now());await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const r=(0,u.KR)(p,"lobbies/".concat(e));if((await(0,u.get)(r)).exists())throw new Error("Room code already exists. Please try again.");const o=n.playerCount||2;let i="rectangle";3===o&&(i="triangle"),4===o&&(i="square");const a={roomCode:e,gameName:n.gameName||"Game ".concat(e),hasPassword:!!n.password,password:n.password||null,hostId:t,createdAt:Date.now(),playerCount:o,mapShape:i,player1:{id:t,color:"#FF0000",hero:"gorlak",team:null,ready:!1},player2:{id:null,color:"#0000FF",hero:"sorlorg",team:null,ready:!1},mapSize:"medium",fogOfWar:!0,gameStarted:!1};return o>=3&&(a.player3={id:null,color:"#00FF00",hero:"skrazzit",team:null,ready:!1}),o>=4&&(a.player4={id:null,color:"#FFFF00",hero:"thorgrim",team:null,ready:!1}),await(0,u.hZ)(r,a),{success:!0,roomCode:e}}catch(r){throw console.error("Error creating lobby:",r),r}}(e,n,{gameName:l.trim(),password:f?d.trim():null,playerCount:m}),t({gameId:e,playerId:n,playerRole:"player1",isHost:!0,isMultiplayer:!0})}catch(e){alert("Error creating game: "+e.message),console.error("Full error:",e)}s(!1)}else alert('Please enter a password or uncheck "Password Protected"');else alert("Please enter a game name")},E=async e=>{if(!e.hasPassword||w){s(!0);try{const n="player_".concat(Date.now()),r=e.hasPassword?k:null,{playerRole:o,isHost:i}=await async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var r,o,i,a,s;const l=(0,u.KR)(p,"lobbies/".concat(e)),c=await(0,u.get)(l);if(!c.exists())throw new Error("Game not found");const d=c.val();if(d.hasPassword&&d.password!==n)throw new Error("Incorrect password");if((null===(r=d.player1)||void 0===r?void 0:r.id)===t)return{playerRole:"player1",isHost:!0};if((null===(o=d.player2)||void 0===o?void 0:o.id)===t)return{playerRole:"player2",isHost:!1};if((null===(i=d.player3)||void 0===i?void 0:i.id)===t)return{playerRole:"player3",isHost:!1};if((null===(a=d.player4)||void 0===a?void 0:a.id)===t)return{playerRole:"player4",isHost:!1};const h=d.playerCount||2;if(null===(s=d.player2)||void 0===s||!s.id)return await(0,u.yo)(l,{"player2/id":t}),{playerRole:"player2",isHost:!1};if(h>=3&&d.player3&&!d.player3.id)return await(0,u.yo)(l,{"player3/id":t}),{playerRole:"player3",isHost:!1};if(h>=4&&d.player4&&!d.player4.id)return await(0,u.yo)(l,{"player4/id":t}),{playerRole:"player4",isHost:!1};throw new Error("Room is full")}catch(l){throw console.error("Error joining lobby:",l),l}}(e.roomCode,n,r);t({gameId:e.roomCode,playerId:n,playerRole:o,isHost:i,isMultiplayer:!0})}catch(n){alert("Error joining game: "+n.message),console.error("Full error:",n),S(""),_(null)}s(!1)}else _(e)},T=e=>{const t=Math.floor((Date.now()-e)/6e4);return t<1?"Just now":1===t?"1 minute ago":t<60?"".concat(t," minutes ago"):"".concat(Math.floor(t/60)," hours ago")};return(0,x.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/antwars_background.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"20px"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/title_screen_title.png"),alt:"Ant Wars",style:{maxWidth:"500px",width:"90%",marginBottom:"40px",marginTop:"-60px",filter:"drop-shadow(0 4px 8px rgba(0,0,0,0.5))"}}),(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"25px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxWidth:"browse"===o?"600px":"400px",width:"100%",border:"2px solid rgba(192, 192, 192, 0.3)"},children:["main"===o&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h2",{style:{textAlign:"center",marginTop:0,marginBottom:"20px",color:"#e0e0e0",fontSize:"24px"},children:"Online Multiplayer"}),(0,x.jsx)("button",{onClick:()=>i("host"),style:{width:"100%",padding:"15px",fontSize:"18px",marginBottom:"15px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Host Game"}),(0,x.jsx)("button",{onClick:()=>i("browse"),style:{width:"100%",padding:"15px",fontSize:"18px",marginBottom:"15px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Browse Games"}),(0,x.jsx)("button",{onClick:n,style:{width:"100%",padding:"12px",fontSize:"16px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888"},onMouseOut:e=>{e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666"},children:"Back to Main Menu"}),(0,x.jsx)("div",{style:{marginTop:"15px",padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"5px",fontSize:"12px",color:"#ccc",border:"1px solid rgba(192, 192, 192, 0.2)",textAlign:"center"},children:"Host a new game or browse available games to join"})]}),"host"===o&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h2",{style:{textAlign:"center",marginTop:0,marginBottom:"20px",color:"#e0e0e0",fontSize:"24px"},children:"Host New Game"}),(0,x.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#e0e0e0",fontSize:"14px"},children:"Game Name:"}),(0,x.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Enter game name...",maxLength:"30",autoFocus:!0,style:{width:"100%",padding:"12px",fontSize:"16px",border:"2px solid #666",borderRadius:"5px",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.2)",boxSizing:"border-box"}})]}),(0,x.jsx)("div",{style:{marginBottom:"15px"},children:(0,x.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"8px",cursor:"pointer",color:"#e0e0e0",fontSize:"14px"},children:[(0,x.jsx)("input",{type:"checkbox",checked:f,onChange:e=>g(e.target.checked),style:{width:"18px",height:"18px",cursor:"pointer"}}),"Password Protected"]})}),f&&(0,x.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#e0e0e0",fontSize:"14px"},children:"Password:"}),(0,x.jsx)("input",{type:"password",value:d,onChange:e=>h(e.target.value),placeholder:"Enter password...",maxLength:"20",style:{width:"100%",padding:"12px",fontSize:"16px",border:"2px solid #666",borderRadius:"5px",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"inset 0 2px 4px rgba(0,0,0,0.2)",boxSizing:"border-box"}})]}),(0,x.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",color:"#e0e0e0",fontSize:"14px"},children:"Number of Players:"}),(0,x.jsx)("div",{style:{display:"flex",gap:"10px"},children:[2,3,4].map(e=>(0,x.jsxs)("button",{onClick:()=>y(e),style:{flex:1,padding:"12px",fontSize:"16px",fontWeight:"bold",background:m===e?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:m===e?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:[e,"P"]},e))}),(0,x.jsxs)("p",{style:{margin:"8px 0 0 0",fontSize:"12px",color:"#b0b0b0"},children:[2===m&&"Standard 1v1 match",3===m&&"Triangle map - 1v1v1 or 2v1",4===m&&"Square map - 1v1v1v1 or 2v2"]})]}),(0,x.jsx)("button",{onClick:A,disabled:a,style:{width:"100%",padding:"12px",fontSize:"16px",marginBottom:"10px",background:a?"linear-gradient(145deg, #3a3a3a, #2a2a2a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:a?"not-allowed":"pointer",opacity:a?.6:1,fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},onMouseOver:e=>{a||(e.target.style.background="linear-gradient(145deg, #5a5a5a, #3a3a3a)",e.target.style.borderColor="#888")},onMouseOut:e=>{a||(e.target.style.background="linear-gradient(145deg, #4a4a4a, #2a2a2a)",e.target.style.borderColor="#666")},children:a?"Creating...":"Create Game"}),(0,x.jsx)("button",{onClick:()=>i("main"),style:{width:"100%",padding:"10px",fontSize:"14px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Back"})]}),"browse"===o&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h2",{style:{textAlign:"center",marginTop:0,marginBottom:"15px",color:"#e0e0e0",fontSize:"24px"},children:"Available Games"}),(0,x.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",marginBottom:"15px",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"8px",padding:"10px"},children:0===v.length?(0,x.jsx)("div",{style:{textAlign:"center",padding:"40px 20px",color:"#b0b0b0",fontSize:"14px"},children:"No games available. Host a new game to get started!"}):v.map(e=>(0,x.jsxs)("div",{style:{backgroundColor:(null===w||void 0===w?void 0:w.roomCode)===e.roomCode?"rgba(52, 152, 219, 0.3)":"rgba(255, 255, 255, 0.1)",padding:"12px",marginBottom:"10px",borderRadius:"8px",border:(null===w||void 0===w?void 0:w.roomCode)===e.roomCode?"2px solid #3498db":"2px solid #666",cursor:"pointer",transition:"all 0.2s"},onClick:()=>{e.hasPassword&&(null===w||void 0===w?void 0:w.roomCode)!==e.roomCode?(_(e),S("")):E(e)},onMouseOver:t=>{(null===w||void 0===w?void 0:w.roomCode)!==e.roomCode&&(t.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.15)",t.currentTarget.style.borderColor="#888")},onMouseOut:t=>{(null===w||void 0===w?void 0:w.roomCode)!==e.roomCode&&(t.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",t.currentTarget.style.borderColor="#666")},children:[(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,x.jsxs)("div",{style:{fontSize:"16px",fontWeight:"bold",color:"#e0e0e0",display:"flex",alignItems:"center",gap:"8px"},children:[e.gameName,e.hasPassword&&(0,x.jsx)("span",{style:{fontSize:"14px"},children:"\ud83d\udd12"})]}),(0,x.jsx)("div",{style:{fontSize:"12px",color:"#b0b0b0"},children:T(e.createdAt)})]}),(0,x.jsxs)("div",{style:{fontSize:"12px",color:"#b0b0b0",display:"flex",gap:"15px"},children:[(0,x.jsxs)("span",{children:["Players: ",e.joinedCount||1,"/",e.playerCount||2]}),(0,x.jsxs)("span",{children:["Map: ",e.mapSize]}),(0,x.jsxs)("span",{children:["Fog: ",e.fogOfWar?"On":"Off"]}),(0,x.jsxs)("span",{style:{fontFamily:"monospace"},children:["#",e.roomCode]})]}),(null===w||void 0===w?void 0:w.roomCode)===e.roomCode&&e.hasPassword&&(0,x.jsxs)("div",{style:{marginTop:"10px"},onClick:e=>e.stopPropagation(),children:[(0,x.jsx)("input",{type:"password",value:k,onChange:e=>S(e.target.value),placeholder:"Enter password...",autoFocus:!0,onKeyPress:t=>{"Enter"===t.key&&E(e)},style:{width:"100%",padding:"8px",fontSize:"14px",border:"2px solid #666",borderRadius:"5px",backgroundColor:"rgba(255, 255, 255, 0.9)",boxSizing:"border-box"}}),(0,x.jsx)("button",{onClick:t=>{t.stopPropagation(),E(e)},disabled:a,style:{width:"100%",marginTop:"8px",padding:"8px",fontSize:"14px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:a?"not-allowed":"pointer",fontWeight:"bold"},children:a?"Joining...":"Join"})]})]},e.roomCode))}),(0,x.jsx)("button",{onClick:C,style:{width:"100%",padding:"10px",fontSize:"14px",marginBottom:"10px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Refresh"}),(0,x.jsx)("button",{onClick:()=>{i("main"),_(null),S("")},style:{width:"100%",padding:"10px",fontSize:"14px",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",fontWeight:"bold",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Back"})]})]})]})};var k=n(201);const S=function(e){var t,o,a,s,l,c,d,h,f,g,m,y,v,b,w,_,S,C,A,E,T,R,j,I,P,M,O,N,D,F,q,L,z,H,B;let{roomCode:W,playerId:U,playerRole:V,isHost:G,onStartGame:Q,onBack:K}=e;const[Y,$]=(0,r.useState)({playerCount:2,mapShape:"rectangle",player1:{id:null,color:"#FF0000",hero:"gorlak",team:null,ready:!1},player2:{id:null,color:"#0000FF",hero:"sorlorg",team:null,ready:!1},player3:null,player4:null,mapSize:"large",fogOfWar:!0,gameStarted:!1}),Z={gorlak:"#FF0000",sorlorg:"#00FF00",skrazzit:"#0000FF",thorgrim:"#FFFF00",vexxara:"#000000"},X=["#FF0000","#00FF00","#0000FF","#FFFF00","#000000"],J=Object.values(k.HeroQueens);"player1"===V?Y.player2.id:Y.player1.id,(0,r.useEffect)(()=>{const e=(0,u.KR)(p,"lobbies/".concat(W));(async()=>{if(G){const{get:t}=await Promise.resolve().then(n.bind(n,800)),r=await t(e);if(r.exists()){const t=r.val();t.player1&&t.player1.id===U||(0,u.yo)(e,{"player1/id":U})}else(0,u.yo)(e,{player1:{id:U,color:"#FF0000",hero:"gorlak",ready:!1},player2:{id:null,color:"#0000FF",hero:"sorlorg",ready:!1},mapSize:"large",fogOfWar:!0,gameStarted:!1})}else{const{get:t}=await Promise.resolve().then(n.bind(n,800)),r=await t(e);if(r.exists()){const t=r.val()[V];t&&t.id===U||(0,u.yo)(e,{["".concat(V,"/id")]:U,["".concat(V,"/color")]:(null===t||void 0===t?void 0:t.color)||"#0000FF",["".concat(V,"/ready")]:(null===t||void 0===t?void 0:t.ready)||!1})}}})();const t=(0,u.Zy)(e,e=>{if(e.exists()){const c=e.val();if($(c),c.gameStarted){var t,n,r,o,i,a,s,l;console.log("GameLobby: Game starting with Firebase data:",{playerCount:c.playerCount,mapShape:c.mapShape,hasPlayer3:!!c.player3,hasPlayer4:!!c.player4});const e=[],u=(t,n)=>{if(null===t||void 0===t||!t.hero)return X[n%X.length];let r=Z[t.hero];return e.includes(r)&&(r=X.find(t=>!e.includes(t))||X[n%X.length]),e.push(r),r},d=u(c.player1,0),h=u(c.player2,1),p=c.player3?u(c.player3,2):null,f=c.player4?u(c.player4,3):null;Q({gameId:W,playerId:U,playerRole:V,isHost:G,isMultiplayer:!0,playerCount:c.playerCount||2,mapShape:c.mapShape||"rectangle",mapSize:c.mapSize,fogOfWar:void 0===c.fogOfWar||c.fogOfWar,player1Color:d,player2Color:h,player3Color:p,player4Color:f,player1Hero:null===(t=c.player1)||void 0===t?void 0:t.hero,player2Hero:null===(n=c.player2)||void 0===n?void 0:n.hero,player3Hero:null===(r=c.player3)||void 0===r?void 0:r.hero,player4Hero:null===(o=c.player4)||void 0===o?void 0:o.hero,player1Team:null===(i=c.player1)||void 0===i?void 0:i.team,player2Team:null===(a=c.player2)||void 0===a?void 0:a.team,player3Team:null===(s=c.player3)||void 0===s?void 0:s.team,player4Team:null===(l=c.player4)||void 0===l?void 0:l.team})}}});return()=>t()},[W,U,V,G,Q]);const ee=e=>{const t=(0,u.KR)(p,"lobbies/".concat(W));(0,u.yo)(t,{["".concat(V,"/team")]:e})},te=()=>{var e,t,n,r;const o=[];return null!==(e=Y.player1)&&void 0!==e&&e.id&&o.push((0,i.A)({role:"player1"},Y.player1)),null!==(t=Y.player2)&&void 0!==t&&t.id&&o.push((0,i.A)({role:"player2"},Y.player2)),null!==(n=Y.player3)&&void 0!==n&&n.id&&o.push((0,i.A)({role:"player3"},Y.player3)),null!==(r=Y.player4)&&void 0!==r&&r.id&&o.push((0,i.A)({role:"player4"},Y.player4)),o},ne=()=>{const e=Y.playerCount||2;return te().length>=e},re=()=>{const e=Y.playerCount||2;for(let t=1;t<=e;t++){const e="player".concat(t),n=Y[e];if(null!==n&&void 0!==n&&n.id&&"player1"!==e&&!n.ready)return!1}return!0},oe=(null===(t=Y[V])||void 0===t?void 0:t.hero)||"gorlak",ie=Z[oe];return"player1"===V?null===(o=Y.player2)||void 0===o||o.hero:null===(a=Y.player1)||void 0===a||a.hero,(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/antwars_background.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"15px",boxSizing:"border-box"},children:(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxWidth:"1400px",width:"100%",maxHeight:"95vh",display:"flex",flexDirection:"column",border:"2px solid rgba(192, 192, 192, 0.3)",boxSizing:"border-box"},children:[(0,x.jsx)("h1",{style:{textAlign:"center",marginBottom:"4px",fontSize:"22px",color:"#e0e0e0"},children:"Multiplayer Lobby"}),(0,x.jsxs)("h3",{style:{textAlign:"center",marginBottom:"10px",color:"#b0b0b0",fontSize:"13px"},children:["Room Code: ",(0,x.jsx)("span",{style:{color:"#e0e0e0",fontFamily:"monospace",fontSize:"18px",letterSpacing:"3px"},children:W})]}),(0,x.jsx)("div",{style:{flex:1,marginBottom:"10px",display:"flex",flexDirection:"column",minHeight:0},children:(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",flex:1,minHeight:0},children:[(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px",minHeight:0},children:(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #3498db",display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsxs)("h3",{style:{marginBottom:"6px",fontSize:"15px",display:"flex",alignItems:"center",gap:"6px",color:"#e0e0e0"},children:["You ","player1"===V?"(South)":"(North)"," ",G&&"\ud83d\udc51",(0,x.jsx)("div",{style:{width:"20px",height:"20px",backgroundColor:ie,border:"2px solid #2c3e50",borderRadius:"50%"},title:"Color: ".concat(ie)})]}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",fontSize:"15px",color:"#e0e0e0"},children:"Choose Your Hero:"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"10px",flex:1,alignContent:"start"},children:J.map(e=>(0,x.jsxs)("div",{onClick:()=>(e=>{const t=(0,u.KR)(p,"lobbies/".concat(W));let n;if("player1"===V)if(e===Y.player2.hero){const t=Z[e];n=X.find(e=>e!==t)||X[0]}else n=Z[Y.player2.hero];else if(e===Y.player1.hero){const e=Z[Y.player1.hero];n=X.find(t=>t!==e)||X[0]}else n=Z[e];(0,u.yo)(t,(0,i.A)({["".concat(V,"/hero")]:e,["".concat(V,"/color")]:"player1"===V?Z[e]:n},"player1"===V&&{"player2/color":n}))})(e.id),style:{padding:"8px",border:oe===e.id?"3px solid #3498db":"2px solid #95a5a6",borderRadius:"8px",cursor:"pointer",backgroundColor:oe===e.id?"rgba(52, 152, 219, 0.2)":"rgba(255, 255, 255, 0.1)",textAlign:"center",transition:"all 0.2s",display:"flex",flexDirection:"column"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/").concat(e.portraitImage),alt:e.name,style:{width:"100%",height:"auto",aspectRatio:"1",marginBottom:"6px",imageRendering:"pixelated"}}),(0,x.jsx)("div",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"3px",color:"#e0e0e0"},children:e.name}),(0,x.jsx)("div",{style:{fontSize:"11px",color:"#b0b0b0",lineHeight:"1.3"},children:e.description})]},e.id))})]})]})}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"12px"},children:[2===(Y.playerCount||2)?(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsxs)("h3",{style:{marginBottom:"10px",fontSize:"17px",color:"#e0e0e0"},children:["Map Size ",!G&&"(Host chooses)"]}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{name:"Small (7x7)",value:"small"},{name:"Medium (9x9)",value:"medium"},{name:"Large (11x11)",value:"large"}].map(e=>(0,x.jsx)("button",{onClick:()=>(e=>{if(!G)return;const t=(0,u.KR)(p,"lobbies/".concat(W));(0,u.yo)(t,{mapSize:e})})(e.value),disabled:!G,style:{padding:"12px",fontSize:"15px",fontWeight:"bold",background:Y.mapSize===e.value?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:Y.mapSize===e.value?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:G?"pointer":"not-allowed",opacity:G?1:.6,boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:e.name},e.value))})]}):(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsx)("h3",{style:{marginBottom:"10px",fontSize:"17px",color:"#e0e0e0"},children:"Map Shape"}),(0,x.jsxs)("div",{style:{padding:"12px",fontSize:"15px",color:"#b0b0b0",textAlign:"center"},children:[3===Y.playerCount&&"\u25b2 Triangle Map (3 Players)",4===Y.playerCount&&"\u25c6 Square Map (4 Players)"]})]}),(0,x.jsx)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h3",{style:{marginBottom:"4px",fontSize:"17px",color:"#e0e0e0"},children:["Fog of War ",!G&&"(Host)"]}),(0,x.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#b0b0b0"},children:Y.fogOfWar?"Limited visibility":"Full map visibility"})]}),(0,x.jsx)("button",{onClick:()=>{if(!G)return;const e=(0,u.KR)(p,"lobbies/".concat(W));(0,u.yo)(e,{fogOfWar:!Y.fogOfWar})},disabled:!G,style:{padding:"12px 20px",fontSize:"16px",fontWeight:"bold",background:Y.fogOfWar?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:Y.fogOfWar?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:G?"pointer":"not-allowed",opacity:G?1:.6,minWidth:"80px",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:Y.fogOfWar?"ON":"OFF"})]})}),(Y.playerCount||2)>=3&&(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsx)("h3",{style:{marginBottom:"8px",fontSize:"17px",color:"#e0e0e0"},children:"Your Team"}),(0,x.jsx)("p",{style:{margin:"0 0 8px 0",fontSize:"12px",color:"#b0b0b0"},children:"Select no team for FFA (free-for-all)"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{onClick:()=>ee(null),style:{flex:1,padding:"10px",fontSize:"14px",fontWeight:"bold",background:null!==(s=Y[V])&&void 0!==s&&s.team?"linear-gradient(145deg, #4a4a4a, #2a2a2a)":"linear-gradient(145deg, #8a8a8a, #6a6a6a)",color:"#e0e0e0",border:null!==(l=Y[V])&&void 0!==l&&l.team?"2px solid #666":"2px solid #aaa",borderRadius:"5px",cursor:"pointer"},children:"FFA"}),(0,x.jsx)("button",{onClick:()=>ee("A"),style:{flex:1,padding:"10px",fontSize:"14px",fontWeight:"bold",background:"A"===(null===(c=Y[V])||void 0===c?void 0:c.team)?"linear-gradient(145deg, #ff69b4, #ff1493)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"A"===(null===(d=Y[V])||void 0===d?void 0:d.team)?"#000":"#e0e0e0",border:"A"===(null===(h=Y[V])||void 0===h?void 0:h.team)?"2px solid #ff69b4":"2px solid #666",borderRadius:"5px",cursor:"pointer"},children:"Team A"}),(0,x.jsx)("button",{onClick:()=>ee("B"),style:{flex:1,padding:"10px",fontSize:"14px",fontWeight:"bold",background:"B"===(null===(f=Y[V])||void 0===f?void 0:f.team)?"linear-gradient(145deg, #333, #111)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#fff",border:"B"===(null===(g=Y[V])||void 0===g?void 0:g.team)?"2px solid #333":"2px solid #666",borderRadius:"5px",cursor:"pointer"},children:"Team B"})]})]}),(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsxs)("h3",{style:{marginBottom:"8px",fontSize:"17px",color:"#e0e0e0"},children:["Players (",te().length,"/",Y.playerCount||2,")"]}),(0,x.jsxs)("div",{style:{fontSize:"14px",display:"flex",flexDirection:"column",gap:"4px"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("span",{style:{color:null!==(m=Y.player1)&&void 0!==m&&m.id?"#27ae60":"#e67e22"},children:null!==(y=Y.player1)&&void 0!==y&&y.id?"\u2713":"\u25cb"}),(0,x.jsx)("span",{style:{color:"#e0e0e0"},children:"P1 (Host)"}),(null===(v=Y.player1)||void 0===v?void 0:v.team)&&(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"A"===Y.player1.team?"#ff69b4":"#333",color:"A"===Y.player1.team?"#000":"#fff"},children:Y.player1.team})]}),(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("span",{style:{color:null!==(b=Y.player2)&&void 0!==b&&b.id?"#27ae60":"#e67e22"},children:null!==(w=Y.player2)&&void 0!==w&&w.id&&null!==(_=Y.player2)&&void 0!==_&&_.ready?"\u2713":"\u25cb"}),(0,x.jsxs)("span",{style:{color:null!==(S=Y.player2)&&void 0!==S&&S.id?"#e0e0e0":"#888"},children:["P2 ",null!==(C=Y.player2)&&void 0!==C&&C.id?null!==(A=Y.player2)&&void 0!==A&&A.ready?"(Ready)":"":"(Waiting...)"]}),(null===(E=Y.player2)||void 0===E?void 0:E.team)&&(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"A"===Y.player2.team?"#ff69b4":"#333",color:"A"===Y.player2.team?"#000":"#fff"},children:Y.player2.team})]}),(Y.playerCount||2)>=3&&(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("span",{style:{color:null!==(T=Y.player3)&&void 0!==T&&T.id?"#27ae60":"#e67e22"},children:null!==(R=Y.player3)&&void 0!==R&&R.id&&null!==(j=Y.player3)&&void 0!==j&&j.ready?"\u2713":"\u25cb"}),(0,x.jsxs)("span",{style:{color:null!==(I=Y.player3)&&void 0!==I&&I.id?"#e0e0e0":"#888"},children:["P3 ",null!==(P=Y.player3)&&void 0!==P&&P.id?null!==(M=Y.player3)&&void 0!==M&&M.ready?"(Ready)":"":"(Waiting...)"]}),(null===(O=Y.player3)||void 0===O?void 0:O.team)&&(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"A"===Y.player3.team?"#ff69b4":"#333",color:"A"===Y.player3.team?"#000":"#fff"},children:Y.player3.team})]}),(Y.playerCount||2)>=4&&(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("span",{style:{color:null!==(N=Y.player4)&&void 0!==N&&N.id?"#27ae60":"#e67e22"},children:null!==(D=Y.player4)&&void 0!==D&&D.id&&null!==(F=Y.player4)&&void 0!==F&&F.ready?"\u2713":"\u25cb"}),(0,x.jsxs)("span",{style:{color:null!==(q=Y.player4)&&void 0!==q&&q.id?"#e0e0e0":"#888"},children:["P4 ",null!==(L=Y.player4)&&void 0!==L&&L.id?null!==(z=Y.player4)&&void 0!==z&&z.ready?"(Ready)":"":"(Waiting...)"]}),(null===(H=Y.player4)||void 0===H?void 0:H.team)&&(0,x.jsx)("span",{style:{padding:"2px 6px",borderRadius:"3px",fontSize:"11px",backgroundColor:"A"===Y.player4.team?"#ff69b4":"#333",color:"A"===Y.player4.team?"#000":"#fff"},children:Y.player4.team})]})]})]})]}),(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"12px"},children:(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #e74c3c"},children:[(0,x.jsx)("h3",{style:{marginBottom:"10px",fontSize:"17px",color:"#e0e0e0"},children:"How to Play"}),(0,x.jsxs)("div",{style:{fontSize:"13px",color:"#b0b0b0",lineHeight:"1.5"},children:[(0,x.jsx)("p",{style:{margin:"0 0 8px 0"},children:"1. Choose your hero"}),(0,x.jsx)("p",{style:{margin:"0 0 8px 0"},children:"2. Wait for opponent to join"}),(0,x.jsxs)("p",{style:{margin:"0 0 8px 0"},children:["3. ",G?"Start the game!":"Wait for host to start"]}),(0,x.jsxs)("p",{style:{margin:"0",marginTop:"12px",padding:"10px",backgroundColor:"rgba(0, 0, 0, 0.3)",borderRadius:"4px",fontSize:"12px"},children:["Share room code ",(0,x.jsx)("strong",{style:{color:"#e0e0e0"},children:W})," with your friend!"]})]})]})})]})}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{onClick:K,style:{flex:1,padding:"12px",fontSize:"16px",fontWeight:"bold",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Back"}),(0,x.jsx)("button",{onClick:G?()=>{if(!G)return;if(!ne())return void alert("Waiting for all players to join!");if(!re())return void alert("Waiting for all players to be ready!");if(!(()=>{var e,t,n,r,o,i,a,s;if(2===(Y.playerCount||2))return!0;const l=[];return null!==(e=Y.player1)&&void 0!==e&&e.id&&null!==(t=Y.player1)&&void 0!==t&&t.team&&l.push(Y.player1.team),null!==(n=Y.player2)&&void 0!==n&&n.id&&null!==(r=Y.player2)&&void 0!==r&&r.team&&l.push(Y.player2.team),null!==(o=Y.player3)&&void 0!==o&&o.id&&null!==(i=Y.player3)&&void 0!==i&&i.team&&l.push(Y.player3.team),null!==(a=Y.player4)&&void 0!==a&&a.id&&null!==(s=Y.player4)&&void 0!==s&&s.team&&l.push(Y.player4.team),0===l.length||(new Set(l).size>=2||0===l.length)})())return void alert("Invalid team configuration! Not all players can be on the same team.");const e=(0,u.KR)(p,"lobbies/".concat(W));(0,u.yo)(e,{gameStarted:!0})}:()=>{const e=(0,u.KR)(p,"lobbies/".concat(W));(0,u.yo)(e,{["".concat(V,"/ready")]:!Y[V].ready})},disabled:G&&(!ne()||!re()),style:{flex:2,padding:"12px",fontSize:"16px",fontWeight:"bold",background:!G||ne()&&re()?"linear-gradient(145deg, #4a4a4a, #2a2a2a)":"linear-gradient(145deg, #3a3a3a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:!G||ne()&&re()?"pointer":"not-allowed",opacity:!G||ne()&&re()?1:.6,boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:G?ne()?re()?"Start Game":"Waiting for players to ready...":"Waiting for players (".concat(te().length,"/").concat(Y.playerCount||2,")..."):null!==(B=Y[V])&&void 0!==B&&B.ready?"Unready":"Ready"})]}),(0,x.jsxs)("div",{style:{marginTop:"6px",padding:"6px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"5px",fontSize:"10px",color:"#ccc",border:"1px solid rgba(192, 192, 192, 0.2)",textAlign:"center"},children:[(0,x.jsx)("strong",{children:"Multiplayer Mode:"})," Share your room code with a friend to play together!"]})]})})};const C=function(e){let{onStartGame:t,onBack:n}=e;const[o,i]=(0,r.useState)("large"),[a,s]=(0,r.useState)(!0),[l,c]=(0,r.useState)("gorlak"),[u,d]=(0,r.useState)("sorlorg"),h={gorlak:"#FF0000",sorlorg:"#00FF00",skrazzit:"#0000FF",thorgrim:"#FFFF00",vexxara:"#000000"},p=["#FF0000","#00FF00","#0000FF","#FFFF00","#000000"],f=()=>{if(l===u){const e=h[l];return p.find(t=>t!==e)||p[0]}return h[u]},g=Object.values(k.HeroQueens);return(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/antwars_background.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"15px",boxSizing:"border-box"},children:(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"12px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxWidth:"1200px",width:"100%",maxHeight:"95vh",display:"flex",flexDirection:"column",border:"2px solid rgba(192, 192, 192, 0.3)",boxSizing:"border-box"},children:[(0,x.jsx)("h1",{style:{textAlign:"center",marginBottom:"4px",fontSize:"22px",color:"#e0e0e0"},children:"Local Game Setup"}),(0,x.jsx)("h3",{style:{textAlign:"center",marginBottom:"10px",color:"#b0b0b0",fontSize:"13px"},children:"Hot Seat (Pass & Play)"}),(0,x.jsx)("div",{style:{flex:1,overflowY:"auto",marginBottom:"10px"},children:(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",marginBottom:"10px"},children:[(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px"},children:(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #3498db"},children:[(0,x.jsxs)("h3",{style:{marginBottom:"6px",fontSize:"15px",display:"flex",alignItems:"center",gap:"6px",color:"#e0e0e0"},children:["Player 1 (South)",(0,x.jsx)("div",{style:{width:"20px",height:"20px",backgroundColor:h[l],border:"2px solid #2c3e50",borderRadius:"50%"},title:"Color: ".concat(h[l])})]}),(0,x.jsxs)("div",{style:{marginTop:"6px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"bold",fontSize:"13px",color:"#e0e0e0"},children:"Choose Your Hero:"}),(0,x.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center"},children:g.map(e=>(0,x.jsxs)("div",{onClick:()=>c(e.id),style:{width:"120px",padding:"6px",border:l===e.id?"3px solid #3498db":"2px solid #95a5a6",borderRadius:"6px",cursor:"pointer",backgroundColor:l===e.id?"rgba(52, 152, 219, 0.2)":"rgba(255, 255, 255, 0.1)",textAlign:"center",transition:"all 0.2s"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/").concat(e.portraitImage),alt:e.name,style:{width:"100%",height:"auto",aspectRatio:"1",marginBottom:"4px",imageRendering:"pixelated"}}),(0,x.jsx)("div",{style:{fontSize:"12px",fontWeight:"bold",marginBottom:"2px",color:"#e0e0e0"},children:e.name}),(0,x.jsx)("div",{style:{fontSize:"10px",color:"#b0b0b0",lineHeight:"1.2"},children:e.description})]},e.id))})]})]})}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px"},children:[(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsx)("h3",{style:{marginBottom:"6px",fontSize:"15px",color:"#e0e0e0"},children:"Map Size"}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:[{name:"Small (7x7)",value:"small"},{name:"Medium (9x9)",value:"medium"},{name:"Large (11x11)",value:"large"}].map(e=>(0,x.jsx)("button",{onClick:()=>i(e.value),style:{padding:"8px",fontSize:"13px",fontWeight:"bold",background:o===e.value?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:o===e.value?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:e.name},e.value))})]}),(0,x.jsx)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{style:{marginBottom:"2px",fontSize:"15px",color:"#e0e0e0"},children:"Fog of War"}),(0,x.jsx)("p",{style:{margin:0,fontSize:"11px",color:"#b0b0b0"},children:a?"Limited visibility":"Full map visibility"})]}),(0,x.jsx)("button",{onClick:()=>s(!a),style:{padding:"8px 16px",fontSize:"14px",fontWeight:"bold",background:a?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:a?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",minWidth:"70px",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:a?"ON":"OFF"})]})})]}),(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px"},children:(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #e74c3c"},children:[(0,x.jsxs)("h3",{style:{marginBottom:"6px",fontSize:"15px",color:"#e0e0e0"},children:["Player 2 (North)",(0,x.jsx)("div",{style:{width:"20px",height:"20px",backgroundColor:f(),border:"2px solid #2c3e50",borderRadius:"50%",display:"inline-block",marginLeft:"8px"},title:"Color: ".concat(f())})]}),(0,x.jsxs)("div",{style:{marginTop:"6px"},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"6px",fontWeight:"bold",fontSize:"13px",color:"#e0e0e0"},children:"Choose Hero:"}),(0,x.jsx)("div",{style:{display:"flex",flexWrap:"wrap",gap:"6px",justifyContent:"center"},children:g.map(e=>(0,x.jsxs)("div",{onClick:()=>d(e.id),style:{width:"120px",padding:"6px",border:u===e.id?"3px solid #e74c3c":"2px solid #95a5a6",borderRadius:"6px",cursor:"pointer",backgroundColor:u===e.id?"rgba(231, 76, 60, 0.2)":"rgba(255, 255, 255, 0.1)",textAlign:"center",transition:"all 0.2s"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/").concat(e.portraitImage),alt:e.name,style:{width:"100%",height:"auto",aspectRatio:"1",marginBottom:"4px",imageRendering:"pixelated"}}),(0,x.jsx)("div",{style:{fontSize:"12px",fontWeight:"bold",marginBottom:"2px",color:"#e0e0e0"},children:e.name}),(0,x.jsx)("div",{style:{fontSize:"10px",color:"#b0b0b0",lineHeight:"1.2"},children:e.description})]},e.id))})]})]})})]})}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{onClick:n,style:{flex:1,padding:"12px",fontSize:"16px",fontWeight:"bold",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Back"}),(0,x.jsx)("button",{onClick:()=>{t({gameId:null,playerId:null,playerRole:"player1",isMultiplayer:!1,fogOfWar:a,mapSize:o,player1Color:h[l],player2Color:f(),player1Hero:l,player2Hero:u})},style:{flex:2,padding:"12px",fontSize:"16px",fontWeight:"bold",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Start Game"})]}),(0,x.jsxs)("div",{style:{marginTop:"6px",padding:"6px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"5px",fontSize:"10px",color:"#ccc",border:"1px solid rgba(192, 192, 192, 0.2)",textAlign:"center"},children:[(0,x.jsx)("strong",{children:"Hot Seat Mode:"})," Take turns playing on the same device. Pass the device to the other player when it's their turn!"]})]})})};function A(e,t){return!(!e||!t)&&(e.q===t.q&&e.r===t.r)}const E={easy:{thinkTime:500,gatherPriority:.7,combatPriority:.3,buildAnthills:!1,upgradeFrequency:.1,unitMix:{scout:.5,drone:.4,soldier:.1}},medium:{thinkTime:300,gatherPriority:.5,combatPriority:.5,buildAnthills:!0,upgradeFrequency:.3,unitMix:{scout:.2,drone:.3,soldier:.3,spitter:.2}},hard:{thinkTime:200,gatherPriority:.4,combatPriority:.6,buildAnthills:!0,upgradeFrequency:.5,unitMix:{scout:.15,drone:.2,soldier:.25,spitter:.2,tank:.1,bomber:.1}}};async function T(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"easy";try{var r,o;const u=E[n];let d=(0,i.A)({},e),h=[],p=[];console.log("AI (".concat(t,", ").concat(n,") starting turn ").concat(d.turn));const f=Object.values(d.ants||{}),g=f.filter(e=>e.owner===t),m=g.find(e=>"queen"===e.type);console.log("AI sees ".concat(f.length," total ants, ").concat(g.length," are mine")),console.log("AI queen:",m?"found at (".concat(m.position.q,", ").concat(m.position.r,")"):"NOT FOUND"),console.log("AI resources:",null===(r=d.players)||void 0===r||null===(o=r[t])||void 0===o?void 0:o.resources),console.log("AI eggs:",Object.values(d.eggs||{}).filter(e=>e.owner===t).length),console.log("=== AI UNIT FLAGS AT START OF TURN ==="),g.forEach(e=>{console.log("".concat(e.id," (").concat(e.type,"): hasMoved=").concat(e.hasMoved,", hasAttacked=").concat(e.hasAttacked,", hasBuilt=").concat(e.hasBuilt))});const y=function(e,t){const n=Object.values(e.ants).filter(e=>e.owner===t),r=Object.values(e.ants).filter(e=>e.owner!==t),o=n.filter(e=>"queen"!==e.type&&"drone"!==e.type&&"healer"!==e.type),i=n.filter(e=>"drone"===e.type),a=Object.values(e.anthills||{}).filter(e=>e.owner===t),s=r.filter(e=>"queen"!==e.type&&"drone"!==e.type&&"healer"!==e.type),l=o.length,u=s.length,d=i.length+2*a.length;let h="early";e.turn>15&&(h="mid"),e.turn>30&&(h="late");let p=!1,f=!0,g=!1;"early"===h?(f=!0,p=l>=2):"mid"===h?(f=i.length<3||a.length<2,p=l>=2):(p=l>=1,f=d<8);const m=n.find(e=>"queen"===e.type);m&&r.filter(e=>(0,c.hexDistance)(e.position,m.position)<=4).length>0&&(g=!0,p=!1);return{phase:h,armyStrength:l,economicPower:d,shouldAttack:p,shouldExpand:f,shouldDefend:g,enemyArmyStrength:u}}(d,t);console.log("AI strategy: ".concat(y.phase,", army strength: ").concat(y.armyStrength,", economic power: ").concat(y.economicPower)),await(s=u.thinkTime,new Promise(e=>setTimeout(e,s))),d=function(e,t){const n=Object.values(e.eggs).filter(e=>e.owner===t&&0===e.turnsRemaining);let r=(0,i.A)({},e);for(const o of n){if(!o.antType){console.warn("Egg missing antType, skipping:",o);continue}const e="ant_ai_".concat(Date.now(),"_").concat(Math.random()),n=(0,l.s1)(o.antType);r.ants[e]={id:e,type:o.antType,owner:t,position:o.position,health:n.maxHealth,hasMoved:!1,hasAttacked:!1,energy:void 0!==n.startingEnergy?n.startingEnergy:n.maxEnergy||0,isBurrowed:!1},delete r.eggs[o.id]}return r}(d,t);const v=function(e,t,n,r){let o=(0,i.A)({},e),a=[],s=[];const l=Object.values(o.ants).filter(e=>e.owner===t&&"queen"!==e.type&&!e.hasMoved);console.log("AI has ".concat(l.length," units that haven't moved yet"));const c=l.filter(e=>"drone"===e.type),u=l.filter(e=>"scout"===e.type),d=l.filter(e=>"drone"!==e.type&&"healer"!==e.type&&"scout"!==e.type),h=l.filter(e=>"healer"===e.type);console.log("Unit breakdown: ".concat(c.length," drones, ").concat(u.length," scouts, ").concat(d.length," combat, ").concat(h.length," healers"));for(const i of c){console.log("Handling drone at (".concat(i.position.q,", ").concat(i.position.r,")"));const e=j(o,i,t,n);o=e.state,e.movement&&a.push(e.movement)}for(const i of u){console.log("Handling scout at (".concat(i.position.q,", ").concat(i.position.r,")"));const e=P(o,i,t,r);o=e.state,e.movement&&a.push(e.movement)}for(const i of d){console.log("Handling ".concat(i.type," at (").concat(i.position.q,", ").concat(i.position.r,")"));const e=I(o,i,t,n,r);o=e.state,e.movement&&a.push(e.movement),e.combatAction&&s.push(e.combatAction)}for(const i of h){console.log("Handling healer at (".concat(i.position.q,", ").concat(i.position.r,")"));const e=M(o,i,t);o=e.state,e.movement&&a.push(e.movement)}return console.log("Unit actions complete"),{state:o,movements:a,combatActions:s}}(d,t,u,y);return d=v.state,h=v.movements,p=v.combatActions||[],d=function(e,t,n,r){let o=(0,i.A)({},e),s=Object.values(o.ants).find(e=>"queen"===e.type&&e.owner===t);if(!s)return console.log("No queen found, skipping queen actions"),o;const u=o.players[t];console.log("Queen actions - checking energy and resources:",{energy:s.energy,resources:u.resources});const d=(0,a.getEggLayCost)(s);console.log("Egg energy cost:",d);const h=(0,a.hasEnoughEnergy)(s,d);console.log("Has enough energy to lay egg?",h);let p=0;for(;(0,a.hasEnoughEnergy)(s,d);){const e=(0,a.getSpawningPoolHexes)(s,c.getNeighbors).filter(e=>!(Object.values(o.ants).some(t=>A(t.position,e))||Object.values(o.eggs).some(t=>A(t.position,e))||Object.values(o.trees||{}).some(t=>A(t.position,e))));if(console.log("Spawning pool has ".concat(e.length," available spots")),0===e.length){console.log("No spawn spots available, breaking");break}console.log("Egg energy cost (rechecking):",d);const h=R(o,t,n,r),f=(0,l.s1)(h).cost;if(console.log("Chosen unit type: ".concat(h,", cost:"),f),u.resources.food<f.food||u.resources.minerals<f.minerals){console.log("Cannot afford unit type, breaking");break}const g=e[0];console.log("Laying egg at position:",g);const m=(0,a.createEgg)(h,t,g,o.turn),y={food:u.resources.food-f.food,minerals:u.resources.minerals-f.minerals},v=(0,i.A)((0,i.A)({},s),{},{energy:s.energy-d});o=(0,i.A)((0,i.A)({},o),{},{eggs:(0,i.A)((0,i.A)({},o.eggs),{},{[m.id]:m}),players:(0,i.A)((0,i.A)({},o.players),{},{[t]:(0,i.A)((0,i.A)({},u),{},{resources:y})}),ants:(0,i.A)((0,i.A)({},o.ants),{},{[s.id]:v})}),s=v,p++,console.log("Successfully laid egg #".concat(p,", queen energy now: ").concat(v.energy))}return console.log("Queen actions complete - laid ".concat(p," eggs")),o}(d,t,u,y),Math.random()<u.upgradeFrequency&&(d=function(e,t){let n=(0,i.A)({},e);n.players[t];const r=["meleeAttack","defense","rangedAttack","cannibalism"];for(const o of r){if((0,a.canAffordUpgrade)(n,t,o).canAfford){const e=(0,a.purchaseUpgrade)(n,t,o);if(e.success)return console.log("AI purchased upgrade: ".concat(o)),e.gameState}}return n}(d,t)),console.log("AI (".concat(t,") ending turn with ").concat(h.length," movements and ").concat(p.length," combat actions")),{gameState:d,movements:h,combatActions:p}}catch(u){return console.error("AI turn error:",u),console.error("Error stack:",u.stack),{gameState:e,movements:[],combatActions:[]}}var s}function R(e,t,n,r){const o=e.players[t].resources,i={};Object.values(e.ants).forEach(e=>{e.owner===t&&"queen"!==e.type&&(i[e.type]=(i[e.type]||0)+1)});const a=i.drone||0;if(0===(i.scout||0)&&l.xr.SCOUT&&o.food>=l.xr.SCOUT.cost.food&&o.minerals>=l.xr.SCOUT.cost.minerals)return console.log("Building first scout for vision"),"scout";if(r.shouldExpand&&a<4&&o.food>=l.xr.DRONE.cost.food&&o.minerals>=l.xr.DRONE.cost.minerals)return console.log("Expansion: building drone"),"drone";if(r.shouldDefend||r.shouldAttack){console.log("Combat mode: prioritizing combat units");const e={};for(const[r,o]of Object.entries(n.unitMix))"drone"!==r&&"scout"!==r&&(e[r]=2*o);const t=Object.entries(e).filter(e=>{let[t]=e;const n=(0,l.s1)(t);return!!n&&(o.food>=n.cost.food&&o.minerals>=n.cost.minerals)});if(t.length>0){const e=t.reduce((e,t)=>{let[n,r]=t;return e+r},0);let n=Math.random()*e;for(const[r,o]of t)if(n-=o,n<=0)return r}}const s=Object.entries(n.unitMix).filter(e=>{let[t]=e;const n=(0,l.s1)(t);return!!n&&(o.food>=n.cost.food&&o.minerals>=n.cost.minerals)});if(0===s.length)return"scout";const c=s.reduce((e,t)=>{let[n,r]=t;return e+r},0);let u=Math.random()*c;for(const[l,d]of s)if(u-=d,u<=0)return l;return s[0][0]}function j(e,t,n,r){let o=(0,i.A)({},e);console.log("Drone ".concat(t.id,": checking position (").concat(t.position.q,", ").concat(t.position.r,")"));const s=Object.values(o.resources).find(e=>e.position.q===t.position.q&&e.position.r===t.position.r);if(s){console.log("Drone is on ".concat(s.type," resource"));const e=Object.values(o.anthills||{}).find(e=>e.position.q===t.position.q&&e.position.r===t.position.r&&e.owner===n);if(r.buildAnthills&&"minerals"===s.type)if(e&&!e.isComplete){console.log("Continuing to build incomplete anthill (progress: ".concat(e.buildProgress,")"));const n=Object.keys(o.resources).find(e=>o.resources[e].position.q===s.position.q&&o.resources[e].position.r===s.position.r);if(n){const e=(0,a.buildAnthill)(o,t.id,n);return console.log("AI drone continuing anthill construction at (".concat(s.position.q,", ").concat(s.position.r,")")),{state:e,movement:null}}}else if(!e){console.log("Attempting to build anthill at mineral node");const e=Object.keys(o.resources).find(e=>o.resources[e].position.q===s.position.q&&o.resources[e].position.r===s.position.r);if(e){const n=(0,a.buildAnthill)(o,t.id,e);if(Object.keys(n.anthills||{}).length>Object.keys(o.anthills||{}).length)return console.log("AI drone building anthill at mineral node (".concat(s.position.q,", ").concat(s.position.r,")")),{state:n,movement:null};console.log("Failed to build anthill - drone may have already built this turn")}}const c=l.xr.DRONE.resourceGatherRate||5,u=o.players[n];return"food"===s.type?(o.players[n]=(0,i.A)((0,i.A)({},u),{},{resources:(0,i.A)((0,i.A)({},u.resources),{},{food:u.resources.food+c})}),console.log("Drone gathered ".concat(c," food, now have ").concat(o.players[n].resources.food))):"minerals"===s.type&&(o.players[n]=(0,i.A)((0,i.A)({},u),{},{resources:(0,i.A)((0,i.A)({},u.resources),{},{minerals:u.resources.minerals+c})}),console.log("Drone gathered ".concat(c," minerals, now have ").concat(o.players[n].resources.minerals))),o.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0}),{state:o,movement:null}}const u=function(e,t){const n=Object.values(e.resources).filter(e=>"minerals"===e.type);return 0===n.length?null:n.reduce((e,n)=>(0,c.hexDistance)(t,n.position)<(0,c.hexDistance)(t,e.position)?n:e)}(o,t.position)||function(e,t){const n=Object.values(e.resources);return 0===n.length?null:n.reduce((e,n)=>(0,c.hexDistance)(t,n.position)<(0,c.hexDistance)(t,e.position)?n:e)}(o,t.position);return u?(console.log("Drone moving toward resource at (".concat(u.position.q,", ").concat(u.position.r,")")),N(o,t,u.position)):(console.log("Drone found no target resource"),{state:o,movement:null})}function I(e,t,r,o,a){let s=(0,i.A)({},e);const l=O(s,t,r);if(l.length>0){let e=l.find(e=>"queen"===e.type)||l.reduce((e,t)=>t.health<e.health?t:e);const{canAttack:r,resolveCombat:o}=n(867);if(r(t,e,s)){const n=o(s,t.id,e.id);s=n.gameState;const r=(0,i.A)({},s.ants);r[t.id]&&(r[t.id]=(0,i.A)((0,i.A)({},r[t.id]),{},{hasAttacked:!0}));const a=n.attackAnimation?(0,i.A)((0,i.A)({},n.attackAnimation),{},{damageDealt:n.damageDealt,timestamp:Date.now()}):null;return s=(0,i.A)((0,i.A)({},s),{},{ants:r,lastCombatAction:a}),{state:s,movement:null,combatAction:a}}}const u=Object.values(s.ants).find(e=>"queen"===e.type&&e.owner===r),d=Object.values(s.ants).filter(e=>e.owner!==r),h=d.length>0?d.reduce((e,n)=>(0,c.hexDistance)(t.position,n.position)<(0,c.hexDistance)(t.position,e.position)?n:e):null;if(a.shouldDefend&&u){if((0,c.hexDistance)(t.position,u.position)>3)return N(s,t,u.position);if(h)return N(s,t,h.position);s.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0})}else{if(!a.shouldAttack&&!h)return N(s,t,{q:0,r:0});{const e=d.find(e=>"queen"===e.type)||h;if(e)return N(s,t,e.position);s.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0})}}return{state:s,movement:null}}function P(e,t,r,o){let a=(0,i.A)({},e);const s=O(a,t,r);if(s.length>0){const e=s[0],{canAttack:r,resolveCombat:o}=n(867);if(r(t,e,a)){return a=o(a,t.id,e.id).gameState,a.ants[t.id]=(0,i.A)((0,i.A)({},a.ants[t.id]),{},{hasAttacked:!0}),{state:a,movement:null}}}const l=Object.values(a.ants).find(e=>"queen"===e.type&&e.owner!==r);return N(a,t,l?l.position:{q:0,r:0})}function M(e,t,n){let r=(0,i.A)({},e);const o=Object.values(r.ants).filter(e=>e.owner===n&&e.health<(0,l.s1)(e.type).maxHealth&&(0,c.hexDistance)(t.position,e.position)<=1);if(o.length>0){o.reduce((e,t)=>t.health<e.health?t:e);return r.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0}),{state:r,movement:null}}const a=Object.values(r.ants).filter(e=>e.owner===n&&"queen"!==e.type&&"drone"!==e.type&&"healer"!==e.type);if(a.length>0){const e=a[0];return N(r,t,e.position)}return{state:r,movement:null}}function O(e,t,n){const r=(0,l.s1)(t.type).attackRange;return Object.values(e.ants).filter(e=>{if(e.owner===n)return!1;if(e.isBurrowed)return!1;return(0,c.hexDistance)(t.position,e.position)<=r})}function N(e,t,n){let r=(0,i.A)({},e);if(console.log("moveUnitToward: ".concat(t.id," from (").concat(t.position.q,", ").concat(t.position.r,") toward (").concat(n.q,", ").concat(n.r,")")),t.ensnared&&t.ensnared>0)return console.log("Unit ".concat(t.id," is ensnared (").concat(t.ensnared," turns remaining), cannot move")),r.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0}),{state:r,movement:null};const o=(0,l.s1)(t.type),a=r.gridRadius||6,u=[...Object.values(r.ants).filter(e=>e.id!==t.id).map(e=>new c.HexCoord(e.position.q,e.position.r)),...Object.values(r.eggs||{}).map(e=>new c.HexCoord(e.position.q,e.position.r)),...Object.values(r.trees||{}).map(e=>new c.HexCoord(e.position.q,e.position.r))],d=new c.HexCoord(t.position.q,t.position.r),h=(0,c.getMovementRangeWithPaths)(d,o.moveRange,a,u);if(console.log("Move range has ".concat(h.length," hexes with valid paths")),0===h.length)return console.log("No valid moves, marking as moved"),r.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0}),{state:r,movement:null};const p=h.reduce((e,t)=>(0,c.hexDistance)(t.hex,n)<(0,c.hexDistance)(e.hex,n)?t:e);console.log("Best move: (".concat(p.hex.q,", ").concat(p.hex.r,")"));const f=(0,s.moveAnt)(r,t.id,p.hex);return!f.ants[t.id]||f.ants[t.id].position.q===t.position.q&&f.ants[t.id].position.r===t.position.r?(console.log("Move failed, marking as moved"),r.ants[t.id]=(0,i.A)((0,i.A)({},t),{},{hasMoved:!0}),{state:r,movement:null}):(console.log("Unit moved successfully to (".concat(f.ants[t.id].position.q,", ").concat(f.ants[t.id].position.r,")")),{state:f,movement:{antId:t.id,path:p.path}})}const D="easy",F="medium",q="hard";const L=function(e){let{onStartGame:t,onBack:n}=e;const[o,i]=(0,r.useState)("large"),[a,s]=(0,r.useState)(D),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)("gorlak"),[h,p]=(0,r.useState)("sorlorg"),f={gorlak:"#FF0000",sorlorg:"#00FF00",skrazzit:"#0000FF",thorgrim:"#FFFF00",vexxara:"#000000"},g=["#FF0000","#00FF00","#0000FF","#FFFF00","#000000"],m=()=>{if(u===h){const e=f[u];return g.find(t=>t!==e)||g[0]}return f[h]},y=Object.values(k.HeroQueens),v=[{name:"Easy",value:D,description:"Beginner-friendly, focuses on gathering"},{name:"Medium",value:F,description:"Balanced strategy and combat"},{name:"Hard",value:q,description:"Aggressive and strategic"}];return(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/ai_lobby.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"15px",boxSizing:"border-box"},children:(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.6)",padding:"20px",borderRadius:"10px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxWidth:"1400px",width:"100%",maxHeight:"95vh",display:"flex",flexDirection:"column",border:"2px solid rgba(192, 192, 192, 0.3)",boxSizing:"border-box"},children:[(0,x.jsx)("h1",{style:{textAlign:"center",marginBottom:"4px",fontSize:"22px",color:"#e0e0e0"},children:"VS AI Setup"}),(0,x.jsx)("h3",{style:{textAlign:"center",marginBottom:"10px",color:"#b0b0b0",fontSize:"13px"},children:"Single Player"}),(0,x.jsx)("div",{style:{flex:1,marginBottom:"10px",display:"flex",flexDirection:"column",minHeight:0},children:(0,x.jsxs)("div",{style:{display:"flex",gap:"12px",flex:1,minHeight:0},children:[(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"10px",minHeight:0},children:(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #3498db",display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsxs)("h3",{style:{marginBottom:"6px",fontSize:"15px",display:"flex",alignItems:"center",gap:"6px",color:"#e0e0e0"},children:["You (South)",(0,x.jsx)("div",{style:{width:"20px",height:"20px",backgroundColor:f[u],border:"2px solid #2c3e50",borderRadius:"50%"},title:"Color: ".concat(f[u])})]}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",fontSize:"15px",color:"#e0e0e0"},children:"Choose Your Hero:"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"10px",flex:1,alignContent:"start"},children:y.map(e=>(0,x.jsxs)("div",{onClick:()=>d(e.id),style:{padding:"8px",border:u===e.id?"3px solid #3498db":"2px solid #95a5a6",borderRadius:"8px",cursor:"pointer",backgroundColor:u===e.id?"rgba(52, 152, 219, 0.2)":"rgba(255, 255, 255, 0.1)",textAlign:"center",transition:"all 0.2s"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/").concat(e.portraitImage),alt:e.name,style:{width:"100%",height:"auto",aspectRatio:"1",marginBottom:"6px",imageRendering:"pixelated"}}),(0,x.jsx)("div",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"3px",color:"#e0e0e0"},children:e.name}),(0,x.jsx)("div",{style:{fontSize:"11px",color:"#b0b0b0",lineHeight:"1.3"},children:e.description})]},e.id))})]})]})}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"12px"},children:[(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsx)("h3",{style:{marginBottom:"10px",fontSize:"17px",color:"#e0e0e0"},children:"Map Size"}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[{name:"Small (7x7)",value:"small"},{name:"Medium (9x9)",value:"medium"},{name:"Large (11x11)",value:"large"}].map(e=>(0,x.jsx)("button",{onClick:()=>i(e.value),style:{padding:"12px",fontSize:"15px",fontWeight:"bold",background:o===e.value?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:o===e.value?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:e.name},e.value))})]}),(0,x.jsx)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("h3",{style:{marginBottom:"4px",fontSize:"17px",color:"#e0e0e0"},children:"Fog of War"}),(0,x.jsx)("p",{style:{margin:0,fontSize:"13px",color:"#b0b0b0"},children:l?"Limited visibility":"Full map visibility"})]}),(0,x.jsx)("button",{onClick:()=>c(!l),style:{padding:"12px 20px",fontSize:"16px",fontWeight:"bold",background:l?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:l?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",minWidth:"80px",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:l?"ON":"OFF"})]})}),(0,x.jsxs)("div",{style:{padding:"12px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px"},children:[(0,x.jsx)("h3",{style:{marginBottom:"10px",fontSize:"17px",color:"#e0e0e0"},children:"AI Difficulty"}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:v.map(e=>(0,x.jsxs)("button",{onClick:()=>s(e.value),style:{padding:"12px",fontSize:"16px",fontWeight:"bold",background:a===e.value?"linear-gradient(145deg, #8a8a8a, #6a6a6a)":"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:a===e.value?"2px solid #aaa":"2px solid #666",borderRadius:"5px",cursor:"pointer",textAlign:"left",display:"flex",flexDirection:"column",gap:"4px",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:[(0,x.jsx)("span",{style:{fontSize:"18px"},children:e.name}),(0,x.jsx)("span",{style:{fontSize:"13px",opacity:.8,fontWeight:"normal"},children:e.description})]},e.value))})]})]}),(0,x.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"8px",minHeight:0},children:(0,x.jsxs)("div",{style:{padding:"8px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"8px",border:"3px solid #e74c3c",display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsxs)("h3",{style:{marginBottom:"6px",fontSize:"15px",display:"flex",alignItems:"center",gap:"6px",color:"#e0e0e0"},children:["AI (North)",(0,x.jsx)("div",{style:{width:"20px",height:"20px",backgroundColor:m(),border:"2px solid #2c3e50",borderRadius:"50%"},title:"Color: ".concat(m())})]}),(0,x.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[(0,x.jsx)("label",{style:{display:"block",marginBottom:"8px",fontWeight:"bold",fontSize:"15px",color:"#e0e0e0"},children:"Choose AI Hero:"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"10px",flex:1,alignContent:"start"},children:y.map(e=>(0,x.jsxs)("div",{onClick:()=>p(e.id),style:{padding:"8px",border:h===e.id?"3px solid #e74c3c":"2px solid #95a5a6",borderRadius:"8px",cursor:"pointer",backgroundColor:h===e.id?"rgba(231, 76, 60, 0.2)":"rgba(255, 255, 255, 0.1)",textAlign:"center",transition:"all 0.2s"},children:[(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/").concat(e.portraitImage),alt:e.name,style:{width:"100%",height:"auto",aspectRatio:"1",marginBottom:"6px",imageRendering:"pixelated"}}),(0,x.jsx)("div",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"3px",color:"#e0e0e0"},children:e.name}),(0,x.jsx)("div",{style:{fontSize:"11px",color:"#b0b0b0",lineHeight:"1.3"},children:e.description})]},e.id))})]})]})})]})}),(0,x.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,x.jsx)("button",{onClick:n,style:{flex:1,padding:"12px",fontSize:"16px",fontWeight:"bold",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Back"}),(0,x.jsx)("button",{onClick:()=>{t({gameId:null,playerId:null,playerRole:"player1",isMultiplayer:!1,isAI:!0,aiDifficulty:a,fogOfWar:l,mapSize:o,player1Color:f[u],player2Color:m(),player1Hero:u,player2Hero:h})},style:{flex:2,padding:"12px",fontSize:"16px",fontWeight:"bold",background:"linear-gradient(145deg, #4a4a4a, #2a2a2a)",color:"#e0e0e0",border:"2px solid #666",borderRadius:"5px",cursor:"pointer",boxShadow:"0 4px 6px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.1)",transition:"all 0.2s"},children:"Start Game"})]}),(0,x.jsxs)("div",{style:{marginTop:"6px",padding:"6px",backgroundColor:"rgba(0, 0, 0, 0.4)",borderRadius:"5px",fontSize:"10px",color:"#ccc",border:"1px solid rgba(192, 192, 192, 0.2)",textAlign:"center"},children:[(0,x.jsx)("strong",{children:"AI Mode:"})," Test your skills against a computer opponent. Choose your difficulty and dominate the battlefield!"]})]})})};const z=function(e){var t,n,r,o,i;let{gameState:a,onReturnToMenu:s}=e;if(!a||!a.stats)return null;const l=a.stats.player1,c=a.stats.player2,u=a.armyStrengthHistory||{player1:[],player2:[]},d=a.winner,h=(null===(t=a.players[d])||void 0===t?void 0:t.name)||"Player ".concat("player1"===d?"1":"2"),p=40,f=520,g=140,m=Math.max(u.player1.length,u.player2.length),y=Math.max(...u.player1,...u.player2,1),v=(e,t)=>{if(0===e.length)return null;const n=e.map((e,t)=>{const n=p+t/Math.max(m-1,1)*f,r=180-e/y*g;return"".concat(n,",").concat(r)});return(0,x.jsx)("polyline",{points:n.join(" "),fill:"none",stroke:t,strokeWidth:"3",strokeLinejoin:"round"})},b=e=>Object.values(e).reduce((e,t)=>e+t,0);return(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",backgroundImage:"url(".concat("/Battle-Ants","/sprites/antwars_background.png)"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",padding:"15px",boxSizing:"border-box",overflow:"hidden"},children:(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.85)",padding:"20px",borderRadius:"15px",boxShadow:"0 8px 20px rgba(0,0,0,0.5)",maxWidth:"1100px",width:"100%",border:"3px solid rgba(192, 192, 192, 0.4)",maxHeight:"95vh",display:"flex",flexDirection:"column"},children:[(0,x.jsx)("h1",{style:{textAlign:"center",marginTop:0,marginBottom:"5px",fontSize:"28px",color:"#e0e0e0"},children:"Game Summary"}),(0,x.jsxs)("h2",{style:{textAlign:"center",marginTop:0,marginBottom:"15px",fontSize:"20px",color:"player1"===d?"#4CAF50":"#f44336"},children:[h," Wins!"]}),(0,x.jsxs)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"10px",padding:"15px",marginBottom:"15px",flex:"0 0 auto"},children:[(0,x.jsx)("h3",{style:{textAlign:"center",marginTop:0,marginBottom:"10px",color:"#333",fontSize:"18px"},children:"Army Strength Over Time"}),(0,x.jsxs)("svg",{width:600,height:220,style:{display:"block",margin:"0 auto"},children:[(0,x.jsx)("rect",{x:p,y:p,width:f,height:g,fill:"#f5f5f5",stroke:"#ccc",strokeWidth:"1"}),[0,.25,.5,.75,1].map((e,t)=>{const n=180-e*g;return(0,x.jsxs)("g",{children:[(0,x.jsx)("line",{x1:p,y1:n,x2:560,y2:n,stroke:"#ddd",strokeWidth:"1"}),(0,x.jsx)("text",{x:35,y:n+4,textAnchor:"end",fontSize:"12",fill:"#666",children:Math.round(y*e)})]},"grid-".concat(t))}),m>0&&[0,Math.floor(m/2),m-1].map((e,t)=>{const n=p+e/Math.max(m-1,1)*f;return(0,x.jsxs)("text",{x:n,y:205,textAnchor:"middle",fontSize:"12",fill:"#666",children:["Turn ",e+1]},"x-label-".concat(t))}),v(u.player1,"#2196F3"),v(u.player2,"#f44336"),(0,x.jsxs)("g",{transform:"translate(".concat(50,", ").concat(50,")"),children:[(0,x.jsx)("rect",{x:"0",y:"0",width:"15",height:"15",fill:"#2196F3"}),(0,x.jsx)("text",{x:"20",y:"12",fontSize:"14",fill:"#333",children:(null===(n=a.players.player1)||void 0===n?void 0:n.name)||"Player 1"}),(0,x.jsx)("rect",{x:"0",y:"25",width:"15",height:"15",fill:"#f44336"}),(0,x.jsx)("text",{x:"20",y:"37",fontSize:"14",fill:"#333",children:(null===(r=a.players.player2)||void 0===r?void 0:r.name)||"Player 2"})]})]})]}),(0,x.jsxs)("div",{style:{display:"flex",gap:"15px",marginBottom:"15px",flex:"1 1 auto",minHeight:0},children:[(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("h3",{style:{textAlign:"center",marginTop:0,marginBottom:"8px",fontSize:"16px",color:"#2196F3",backgroundColor:"rgba(33, 150, 243, 0.2)",padding:"6px",borderRadius:"8px"},children:(null===(o=a.players.player1)||void 0===o?void 0:o.name)||"Player 1"}),(0,x.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"10px",border:"2px solid rgba(33, 150, 243, 0.4)"},children:(0,x.jsx)("table",{style:{width:"100%",borderCollapse:"collapse"},children:(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Damage Dealt"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.damageDealt})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Damage Received"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.damageReceived})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Hatched"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:b(l.antsHatched)})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Killed"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.antsKilled})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Lost"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.antsLost})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Food Mined"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.foodMined})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Minerals Mined"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:l.mineralsMined})]})]})})})]}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)("h3",{style:{textAlign:"center",marginTop:0,marginBottom:"8px",fontSize:"16px",color:"#f44336",backgroundColor:"rgba(244, 67, 54, 0.2)",padding:"6px",borderRadius:"8px"},children:(null===(i=a.players.player2)||void 0===i?void 0:i.name)||"Player 2"}),(0,x.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"10px",border:"2px solid rgba(244, 67, 54, 0.4)"},children:(0,x.jsx)("table",{style:{width:"100%",borderCollapse:"collapse"},children:(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Damage Dealt"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.damageDealt})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Damage Received"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.damageReceived})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Hatched"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:b(c.antsHatched)})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Killed"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.antsKilled})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Ants Lost"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.antsLost})]}),(0,x.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.2)"},children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Food Mined"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.foodMined})]}),(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",fontWeight:"bold",fontSize:"14px"},children:"Minerals Mined"}),(0,x.jsx)("td",{style:{padding:"5px",color:"#e0e0e0",textAlign:"right",fontSize:"14px"},children:c.mineralsMined})]})]})})})]})]}),(0,x.jsx)("div",{style:{textAlign:"center",flex:"0 0 auto"},children:(0,x.jsx)("button",{onClick:s,style:{padding:"10px 40px",fontSize:"16px",fontWeight:"bold",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 10px rgba(0,0,0,0.4)",transition:"all 0.2s"},onMouseOver:e=>{e.target.style.backgroundColor="#1976D2",e.target.style.boxShadow="0 6px 15px rgba(0,0,0,0.5)"},onMouseOut:e=>{e.target.style.backgroundColor="#2196F3",e.target.style.boxShadow="0 4px 10px rgba(0,0,0,0.4)"},children:"Return to Main Menu"})})]})})},H=n.p+"static/media/forestfloor.d929d519eef06e201a76.png",B={SPRITE_SIZE:32,ANIMATION_SPEEDS:{idle:300,walk:180,attack:120,death:180},SPRITES:{queen:{idle:{path:"queen_idle.png",frames:8},walk:{path:"queen_walk.png",frames:8},attack:{path:"queen_attack.png",frames:8}},scout:{idle:{path:"scout_idle_green.png",frames:10},walk:{path:"scout_walk.png",frames:8},attack:{path:"scout_attack.png",frames:8}},soldier:{idle:{path:"soldier_idle.png",frames:8},walk:{path:"soldier_walk.png",frames:8},attack:{path:"soldier_attack.png",frames:8}},tank:{idle:{path:"tank_idle.png",frames:8},walk:{path:"tank_walk.png",frames:8},attack:{path:"tank_attack.png",frames:8}},spitter:{idle:{path:"spitter_idle.png",frames:8},walk:{path:"spitter_walk.png",frames:8},attack:{path:"spitter_attack.png",frames:8}},bomber:{idle:{path:"bomber_idle.png",frames:10},walk:{path:"bomber_walk.png",frames:10},attack:{path:"bomber_attack.png",frames:10}},bombardier:{idle:{path:"bombardier_idle.png",frames:8},walk:{path:"bombardier_walk.png",frames:8},attack:{path:"bombardier_attack.png",frames:8}},drone:{idle:{path:"drone_idle.png",frames:8},walk:{path:"drone_walk.png",frames:8},attack:{path:"drone_attack.png",frames:8}},healer:{idle:{path:"healer_idle.png",frames:8},walk:{path:"healer_walk.png",frames:8},attack:{path:"healer_attack.png",frames:8}},cordyphage:{idle:{path:"cordyphage_idle.png",frames:8},walk:{path:"cordyphage_walk.png",frames:8},attack:{path:"cordyphage_attack.png",frames:8}},dead:{idle:{path:"dead_ant.png",frames:1},walk:{path:"dead_ant.png",frames:1},attack:{path:"dead_ant.png",frames:1}},egg:{idle:{path:"egg_idle.png",frames:8}}}},W={"#FF0000":"red","#0000FF":"blue","#00FF00":"green","#FFFF00":"yellow","#000000":"black"},U=["queen","scout","drone","soldier","tank","spitter","healer","bomber","bombardier","cordyphage","egg"],V={queen:"queen",scout:"scout",drone:"drone",soldier:"marauder",tank:"bullet",spitter:"acid",healer:"weaver",bomber:"exploding",bombardier:"bombardier",cordyphage:"cordyphage",egg:"egg"},G={queen:"Queen",scout:"Scout",drone:"Drone",soldier:"Marauder",tank:"Bullet",spitter:"Acid",healer:"Weaver",bomber:"Exploding",bombardier:"Bombardier",cordyphage:"Cordyceps",egg:"Eggs"};function Q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=B.SPRITES[e];if(!r||!r[t])return null;let o=r[t].path,a=r[t].frames;const s=G[e]||"";if(n&&U.includes(e)){const t=W[n];if(t){o="".concat(V[e]||e,"_idle_").concat(t,".png"),a="scout"===e?10:8}}const l=s?"".concat("/Battle-Ants","/sprites/ants/").concat(s,"/").concat(o):"".concat("/Battle-Ants","/sprites/ants/").concat(o);return(0,i.A)((0,i.A)({},r[t]),{},{frames:a,path:o,fullPath:l,frameWidth:B.SPRITE_SIZE,frameHeight:B.SPRITE_SIZE,animationSpeed:B.ANIMATION_SPEEDS[t]||100})}const K=function(){var e,t,o,u,d,h,p,f,v,k,A,E,R,j,I,P,M,O,N,D,F,q,B,W,U,V,G,K,Y,$;const[Z,X]=(0,r.useState)(null),[J,ee]=(0,r.useState)(null),[te,ne]=(0,r.useState)(()=>(0,a.createInitialGameState)()),[re,oe]=(0,r.useState)(null),[ie,ae]=(0,r.useState)(!1),[se,le]=(0,r.useState)(!1),[ce,ue]=(0,r.useState)(null),[de,he]=(0,r.useState)(null),[pe,fe]=(0,r.useState)(null),[ge,me]=(0,r.useState)({antId:null,time:0}),[ye,ve]=(0,r.useState)({antId:null,time:0}),[be,xe]=(0,r.useState)(!1),[we,_e]=(0,r.useState)(new Map),[ke,Se]=(0,r.useState)(null),[Ce,Ae]=(0,r.useState)(null),[Ee,Te]=(0,r.useState)(!1),[Re,je]=(0,r.useState)(null),[Ie,Pe]=(0,r.useState)(null),[Me,Oe]=(0,r.useState)(null),[Ne,De]=(0,r.useState)(""),[Fe,qe]=(0,r.useState)([]),[Le,ze]=(0,r.useState)([]),[He,Be]=(0,r.useState)([]),[We,Ue]=(0,r.useState)([]),[Ve,Ge]=(0,r.useState)([]),[Qe,Ke]=(0,r.useState)(!1),[Ye,$e]=(0,r.useState)(!1),[Ze,Xe]=(0,r.useState)(!1),[Je,et]=(0,r.useState)([]),[tt,nt]=(0,r.useState)(!1),[rt,ot]=(0,r.useState)(!1),[it,at]=(0,r.useState)(null),[st,lt]=(0,r.useState)([]),[ct,ut]=(0,r.useState)(null),[dt,ht]=(0,r.useState)(0),[pt,ft]=(0,r.useState)(null),[gt,mt]=(0,r.useState)(!1),[yt,vt]=(0,r.useState)(0),[bt,xt]=(0,r.useState)(!1),[wt,_t]=(0,r.useState)([]),[kt,St]=(0,r.useState)({width:window.innerWidth,height:window.innerHeight}),[Ct]=(0,r.useState)(()=>{const e=["#8B7355","#A0826D","#9C8B6B","#6B8E23","#8FBC8F","#90A955","#7D8471","#8E8268","#9B9B7A","#87986A"],t=e=>{const t=1e4*Math.sin(e);return t-Math.floor(t)},n=new Map;for(let r=-20;r<=20;r++)for(let o=-20;o<=20;o++){const i=t(7919*r+7907*o+7901*(-r-o)),a=Math.floor(i*e.length);n.set("".concat(r,",").concat(o),e[a])}return n}),{setAntAnimation:At,removeAntAnimation:Et,getAntFrame:Tt,setEggAnimation:Rt,removeEggAnimation:jt,getEggFrame:It}=function(){const[e,t]=(0,r.useState)({}),n=(0,r.useRef)();return(0,r.useEffect)(()=>{const e=()=>{const r=Date.now();t(e=>{const t=(0,i.A)({},e);let n=!1;return Object.keys(t).forEach(e=>{const o=t[e];if(!o)return;const a=Q(o.antType,o.animation,o.playerColor);if(a&&r-(o.timestamp||r)>=a.animationSpeed){const s=(o.frame+1)%a.frames;t[e]=(0,i.A)((0,i.A)({},o),{},{frame:s,timestamp:r}),n=!0}}),n?t:e}),n.current=requestAnimationFrame(e)};return n.current=requestAnimationFrame(e),()=>{n.current&&cancelAnimationFrame(n.current)}},[]),{setAntAnimation:function(e,n,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;t(t=>(0,i.A)((0,i.A)({},t),{},{[e]:{antType:n,animation:r,playerColor:o,frame:0,timestamp:Date.now()}}))},removeAntAnimation:e=>{t(t=>{const n=(0,i.A)({},t);return delete n[e],n})},getAntFrame:function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"idle",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=e[t],s=(null===a||void 0===a?void 0:a.animation)||r,l=(null===a||void 0===a?void 0:a.frame)||0,c=Q(n,s,o||(null===a||void 0===a?void 0:a.playerColor));return c?(0,i.A)((0,i.A)({},c),{},{currentFrame:l,animation:s}):null},setEggAnimation:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t(t=>(0,i.A)((0,i.A)({},t),{},{[e]:{antType:"egg",animation:"idle",playerColor:n,frame:0,timestamp:Date.now()}}))},removeEggAnimation:e=>{t(t=>{const n=(0,i.A)({},t);return delete n[e],n})},getEggFrame:function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=e[t],o=(null===r||void 0===r?void 0:r.frame)||0,a=Q("egg","idle",n||(null===r||void 0===r?void 0:r.playerColor));return a?(0,i.A)((0,i.A)({},a),{},{currentFrame:o,animation:"idle"}):null}}}(),Pt=(0,r.useRef)(null),Mt=(0,r.useRef)({});(0,r.useEffect)(()=>{Object.values(te.ants).forEach(e=>{var t;const n=null===(t=te.players[e.owner])||void 0===t?void 0:t.color;At(e.id,e.type,"idle",n)})},[null===(e=te.players)||void 0===e||null===(t=e.player1)||void 0===t?void 0:t.color,null===(o=te.players)||void 0===o||null===(u=o.player2)||void 0===u?void 0:u.color]),(0,r.useEffect)(()=>{if(ce&&Z){te.ants[ce]||(console.log("Clearing stale selection: ant no longer exists",{selectedAnt:ce}),ue(null),he(null))}},[te.ants,ce,Z]),(0,r.useEffect)(()=>{Object.values(te.eggs||{}).forEach(e=>{var t;const n=null===(t=te.players[e.owner])||void 0===t?void 0:t.color;Rt(e.id,n)})},[te.eggs,null===(d=te.players)||void 0===d||null===(h=d.player1)||void 0===h?void 0:h.color,null===(p=te.players)||void 0===p||null===(f=p.player2)||void 0===f?void 0:f.color]),(0,r.useEffect)(()=>{const e=e=>{"Shift"===e.key&&"bombardier_splash"===de&&pt&&(e.preventDefault(),ht(e=>(e+1)%6))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[de,pt]),(0,r.useEffect)(()=>{const e=setInterval(()=>{vt(e=>(e+1)%8)},100);return()=>clearInterval(e)},[]),(0,r.useEffect)(()=>{if(0===wt.length)return;const e=setInterval(()=>{_t(e=>e.map(e=>{const t=e.currentStep+1;return t>=18?null:(0,i.A)((0,i.A)({},e),{},{currentStep:t})}).filter(e=>null!==e))},200);return()=>clearInterval(e)},[wt]);const[Ot,Nt]=(0,r.useState)({x:0,y:0}),[Dt,Ft]=(0,r.useState)(1),[qt,Lt]=(0,r.useState)(!1),[zt,Ht]=(0,r.useState)({x:0,y:0}),[Bt,Wt]=(0,r.useState)(!1),Ut=50,Vt=te.gridRadius||6,Gt=te.mapShape||"rectangle",Qt=(e,t)=>!(!e||!t)&&(e.q===t.q&&e.r===t.r),Kt=e=>[{q:1,r:-1},{q:1,r:0},{q:0,r:1},{q:-1,r:1},{q:-1,r:0},{q:0,r:-1}].map(t=>new c.HexCoord(e.q+t.q,e.r+t.r)),Yt=(e,t)=>{const n=[{q:1,r:0},{q:1,r:-1},{q:0,r:-1},{q:-1,r:0},{q:-1,r:1},{q:0,r:1}],r=n[t%6],o=n[(t+5)%6];return[e,new c.HexCoord(e.q+r.q,e.r+r.r),new c.HexCoord(e.q+o.q,e.r+o.r)]},$t=()=>{const e=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,t=Object.values(te.ants).find(t=>"queen"===t.type&&t.owner===e);if(t){const e=(0,c.hexToPixel)(t.position,Ut);Nt({x:-e.x,y:150-e.y})}},Zt=(()=>{const e=kt.width-250-300-60,t=kt.height-100,n=Math.min(e,4*t/3),r=Math.max(400,Math.min(1200,n));return{width:r,height:3*r/4}})(),Xt=()=>{Lt(!1)};(0,r.useEffect)(()=>{const e=e=>{const t=e.target;if(t&&("INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName))return;const n=50,r=!Z||!Z.isMultiplayer||te.currentPlayer===Z.playerRole;if(console.log("Key pressed:",e.key,"selectedAnt:",ce,"myTurn:",r),!e.repeat||["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","a","s","d","W","A","S","D"].includes(e.key)){if(ce&&r){const t=te.ants[ce];switch(console.log("Ant selected, checking action hotkey. Key:",e.key.toLowerCase(),"Ant type:",null===t||void 0===t?void 0:t.type),e.key.toLowerCase()){case"a":if(console.log("Attack hotkey triggered"),e.preventDefault(),t){const e=(0,l.s1)(t.type);if(e.attack>0){const n=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,r=Object.values(te.ants).filter(e=>e.owner!==n&&(0,s.canAttack)(t,e,te)),o=Object.values(te.anthills||{}).filter(r=>{if(r.owner===n)return!1;const o=Math.max(Math.abs(t.position.q-r.position.q),Math.abs(t.position.r-r.position.r),Math.abs(-t.position.q-t.position.r-(-r.position.q-r.position.r)));return o<=e.attackRange&&o>=(e.minAttackRange||0)}),i=Object.values(te.eggs||{}).filter(r=>{if(r.owner===n)return!1;const o=Math.max(Math.abs(t.position.q-r.position.q),Math.abs(t.position.r-r.position.r),Math.abs(-t.position.q-t.position.r-(-r.position.q-r.position.r)));return o<=e.attackRange&&o>=(e.minAttackRange||0)});if(r.length>0||o.length>0||i.length>0)return void he(e=>"attack"===e?null:"attack")}}return;case"b":if(console.log("Build hotkey triggered"),e.preventDefault(),t&&"drone"===t.type){if((0,l.s1)(t.type).canBuildAnthill)return void gn()}return;case"m":return console.log("Move hotkey triggered - antId:",null===t||void 0===t?void 0:t.id,"hasMoved:",null===t||void 0===t?void 0:t.hasMoved,"hasAttacked:",null===t||void 0===t?void 0:t.hasAttacked),e.preventDefault(),t&&!t.hasMoved?(console.log("\u2705 Setting selectedAction to MOVE from M key"),void he("move")):void console.log("\u274c NOT setting move action - ant:",null===t||void 0===t?void 0:t.id,"hasMoved:",null===t||void 0===t?void 0:t.hasMoved);case"o":return Ee&&Ce?(console.log("Soldier hotkey - hatching soldier"),e.preventDefault(),void yn("soldier")):"layEgg"===de?(console.log("Soldier egg type selected"),e.preventDefault(),void je("soldier")):void 0;case"h":return console.log("Heal hotkey triggered"),e.preventDefault(),!t||"queen"!==t.type&&"healer"!==t.type?void 0:void he("heal");case"e":return console.log("Ensnare hotkey triggered"),e.preventDefault(),t&&"healer"===t.type?void he("ensnare"):void 0;case"x":return console.log("Detonate hotkey triggered (X key)"),e.preventDefault(),t&&"bomber"===t.type?void he("detonate"):void 0;case"p":return console.log("Plague hotkey triggered"),e.preventDefault(),t&&"cordyphage"===t.type?void he("plague"):void 0;case"d":return Ee&&Ce?(console.log("Drone hotkey - hatching drone"),e.preventDefault(),void yn("drone")):"layEgg"===de?(console.log("Drone egg type selected"),e.preventDefault(),void je("drone")):void 0;case"s":return Ee&&Ce?(console.log("Scout hotkey - hatching scout"),e.preventDefault(),void yn("scout")):"layEgg"===de?(console.log("Scout egg type selected"),e.preventDefault(),void je("scout")):void 0;case"t":return Ee&&Ce?(console.log("Tank hotkey - hatching tank"),e.preventDefault(),void yn("tank")):"layEgg"===de?(console.log("Tank egg type selected"),e.preventDefault(),void je("tank")):void 0;case"z":return Ee&&Ce?(console.log("Spitter hotkey - hatching spitter"),e.preventDefault(),void yn("spitter")):"layEgg"===de?(console.log("Spitter egg type selected"),e.preventDefault(),void je("spitter")):void 0;case"x":return Ee&&Ce?(console.log("Bomber hotkey - hatching bomber"),e.preventDefault(),void yn("bomber")):"layEgg"===de?(console.log("Bomber egg type selected"),e.preventDefault(),void je("bomber")):void 0;case"r":return Ee&&Ce?(console.log("Bombardier hotkey - hatching bombardier"),e.preventDefault(),void yn("bombardier")):"layEgg"===de?(console.log("Bombardier egg type selected"),e.preventDefault(),void je("bombardier")):void 0;case"w":return Ee&&Ce?(console.log("Healer hotkey - hatching healer"),e.preventDefault(),void yn("healer")):"layEgg"===de?(console.log("Healer egg type selected"),e.preventDefault(),void je("healer")):void 0;case"c":return Ee&&Ce?(console.log("Cordyphage hotkey - hatching cordyphage"),e.preventDefault(),void yn("cordyphage")):"layEgg"===de?(console.log("Cordyphage egg type selected"),e.preventDefault(),void je("cordyphage")):void 0;case"escape":return console.log("Escape hotkey triggered"),e.preventDefault(),ce&&ve({antId:ce,time:Date.now()}),ue(null),he(null),je(null),xe(!0),void setTimeout(()=>xe(!1),300)}}if(!be)switch(e.key){case"q":case"Q":if(r){console.log("Q key - Select queen hotkey triggered (global)"),e.preventDefault();const t=nn(),n=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:t.currentPlayer,r=Object.values(t.ants).find(e=>"queen"===e.type&&e.owner===n&&!e.isDead);if(r){ue(r.id);const e=(0,a.getEggLayCost)(r);(0,a.hasEnoughEnergy)(r,e)?he("layEgg"):he(null)}}break;case"Tab":r&&(vn(),e.preventDefault());break;case"ArrowUp":case"w":case"W":Nt(e=>({x:e.x,y:e.y+n})),e.preventDefault();break;case"ArrowDown":case"s":case"S":Nt(e=>({x:e.x,y:e.y-n})),e.preventDefault();break;case"ArrowLeft":Nt(e=>({x:e.x+n,y:e.y})),e.preventDefault();break;case"ArrowRight":Nt(e=>({x:e.x-n,y:e.y})),e.preventDefault();break;case"a":case"A":ce||(Nt(e=>({x:e.x+n,y:e.y})),e.preventDefault());break;case"d":case"D":ce||(Nt(e=>({x:e.x-n,y:e.y})),e.preventDefault());break;case"+":case"=":Ft(e=>Math.min(2,e+.1)),e.preventDefault();break;case"-":case"_":Ft(e=>Math.max(.5,e-.1)),e.preventDefault();break;case"Home":case"c":case"C":$t(),e.preventDefault()}}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[te,Z,ce,de,it,st,be]),(0,r.useEffect)(()=>{if(!Z||"object"!==typeof Z)return void Wt(!1);if(Bt)return;if(!te.ants||0===Object.keys(te.ants).length)return;if(Z.isMultiplayer&&!Z.playerRole)return;const e=Z.isMultiplayer?Z.playerRole:"player1",t=Object.values(te.ants).find(t=>"queen"===t.type&&t.owner===e);if(t&&t.position&&"number"===typeof t.position.q&&"number"===typeof t.position.r){console.log("Centering camera on queen for",e,"at position",t.position.q,t.position.r);const n=(0,c.hexToPixel)(t.position,Ut);Nt({x:-n.x,y:150-n.y}),Wt(!0)}},[Z,te.ants,Bt]),(0,r.useEffect)(()=>{const e=()=>{St({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(!ce||!te.ants[ce]||"move"!==de)return void _e(new Map);const e=te.ants[ce],t=(0,l.s1)(e.type);if(e.hasMoved)return void _e(new Map);if("queen"===e.type)return void _e(new Map);const n=(e,t)=>{if(e===t)return!0;const n=te.players[e],r=te.players[t];return!(null===n||void 0===n||!n.team||null===r||void 0===r||!r.team)&&n.team===r.team},r=Object.values(te.ants).filter(t=>t.id!==e.id&&!n(t.owner,e.owner)).map(e=>new c.HexCoord(e.position.q,e.position.r)),o=[...Object.values(te.ants).filter(t=>t.id!==e.id&&n(t.owner,e.owner)).map(e=>new c.HexCoord(e.position.q,e.position.r)),...Object.values(te.eggs||{}).filter(t=>n(t.owner,e.owner)).map(e=>new c.HexCoord(e.position.q,e.position.r))];let i=t.moveRange;const a=te.players[e.owner];if(null!==a&&void 0!==a&&a.heroAbilityActive&&"gorlak"===(null===a||void 0===a?void 0:a.heroId)&&t.attackRange<=1&&(i+=1),e.isBurrowed){if("soldier"!==e.type)return void _e(new Map);i=1}e.ensnared&&e.ensnared>0&&(i=0);const s=new c.HexCoord(e.position.q,e.position.r),u=(0,c.getMovementRangeWithPaths)(s,i,Vt,r,o,Gt),d=new Map;u.forEach(e=>{let{hex:t,path:n}=e;d.set(t.toString(),n)}),_e(d)},[ce,de,te,Vt,Gt]),(0,r.useEffect)(()=>{Se(null)},[ce,de]),(0,r.useEffect)(()=>{if(!ct)return;const{antId:e,path:t,currentStep:n}=ct;if(n>=t.length-1)return void ut(null);const r=setTimeout(()=>{const r=n+1,o=t[r];let a=!1,s=!1;ne(t=>{var n;return null!==(n=t.ants)&&void 0!==n&&n[e]?(a=!0,(0,i.A)((0,i.A)({},t),{},{ants:(0,i.A)((0,i.A)({},t.ants),{},{[e]:(0,i.A)((0,i.A)({},t.ants[e]),{},{position:o})})})):t}),oe(t=>{var n;return null!==t&&void 0!==t&&null!==(n=t.ants)&&void 0!==n&&n[e]?(s=!0,(0,i.A)((0,i.A)({},t),{},{ants:(0,i.A)((0,i.A)({},t.ants),{},{[e]:(0,i.A)((0,i.A)({},t.ants[e]),{},{position:o})})})):t}),ut(n=>n&&n.antId===e?{antId:e,path:t,currentStep:r}:null)},600);return()=>clearTimeout(r)},[ct]);const Jt=(e,t)=>{const n="damage_".concat(Date.now(),"_").concat(Math.random()),r={id:n,damage:e,position:t,timestamp:Date.now()};qe(e=>[...e,r]),setTimeout(()=>{qe(e=>e.filter(e=>e.id!==n))},1e3)},en=function(e,t,n){var r;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i="attack_".concat(Date.now(),"_").concat(Math.random()),a={id:i,attackerId:e,targetPos:t,timestamp:Date.now(),isRanged:n};ze(e=>[...e,a]);const s=o||te.ants[e]||(null===re||void 0===re||null===(r=re.ants)||void 0===r?void 0:r[e]);if(s){var l,c,u,d;const t=(null===(l=te.players)||void 0===l||null===(c=l[s.owner])||void 0===c?void 0:c.color)||(null===re||void 0===re||null===(u=re.players)||void 0===u||null===(d=u[s.owner])||void 0===d?void 0:d.color);At(e,s.type,"attack",t),setTimeout(()=>{At(e,s.type,"idle",t)},n?200:300)}if(n&&s){const e="projectile_".concat(Date.now(),"_").concat(Math.random());setTimeout(()=>{Be(n=>[...n,{id:e,startPos:s.position,endPos:t,timestamp:Date.now()}]),setTimeout(()=>{Be(t=>t.filter(t=>t.id!==e))},300)},200)}setTimeout(()=>{ze(e=>e.filter(e=>e.id!==i))},n?200:400)},tn=(e,t,n)=>{const r="resource_".concat(Date.now(),"_").concat(Math.random()),o={id:r,amount:e,type:t,position:n,timestamp:Date.now()};Ue(e=>[...e,o]),setTimeout(()=>{Ue(e=>e.filter(e=>e.id!==r))},1e3)};(0,r.useEffect)(()=>{if(0===Fe.length)return;const e=setInterval(()=>{qe(e=>[...e])},16);return()=>clearInterval(e)},[Fe.length]),(0,r.useEffect)(()=>{if(0===Le.length)return;const e=setInterval(()=>{ze(e=>[...e])},16);return()=>clearInterval(e)},[Le.length]),(0,r.useEffect)(()=>{if(0===He.length)return;const e=setInterval(()=>{Be(e=>[...e])},16);return()=>clearInterval(e)},[He.length]),(0,r.useEffect)(()=>{if(0===We.length)return;const e=setInterval(()=>{Ue(e=>[...e])},16);return()=>clearInterval(e)},[We.length]),(0,r.useEffect)(()=>{if(null!==Z&&void 0!==Z&&Z.isMultiplayer&&Z.gameId){const e=m(Z.gameId,e=>{var t;if(console.log("Firebase subscription received:",{turn:e.turn,currentPlayer:e.currentPlayer,myRole:Z.playerRole}),oe(e),e.gameOver&&!Ye&&$e(!0),e.lastCombatAction){const{attackerId:t,targetPosition:n,isRanged:r,damageDealt:o,timestamp:i}=e.lastCombatAction;if(i&&i!==Pt.current){Pt.current=i;const a=y(e,Z.playerRole),s=e.ants[t],l=s&&a.has("".concat(s.position.q,",").concat(s.position.r));a.has("".concat(n.q,",").concat(n.r))&&(r&&!l?o&&o.length>0&&o.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)}):l&&(en(t,n,r,s),o&&o.length>0&&setTimeout(()=>{o.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)})},r?300:200)))}}let n=e;if(Z.isMultiplayer&&Z.playerRole){const t=Z.playerRole,r="player1"===t?"player2":"player1";console.log("Movement detection: I am ".concat(t,", checking for ").concat(r," movements"));const o=y(e,t);Object.values(e.ants||{}).forEach(e=>{if(e.owner!==r)return;const t="".concat(e.position.q,",").concat(e.position.r);if(!o.has(t))return;const a=Mt.current[e.id];!a||a.q===e.position.q&&a.r===e.position.r?a||console.log("First time seeing ".concat(r," ant ").concat(e.id," at"),e.position):(console.log("Animating ".concat(r," ant ").concat(e.id," movement from"),a,"to",e.position),n=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[e.id]:(0,i.A)((0,i.A)({},n.ants[e.id]),{},{position:a})})}),ut({antId:e.id,path:[a,e.position],currentStep:0})),Mt.current[e.id]=(0,i.A)({},e.position)})}let r=Z.isMultiplayer&&!1!==Z.fogOfWar||Z.isAI&&!1!==Z.fogOfWar?b(n,Z.playerRole||"player1"):n;if(ct&&null!==(t=r.ants)&&void 0!==t&&t[ct.antId]){const e=ct.path[ct.currentStep];r=(0,i.A)((0,i.A)({},r),{},{ants:(0,i.A)((0,i.A)({},r.ants),{},{[ct.antId]:(0,i.A)((0,i.A)({},r.ants[ct.antId]),{},{position:e})})})}ne(r)});return()=>e()}},[Z]),(0,r.useEffect)(()=>{(async()=>{if(null===Z||void 0===Z||!Z.isAI||ie||se)return;const e=nn();if(e&&"player2"===e.currentPlayer){console.log("AI turn detected - automatically executing AI turn"),ae(!0);try{await new Promise(e=>setTimeout(e,1e3));const{gameState:n,movements:r,combatActions:o}=await T(e,"player2",Z.aiDifficulty);for(let a=0;a<r.length;a++){var t;const n=r[a],o=null===(t=e.ants)||void 0===t?void 0:t[n.antId],i=o?[o.position,...n.path]:n.path;await new Promise(e=>{ut({antId:n.antId,path:i,currentStep:0});const t=600*(i.length-1);setTimeout(e,t+100)}),a<r.length-1&&await new Promise(e=>setTimeout(e,200))}const{gameState:i}=(0,a.endTurn)(n);if(rn(i),await new Promise(e=>setTimeout(e,100)),o&&o.length>0)for(const e of o){const{attackerId:t,targetPosition:n,isRanged:r,damageDealt:o}=e,a=i.ants[t];a&&(en(t,n,r,a),o&&o.length>0&&setTimeout(()=>{o.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)})},r?300:200)),await new Promise(e=>setTimeout(e,r?800:600))}await new Promise(e=>setTimeout(e,100))}catch(n){console.error("AI turn execution failed:",n),console.error("Error stack:",n.stack),hn("AI encountered an error. Ending AI turn.")}finally{ae(!1)}}})()},[te.currentPlayer,te.turn,null===Z||void 0===Z?void 0:Z.isAI,ie,se]),(0,r.useEffect)(()=>{if(te.turn<=1||!Z)return;!on()||ie||bt||xt(!0)},[te.currentPlayer,te.turn,ie]),(0,r.useEffect)(()=>{const e=Date.now(),t=[],n=null!==Z&&void 0!==Z&&Z.isAI&&!1!==Z.fogOfWar?re:te;if(Object.values(n.deadAnts||{}).forEach(n=>{e-n.createdAt>=2e3&&t.push(n.id)}),t.length>0){const e=setTimeout(()=>{const e=nn(),n=(0,i.A)({},e.deadAnts);t.forEach(e=>{delete n[e]}),rn((0,i.A)((0,i.A)({},e),{},{deadAnts:n}))},100);return()=>clearTimeout(e)}},[null===Z||void 0===Z?void 0:Z.isAI,null===Z||void 0===Z?void 0:Z.fogOfWar,null===re||void 0===re?void 0:re.deadAnts,te.deadAnts]);const nn=()=>(null!==Z&&void 0!==Z&&Z.isMultiplayer||null!==Z&&void 0!==Z&&Z.isAI&&!1!==Z.fogOfWar)&&re||te,rn=e=>{if(null!==Z&&void 0!==Z&&Z.isMultiplayer){oe(e);const t=Z.playerRole||"player1";if(!1!==Z.fogOfWar){const n=b(e,t);ne(n)}else ne(e);if(Z.gameId){const t=(0,i.A)((0,i.A)({},e),{},{lastUpdateTimestamp:Date.now()});console.log("updateGame - Sending to Firebase:",{turn:e.turn,currentPlayer:e.currentPlayer,gameId:Z.gameId,timestamp:t.lastUpdateTimestamp}),g(Z.gameId,t)}}else if(null!==Z&&void 0!==Z&&Z.isAI)if(oe(e),!1!==Z.fogOfWar){const t=b(e,"player1");ne(t)}else ne(e);else ne(e)},on=()=>{if(!Z)return!1;if(Z.isAI)return"player1"===te.currentPlayer&&!ie;if(!Z.isMultiplayer)return!0;return te.currentPlayer===Z.playerRole},an=e=>{ee(e),X("lobby")},sn=()=>{X("localSetup")},ln=()=>{X("aiSetup")},cn=()=>{X("onlineMultiplayer")},un=e=>{const t={};e.mapSize&&(t.mapSize=e.mapSize),e.playerCount&&(t.playerCount=e.playerCount),e.mapShape&&(t.mapShape=e.mapShape),e.player1Color&&(t.player1Color=e.player1Color),e.player2Color&&(t.player2Color=e.player2Color),e.player3Color&&(t.player3Color=e.player3Color),e.player4Color&&(t.player4Color=e.player4Color),e.player1Hero&&(t.player1Hero=e.player1Hero),e.player2Hero&&(t.player2Hero=e.player2Hero),e.player3Hero&&(t.player3Hero=e.player3Hero),e.player4Hero&&(t.player4Hero=e.player4Hero),e.player1Team&&(t.player1Team=e.player1Team),e.player2Team&&(t.player2Team=e.player2Team),e.player3Team&&(t.player3Team=e.player3Team),e.player4Team&&(t.player4Team=e.player4Team),console.log("handleStartGame received mode:",{playerCount:e.playerCount,mapShape:e.mapShape,isHost:e.isHost,isMultiplayer:e.isMultiplayer}),console.log("handleStartGame gameOptions:",t);const n=(0,i.A)((0,i.A)({},e),{},{gameId:e.gameId||(null===J||void 0===J?void 0:J.gameId),playerId:e.playerId||(null===J||void 0===J?void 0:J.playerId),playerRole:e.playerRole||(null===J||void 0===J?void 0:J.playerRole),isMultiplayer:void 0!==e.isMultiplayer?e.isMultiplayer:null===J||void 0===J?void 0:J.isMultiplayer});if(X(n),e.isMultiplayer)if(e.isHost){const n=(0,a.createInitialGameState)(t);console.log("Host creating initial game state:",{playerCount:n.playerCount,mapShape:n.mapShape,players:Object.keys(n.players)}),oe(n);const r=!1!==e.fogOfWar?b(n,"player1"):n;ne(r);const o=e.gameId||(null===J||void 0===J?void 0:J.gameId);o&&g(o,(0,i.A)((0,i.A)({},n),{},{lastUpdateTimestamp:Date.now()}))}else console.log("Non-host player waiting for game state from Firebase");else if(e.isAI){const n=(0,a.createInitialGameState)(t);if(console.log("Starting AI game - fogOfWar setting:",e.fogOfWar,"Will apply fog?",e.isAI&&!1!==e.fogOfWar),oe(n),!1!==e.fogOfWar){console.log("Applying fog of war - filtering state for player1");const e=b(n,"player1");ne(e)}else console.log("NOT applying fog of war - using full state for display"),ne(n)}else{const e=(0,a.createInitialGameState)(t);ne(e)}},dn=()=>{X(null),ee(null),ne((0,a.createInitialGameState)())};if(!Z)return(0,x.jsx)(w,{onStartGame:un,onEnterLobby:an,onEnterLocalSetup:sn,onEnterAISetup:ln,onEnterOnlineMultiplayer:cn});if("onlineMultiplayer"===Z)return(0,x.jsx)(_,{onEnterGameLobby:an,onBack:dn});if("lobby"===Z&&J)return(0,x.jsx)(S,{roomCode:J.gameId,playerId:J.playerId,playerRole:J.playerRole,isHost:J.isHost,onStartGame:un,onBack:dn});if("localSetup"===Z)return(0,x.jsx)(C,{onStartGame:un,onBack:dn});if("aiSetup"===Z)return(0,x.jsx)(L,{onStartGame:un,onBack:dn});if(Ze&&te.gameOver)return(0,x.jsx)(z,{gameState:te,onReturnToMenu:dn});const hn=e=>{De(e),setTimeout(()=>De(""),3e3)},pn=()=>{if(!on())return void hn("It's not your turn!");const e=nn();if(!ce||!e.ants[ce])return;const t=e.ants[ce];if("bomber"!==t.type)return void hn("Only bombers can detonate!");if(t.hasAttacked)return void hn("This bomber has already detonated this turn!");const n="explosion_".concat(Date.now());et(e=>[...e,{id:n,position:t.position,timestamp:Date.now()}]),setTimeout(()=>{et(e=>e.filter(e=>e.id!==n))},1e3);const r=(0,s.detonateBomber)(e,ce);r.damageDealt&&r.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)}),rn(r.gameState),he(null),ce&&ve({antId:ce,time:Date.now()}),ue(null)},fn=()=>{if(!ce)return[];const e=nn(),t=e.ants[ce];if(!t)return[];if(t.isBurrowed&&"soldier"!==t.type)return[];const n=(0,l.s1)(t.type),r=[];return Object.values(e.ants).forEach(e=>{if(e.position&&t.position&&e.owner!==t.owner){const o=Math.max(Math.abs(t.position.q-e.position.q),Math.abs(t.position.r-e.position.r),Math.abs(-t.position.q-t.position.r-(-e.position.q-e.position.r)));o<=n.attackRange&&o>=(n.minAttackRange||0)&&r.push(e)}}),Object.values(e.anthills||{}).forEach(e=>{if(e.position&&t.position&&e.owner!==t.owner){const o=Math.max(Math.abs(t.position.q-e.position.q),Math.abs(t.position.r-e.position.r),Math.abs(-t.position.q-t.position.r-(-e.position.q-e.position.r)));o<=n.attackRange&&o>=(n.minAttackRange||0)&&r.push(e)}}),Object.values(e.eggs||{}).forEach(e=>{if(e.owner!==t.owner){const o=Math.max(Math.abs(t.position.q-e.position.q),Math.abs(t.position.r-e.position.r),Math.abs(-t.position.q-t.position.r-(-e.position.q-e.position.r)));o<=n.attackRange&&o>=(n.minAttackRange||0)&&r.push(e)}}),r},gn=()=>{if(!ce)return;const e=nn(),t=e.ants[ce];if(!t)return;if("drone"!==t.type)return void hn("Only drones can build anthills!");const n=Object.values(e.resources).find(e=>Qt(e.position,t.position));if(!n)return void hn("You must move your drone onto a resource node to build an anthill!");const r=Object.values(e.anthills||{}).find(e=>Qt(e.position,n.position)),o=String.fromCharCode(65+n.position.q+6)+(n.position.r+7);if(r&&r.isComplete&&r.owner===t.owner)return void hn("There is already a completed ".concat(r.resourceType," anthill at ").concat(o,"!"));if(r&&r.owner!==t.owner)return void hn("Cannot build on enemy anthill at ".concat(o,"! Destroy it first."));if(!r){if(e.players[t.owner].resources.food<l.sv.ANTHILL_BUILD_COST)return void hn("Not enough food to start building an anthill! Cost: ".concat(l.sv.ANTHILL_BUILD_COST," food"))}const i=(0,a.buildAnthill)(e,ce,n.id);rn(i),he(null),ue(null)},mn=e=>{console.log("handleHexClick:",{hex:e?"".concat(e.q,",").concat(e.r):"null",selectedAction:de,selectedAnt:ce,pendingEggType:Re});const t=nn();if(de&&null!==de&&!on())return void hn("It's not your turn!");if("detonate"===de&&ce)return void pn();if("attack"===de&&ce){const n=t.ants[ce];if(n.hasAttacked)return void hn("This unit has already attacked this turn!");const r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==n.owner),o=Object.values(t.eggs||{}).find(t=>Qt(t.position,e)&&t.owner!==n.owner),a=Object.values(t.anthills||{}).find(t=>Qt(t.position,e)&&t.owner!==n.owner);if(r){if((0,s.canAttack)(n,r,t)){const e=(0,l.s1)(n.type).attackRange>1;return en(ce,r.position,e),le(!0),void setTimeout(()=>{const e=(0,s.resolveCombat)(t,ce,r.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const o=(0,i.A)({},n.ants);o[ce]&&(o[ce]=(0,i.A)((0,i.A)({},o[ce]),{},{hasAttacked:!0}));const a=(0,i.A)((0,i.A)({},n),{},{ants:o,lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(a),he(null),ue(null),le(!1)},e?500:400)}return void hn("Enemy is out of attack range!")}if(o){const e=(0,l.s1)(n.type),r=Math.max(Math.abs(n.position.q-o.position.q),Math.abs(n.position.r-o.position.r),Math.abs(-n.position.q-n.position.r-(-o.position.q-o.position.r)));if(r>e.attackRange)return void hn("Egg is out of attack range!");if(e.minAttackRange&&r<e.minAttackRange)return void hn("Too close! This unit cannot attack at this range.");const a=e.attackRange>1;return en(ce,o.position,a),void setTimeout(()=>{const e=(0,s.attackEgg)(t,ce,o.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const r=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.ants[ce]),{},{hasAttacked:!0})}),lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(r),he(null),ue(null)},a?500:400)}if(a){const e=(0,l.s1)(n.type),r=Math.max(Math.abs(n.position.q-a.position.q),Math.abs(n.position.r-a.position.r),Math.abs(-n.position.q-n.position.r-(-a.position.q-a.position.r)));if(r>e.attackRange)return void hn("Anthill is out of attack range!");if(e.minAttackRange&&r<e.minAttackRange)return void hn("Too close! This unit cannot attack at this range.");const o=e.attackRange>1;return en(ce,a.position,o),void setTimeout(()=>{const e=(0,s.attackAnthill)(t,ce,a.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const r=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.ants[ce]),{},{hasAttacked:!0})}),lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(r),he(null),ue(null)},o?500:400)}return void hn("No enemy at that location!")}if("heal"===de&&ce){const n=t.ants[ce];if("queen"!==n.type&&"healer"!==n.type)return hn("Only queens and healers can heal!"),void he(null);if(n.hasAttacked)return void hn("This unit has already used a terminal action this turn!");const r="healer"===n.type?l.xr.HEALER.healEnergyCost:l.sv.HEAL_ENERGY_COST;if(!(0,a.hasEnoughEnergy)(n,r))return void hn("Not enough energy! Need ".concat(r," energy to heal."));const o=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner===n.owner);if(!o)return void hn("No friendly unit at that location!");if(o.health>=o.maxHealth)return void hn("That unit is already at full health!");const i=(0,l.s1)(n.type),s="healer"===n.type?i.healRange:i.attackRange;if(Math.max(Math.abs(n.position.q-o.position.q),Math.abs(n.position.r-o.position.r),Math.abs(-n.position.q-n.position.r-(-o.position.q-o.position.r)))>s)return void hn("Target is out of heal range!");const c=nn(),u=(0,a.healAnt)(c,ce,o.id),d="healer"===n.type?Math.min(l.xr.HEALER.healAmount,o.maxHealth-o.health):Math.min(l.sv.HEAL_AMOUNT,o.maxHealth-o.health);return tn(d,"heal",o.position),rn(u),he(null),void ue(null)}if("layEgg"===de&&ce){console.log("layEgg branch entered");const n=t.ants[ce];if(console.log("Queen ant:",n?{id:n.id,type:n.type,position:n.position}:"NOT FOUND"),"queen"!==n.type)return hn("Only queens can lay eggs!"),void he(null);const r=(0,a.getSpawningPoolHexes)(n,c.getNeighbors),o=r.some(t=>Qt(t,e));if(console.log("Spawning pool check:",{spawningPoolSize:r.length,isInSpawningPool:o,clickedHex:"".concat(e.q,",").concat(e.r),spawningPoolHexes:r.map(e=>"".concat(e.q,",").concat(e.r)),queenPos:n.position?"".concat(n.position.q,",").concat(n.position.r):"undefined"}),!o){const e=l.mZ[n.queenTier||"queen"];return void hn("Can only lay eggs in the ".concat(e.spawningSpots," spawning pool hexes adjacent to your queen!"))}const i=Object.values(t.ants).some(t=>Qt(t.position,e))||Object.values(t.eggs).some(t=>Qt(t.position,e));return console.log("Occupancy check:",{occupied:i}),i?void hn("Space is occupied!"):(console.log("Checking egg type sources:",{selectedEggHex:Ce,pendingEggType:Re}),Ce&&Ce.antType?(console.log("Laying egg from selectedEggHex.antType:",Ce.antType),void yn(Ce.antType,e)):Re?(console.log("Laying egg from pendingEggType:",Re),yn(Re,e),void je(null)):(console.log("No egg type selected, storing hex for selector"),void Ae(e)))}if("move"===de&&ce){const o=t.ants[ce],u=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner===o.owner&&t.id!==o.id);if(u)return ue(u.id),he(null),Pe(null),void Oe(null);const d=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==o.owner),h=Object.values(t.eggs||{}).find(t=>Qt(t.position,e)&&t.owner!==o.owner),p=Object.values(t.anthills||{}).find(t=>Qt(t.position,e)&&t.owner!==o.owner);if(d){if(o.hasAttacked)return void hn("This unit has already attacked this turn!");if((0,s.canAttack)(o,d,t)){const e=(0,l.s1)(o.type).attackRange>1;return en(ce,d.position,e),void setTimeout(()=>{const e=(0,s.resolveCombat)(t,ce,d.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const r=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.ants[ce]),{},{hasMoved:!0,hasAttacked:!0})}),lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(r),he(null),ue(null)},e?500:400)}return void hn("Enemy is out of attack range!")}if(h){if(o.hasAttacked)return void hn("This unit has already attacked this turn!");const e=(0,l.s1)(o.type),n=Math.max(Math.abs(o.position.q-h.position.q),Math.abs(o.position.r-h.position.r),Math.abs(-o.position.q-o.position.r-(-h.position.q-h.position.r)));if(n>e.attackRange)return void hn("Egg is out of attack range!");if(e.minAttackRange&&n<e.minAttackRange)return void hn("Too close! This unit cannot attack at this range.");const r=e.attackRange>1;return en(ce,h.position,r),void setTimeout(()=>{const e=(0,s.attackEgg)(t,ce,h.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const r=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.ants[ce]),{},{hasMoved:!0,hasAttacked:!0})}),lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(r),he(null),ue(null)},r?500:400)}if(p){if(o.hasAttacked)return void hn("This unit has already attacked this turn!");const e=(0,l.s1)(o.type),n=Math.max(Math.abs(o.position.q-p.position.q),Math.abs(o.position.r-p.position.r),Math.abs(-o.position.q-o.position.r-(-p.position.q-p.position.r)));if(n>e.attackRange)return void hn("Anthill is out of attack range!");if(e.minAttackRange&&n<e.minAttackRange)return void hn("Too close! This unit cannot attack at this range.");const r=e.attackRange>1;return en(ce,p.position,r),void setTimeout(()=>{const e=(0,s.attackAnthill)(t,ce,p.id),n=e.gameState;e.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)});const r=(0,i.A)((0,i.A)({},n),{},{ants:(0,i.A)((0,i.A)({},n.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.ants[ce]),{},{hasMoved:!0,hasAttacked:!0})}),lastCombatAction:e.attackAnimation?(0,i.A)((0,i.A)({},e.attackAnimation),{},{damageDealt:e.damageDealt,timestamp:Date.now()}):void 0});rn(r),he(null),ue(null)},r?500:400)}if(o.hasAttacked)return void hn("This unit has already attacked and cannot move!");if(o.hasMoved)return void hn("This unit has already moved this turn!");if("queen"===o.type)return void hn("Queens cannot move! They stay on their throne.");const f=(0,l.s1)(o.type);let m=f.moveRange;const y=t.players[o.owner];null!==y&&void 0!==y&&y.heroAbilityActive&&"gorlak"===(null===y||void 0===y?void 0:y.heroId)&&f.attackRange<=1&&(m+=1);if((0,c.getMovementRange)(o.position,m,Vt,[],Gt).some(t=>Qt(t,e))){var n;const u=e.toString();let d=we.get(u);if(ke&&!Qt(ke,e)){const n=ke.toString(),r=we.get(n);if(r){const n=r.length-1,i=f.movement-n;if(i>0){const n=Object.values(t.ants).filter(e=>e.id!==o.id&&e.owner!==o.owner).map(e=>new c.HexCoord(e.position.q,e.position.r)),a=Object.values(t.ants).filter(e=>e.id!==o.id&&e.owner===o.owner).map(e=>new c.HexCoord(e.position.q,e.position.r)),s=Object.values(t.eggs||{}).map(e=>new c.HexCoord(e.position.q,e.position.r)),l=(0,c.getMovementRangeWithPaths)(ke,i,Vt,n,[...a,...s],Gt).find(t=>{let{hex:n}=t;return Qt(n,e)});l&&(d=[...r,...l.path.slice(1)])}}}if(!d||0===d.length)return void hn("No valid path to that destination!");if(("online"===Z.mode||"local"===Z.mode)&&re){let e=null,n=-1;for(let r=0;r<d.length;r++){const i=d[r],a=Object.values(re.ants||{}).find(e=>Qt(e.position,i)&&e.owner!==o.owner),s=Object.values(t.ants||{}).find(e=>Qt(e.position,i)&&e.owner!==o.owner);if(a&&!s){e=a,n=r;break}}if(e&&n>=0){var r;const t=d.slice(0,n);if(0===t.length)return void hn("Path is blocked by an enemy ant!");const l=t[t.length-1];ut({antId:ce,path:t,currentStep:0});const c=null===(r=te.players[o.owner])||void 0===r?void 0:r.color;At(ce,o.type,"walk",c);const u=Math.max(600*(t.length-1),100);return void setTimeout(async()=>{let t=(0,s.moveAnt)(re,ce,l);(e=>{const t="ambush_".concat(Date.now(),"_").concat(Math.random()),n={id:t,position:e,timestamp:Date.now()};Ge(e=>[...e,n]),setTimeout(()=>{Ge(e=>e.filter(e=>e.id!==t))},1e3)})(l),At(ce,o.type,"idle",c),await new Promise(e=>setTimeout(e,300));const n=(0,s.resolveAmbush)(t,ce,e.id);if(t=n.gameState,n.attackAnimations&&n.attackAnimations.length>0)for(const e of n.attackAnimations){const n=t.ants[e.attackerId]||re.ants[e.attackerId];if(n){var r,u,d,h;(null===(r=t.players)||void 0===r||null===(u=r[n.owner])||void 0===u?void 0:u.color)||(null===(d=re.players)||void 0===d||null===(h=d[n.owner])||void 0===h||h.color);en(e.attackerId,e.targetPosition,e.isRanged,n)}await new Promise(t=>setTimeout(t,e.isRanged?800:600))}n.damageDealt&&n.damageDealt.length>0&&setTimeout(()=>{n.damageDealt.forEach(e=>{let{damage:t,position:n}=e;Jt(t,n)})},200);const p=(0,a.markAntMoved)((0,i.A)((0,i.A)({},t),{},{ants:(0,i.A)((0,i.A)({},t.ants),{},{[ce]:t.ants[ce]?(0,i.A)((0,i.A)({},t.ants[ce]),{},{hasAttacked:!0}):t.ants[ce]})}),ce);"online"===Z.mode&&Z.sessionId&&await g(Z.sessionId,p);const f=b(p,Z.playerRole||"player1");ne(f),oe(p),he(null),ue(null)},u)}}for(let e=0;e<d.length;e++){const n=d[e];if(Object.values(t.ants).find(e=>Qt(e.position,n)&&e.owner!==o.owner))return void hn("Path is blocked by an enemy ant!");if(Object.values(t.eggs).find(e=>Qt(e.position,n)&&e.owner!==o.owner))return void hn("Path is blocked by an enemy egg!")}ut({antId:ce,path:d,currentStep:0});const h=null===(n=te.players[o.owner])||void 0===n?void 0:n.color;At(ce,o.type,"walk",h);const p=600*(d.length-1);setTimeout(()=>{const n=(0,s.moveAnt)(t,ce,e),r=(0,a.markAntMoved)(n,ce);rn(r),At(ce,o.type,"idle",h),((e,t)=>{var n;const r=null===(n=t.ants)||void 0===n?void 0:n[e];if(!r||r.hasAttacked)return!1;const o=(0,l.s1)(r.type);if(t.ants&&Object.values(t.ants).some(e=>!(e.owner===r.owner||!e.position||!r.position)&&Math.max(Math.abs(r.position.q-e.position.q),Math.abs(r.position.r-e.position.r),Math.abs(-r.position.q-r.position.r-(-e.position.q-e.position.r)))<=o.attackRange))return!0;if(t.eggs&&Object.values(t.eggs).some(e=>e.owner!==r.owner&&Math.max(Math.abs(r.position.q-e.position.q),Math.abs(r.position.r-e.position.r),Math.abs(-r.position.q-r.position.r-(-e.position.q-e.position.r)))<=o.attackRange))return!0;if(t.anthills&&Object.values(t.anthills).some(e=>e.owner!==r.owner&&Math.max(Math.abs(r.position.q-e.position.q),Math.abs(r.position.r-e.position.r),Math.abs(-r.position.q-r.position.r-(-e.position.q-e.position.r)))<=o.attackRange))return!0;if("drone"===r.type&&t.resourceNodes&&Object.values(t.resourceNodes).some(e=>e.position.q===r.position.q&&e.position.r===r.position.r))return!0;return!1})(ce,r)?he(null):(he(null),ue(null))},p)}else hn("Invalid move!");return}if("teleport"===de&&ce){t.ants[ce];const n=(0,a.getValidTeleportDestinations)(t,ce).find(t=>Qt(t.position,e));if(n){const e=(0,a.teleportAnt)(t,ce,n.id);rn(e),he(null),ue(null)}else hn("Invalid teleport destination! Must click on a friendly anthill.");return}if("heal"===de&&ce){const n=t.ants[ce];if(!n||"healer"!==n.type)return;const r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner===n.owner);if(r){const e=(0,a.healAlly)(t,ce,r.id);rn(e),he(null),ue(null)}else hn("Invalid heal target! Must click on a wounded ally.");return}if("ensnare"===de&&ce){const n=t.ants[ce];if(!n||"healer"!==n.type)return;const r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==n.owner);if(r){const e=(0,a.ensnareEnemy)(t,ce,r.id);rn(e),he(null),ue(null)}else hn("Invalid ensnare target! Must click on an enemy unit.");return}if("cordyceps"===de&&ce){const n=t.ants[ce];if(!n||"cordyphage"!==n.type)return;const r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==n.owner);if(r){if("queen"===r.type)return void hn("Cannot mind control queens!");const e=(0,a.cordycepsPurge)(t,ce,r.id);rn(e),he(null),ue(null)}else hn("Invalid Cordyceps target! Must click on an enemy unit (not queen).");return}if("plague"===de&&ce){const n=t.ants[ce];if(!n||"cordyphage"!==n.type)return;const r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==n.owner);if(r){const e=(0,a.plagueEnemy)(t,ce,r.id);if(e===t)return void hn("Cannot plague this target! Already plagued or out of energy.");rn(e),he(null),ue(null)}else hn("Invalid plague target! Must click on an enemy unit.");return}if("reveal"===de&&ce){const n=t.ants[ce];if(!n||"queen"!==n.type)return;const r=(0,a.revealArea)(t,ce,e);if(r===t)return void hn("Cannot use Reveal! Check energy and upgrade requirements.");const o="pheromone_".concat(Date.now(),"_").concat(Math.random());return console.log("[PHEROMONE] Starting animation:",{animId:o,centerHex:e,timestamp:Date.now()}),_t(t=>{const n=[...t,{id:o,centerHex:e,currentStep:0,timestamp:Date.now()}];return console.log("[PHEROMONE] Updated animations array:",n),n}),rn(r),he(null),void ue(null)}if("bombardier_splash"===de&&ce){const n=t.ants[ce];if(!n||"bombardier"!==n.type)return;const r=l.xr.BOMBARDIER,o=Math.max(Math.abs(n.position.q-e.q),Math.abs(n.position.r-e.r),Math.abs(-n.position.q-n.position.r-(-e.q-e.r)));if(o<r.minAttackRange||o>r.attackRange)return void hn("Target is out of range! Must be 2-3 hexes away.");if(!pt||!Qt(pt,e))return ft(e),void ht(0);if(Qt(pt,e)){Yt(e,dt);const n=(0,s.bombardierSplashAttack)(t,ce,e,dt);return le(!0),void setTimeout(()=>{rn((0,i.A)((0,i.A)({},n.gameState),{},{ants:(0,i.A)((0,i.A)({},n.gameState.ants),{},{[ce]:(0,i.A)((0,i.A)({},n.gameState.ants[ce]),{},{hasAttacked:!0})})})),n.damageDealt&&n.damageDealt.length>0&&(qe(n.damageDealt),setTimeout(()=>qe([]),1e3)),le(!1),he(null),ue(null),ft(null),ht(0)},500)}}const o=Object.values(t.eggs).find(t=>Qt(t.position,e));if(o)return Pe(o),ue(null),he(null),void Oe(null);if(ce&&"move"===de){const n=t.ants[ce],r=Object.values(t.ants).find(t=>Qt(t.position,e)&&t.owner!==n.owner);if(r){const o=(0,l.s1)(n.type);if((0,s.canAttack)(n,r,t))return he("attack"),void setTimeout(()=>mn(e),0);if(n.hasMoved)return void hn("This unit has already moved and cannot reach the enemy!");const i=(0,c.getMovementRange)(n.position,o.moveRange,Vt,[],Gt).filter(e=>{if(Object.values(t.ants).some(t=>t.id!==n.id&&t.owner===n.owner&&Qt(t.position,e)))return!1;const i=Math.max(Math.abs(e.q-r.position.q),Math.abs(e.r-r.position.r),Math.abs(-e.q-e.r-(-r.position.q-r.position.r)));return i<=o.attackRange&&(!o.minAttackRange||i>=o.minAttackRange)});if(0===i.length)return void hn("Cannot reach enemy to attack!");if(1===i.length){const e=i[0],n=(0,s.moveAnt)(t,ce,e),o=(0,a.markAntMoved)(n,ce);return rn(o),he("attack"),void setTimeout(()=>mn(r.position),100)}return at(r),lt(i),void hn("Click on a hex to attack from (highlighted in red)")}}if(it&&st.length>0){const n=st.find(t=>Qt(t,e));if(n){t.ants[ce];const e=(0,s.moveAnt)(t,ce,n),r=(0,a.markAntMoved)(e,ce);return rn(r),lt([]),he("attack"),void setTimeout(()=>{mn(it.position),at(null)},100)}at(null),lt([])}if(ce&&!de){const n=t.ants[ce];if(n&&"drone"===n.type&&!n.hasBuilt){if(Object.values(t.resources).find(t=>Qt(t.position,e))){if(1===Math.max(Math.abs(n.position.q-e.q),Math.abs(n.position.r-e.r),Math.abs(-n.position.q-n.position.r-(-e.q-e.r))))return he("buildAnthill"),void setTimeout(()=>mn(e),0)}}}const u=Object.values(t.ants).find(t=>Qt(t.position,e));if(u){const e=Date.now(),n=ce===u.id&&ge.antId===u.id&&e-ge.time<500;if(me({antId:u.id,time:e}),ce===u.id){if(n&&"drone"===u.type&&u.owner===t.currentPlayer&&on()){const e=Object.values(t.resources).find(e=>e.position.q===u.position.q&&e.position.r===u.position.r),n=Object.values(t.anthills||{}).find(e=>e.position.q===u.position.q&&e.position.r===u.position.r&&!e.isComplete);if(e||n)return void he("build")}return ue(null),he(null),Pe(null),void ve({antId:u.id,time:e})}if(be)return void console.log("Preventing ant selection - Escape was just pressed");if(ye.antId===u.id&&e-ye.time<100)return void console.log("Preventing reselection of ant that was just deselected:",u.id);const r=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:t.currentPlayer,o=u.owner===r;if(console.log("Ant click check:",{clickedAntOwner:u.owner,currentPlayerId:r,isOwnAnt:o,isMyTurn:on(),gameCurrentPlayer:t.currentPlayer,playerRole:null===Z||void 0===Z?void 0:Z.playerRole}),o&&on())if(ue(u.id),"queen"===u.type){const e=(0,a.getEggLayCost)(u);(0,a.hasEnoughEnergy)(u,e)?he("layEgg"):he(null)}else u.hasMoved||u.hasAttacked?(console.log("Clearing selectedAction - unit has already moved/attacked",{antId:u.id,hasMoved:u.hasMoved,hasAttacked:u.hasAttacked}),he(null)):(console.log("Auto-selecting move action for ant that hasnt moved/attacked"),he("move"));else ue(u.id),he(null);return Pe(null),void Oe(null)}const d=Object.values(t.anthills).find(t=>Qt(t.position,e));if(d&&d.isComplete)return Oe(d),ue(null),void he(null);(ce||Me)&&(ue(null),he(null),Oe(null),Pe(null))},yn=(e,t)=>{const n=nn(),r=n.players[n.currentPlayer],o=e.toLowerCase(),s=Object.values(n.ants).find(e=>"queen"===e.type&&e.owner===n.currentPlayer);if(!s)return void hn("No queen found!");const l=(0,a.getEggLayCost)(s);if(!(0,a.hasEnoughEnergy)(s,l))return void hn("Not enough energy! Need ".concat(l," energy to lay an egg."));if(!(0,a.canAfford)(r,o))return void hn("Not enough resources!");const c=t||(Ce&&!Ce.antType?Ce:null);if(!c)return void hn("Select a tile next to your queen to lay the egg!");const u=(0,a.createEgg)(o,n.currentPlayer,c,n.turn),d=(0,a.deductCost)(r,o),h=(0,a.deductEnergy)(s,l);rn((0,i.A)((0,i.A)({},n),{},{players:(0,i.A)((0,i.A)({},n.players),{},{[n.currentPlayer]:d}),eggs:(0,i.A)((0,i.A)({},n.eggs),{},{[u.id]:u}),ants:(0,i.A)((0,i.A)({},n.ants),{},{[s.id]:h})})),he(null),ue(null),Ae(null),Te(!1)},vn=()=>{const e=nn(),t=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:e.currentPlayer,n=Object.values(e.ants).filter(e=>e.owner===t&&e.position&&bn(e));if(0===n.length)return void hn("No ants with available actions!");let r=-1;ce&&(r=n.findIndex(e=>e.id===ce));const o=n[(r+1)%n.length];if(!o||!o.position)return void console.error("Next ant has no position:",o);ue(o.id),Pe(null),"queen"===o.type?he("layEgg"):he("move");const i=(0,c.hexToPixel)(o.position,Ut);Nt({x:-i.x,y:-i.y})},bn=e=>{if(!e)return!1;const t=nn();if(e.owner!==t.currentPlayer)return!1;const n=(0,l.s1)(e.type);if("queen"===e.type){const t=(0,a.getEggLayCost)(e);return(0,a.hasEnoughEnergy)(e,t)}if(e.hasAttacked)return!1;if(e.hasMoved){if(n.canBuildAnthill){return Object.values(t.ants).filter(t=>{if(t.owner===e.owner||!t.position||!e.position)return!1;const r=Math.max(Math.abs(e.position.q-t.position.q),Math.abs(e.position.r-t.position.r),Math.abs(-e.position.q-e.position.r-(-t.position.q-t.position.r)));return r>=(n.minAttackRange||0)&&r<=n.attackRange}).length>0}return Object.values(t.ants).filter(t=>{if(t.owner===e.owner||!t.position||!e.position)return!1;const r=Math.max(Math.abs(e.position.q-t.position.q),Math.abs(e.position.r-t.position.r),Math.abs(-e.position.q-e.position.r-(-t.position.q-t.position.r)));return r>=(n.minAttackRange||0)&&r<=n.attackRange}).length>0}return!0},xn=()=>{if(!ce||!te.ants[ce])return ce&&console.log("getValidMovesForSelectedAnt: Selected ant not in gameState, clearing"),[];const e=te.ants[ce],t=Z.isMultiplayer?Z.playerRole:"player1";if(e.owner!==t)return[];const r=(0,l.s1)(e.type);if(console.log("getValidMovesForSelectedAnt:",{selectedAnt:ce,selectedAction:de,antType:null===r||void 0===r?void 0:r.id,hasMoved:e.hasMoved}),"move"===de){if(e.hasMoved)return console.log("getValidMovesForSelectedAnt: Ant has already moved"),[];if("queen"===e.type)return[];const t=[...Object.values(te.ants).filter(t=>t.owner!==e.owner).map(e=>new c.HexCoord(e.position.q,e.position.r))],i=[...Object.values(te.trees||{}).map(e=>new c.HexCoord(e.position.q,e.position.r))];let a=r.moveRange;const s=nn().players[e.owner];if(null!==s&&void 0!==s&&s.heroAbilityActive&&"gorlak"===s.heroId&&r.attackRange<=1){var o;const{getHeroById:e}=n(201),t=e(s.heroId);null!==t&&void 0!==t&&null!==(o=t.heroAbility)&&void 0!==o&&o.meleeMoveBonus&&(a+=t.heroAbility.meleeMoveBonus)}if(e.isBurrowed){if("soldier"!==e.type)return[];a=1}e.ensnared&&e.ensnared>0&&(a=0);const l=new c.HexCoord(e.position.q,e.position.r);console.log("getValidMovesForSelectedAnt: Computing movement range",{startHex:l.toString(),range:a,gridRadius:Vt,blockedCount:t.length,mapShape:Gt});const u=(0,c.getMovementRangeWithPaths)(l,a,Vt,t,i,Gt);console.log("getValidMovesForSelectedAnt: movesWithPaths result:",u.length,"hexes");const d=u.map(e=>e.hex),h=i.filter(t=>(0,c.hexDistance)(e.position,t)<=a);return console.log("getValidMovesForSelectedAnt: Returning",d.length,"move hexes +",h.length,"tree hexes"),[...d,...h]}if("layEgg"===de&&"queen"===e.type){const t=(0,a.getSpawningPoolHexes)(e,c.getNeighbors);console.log("getValidMovesForSelectedAnt: layEgg action, spawningPool:",t.length,"hexes");const n=t.filter(e=>!(Object.values(te.ants).some(t=>Qt(t.position,e))||Object.values(te.eggs).some(t=>Qt(t.position,e))||Object.values(te.trees||{}).some(t=>Qt(t.position,e))));return console.log("getValidMovesForSelectedAnt: After filtering, valid spawn hexes:",n.length),n}return[]},wn=e=>({"#FF0000":"aura_red.png","#00FF00":"aura_green.png","#0000FF":"aura_blue.png","#FFFF00":"aura_yellow.png","#000000":"aura_black.png"}[e]||"aura_red.png"),_n=function(e){const t={queen:"Queen",scout:"Scout",drone:"Drone",soldier:"Marauder",tank:"Bullet",spitter:"Acid",healer:"Weaver",bomber:"Exploding",bombardier:"Bombardier",cordyphage:"Cordyceps"}[e],n={queen:"queen",scout:"scout",drone:"drone",soldier:"marauder",tank:"bullet",spitter:"acid",healer:"weaver",bomber:"exploding",bombardier:"bombardier",cordyphage:"cordyphage"}[e];if(t&&n){const e={"#FF0000":"red","#00FF00":"green","#0000FF":"blue","#FFFF00":"yellow","#000000":"black"}[arguments.length>1&&void 0!==arguments[1]?arguments[1]:null]||"red";return"sprites/ants/".concat(t,"/").concat(n,"_idle_").concat(e,".png")}return"sprites/ants/".concat(e,"_idle_red.png")};return(0,x.jsxs)("div",{className:"App",style:{padding:"10px",backgroundColor:"#f0f0f0",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,x.jsx)("div",{style:{margin:"0 0 10px 0",fontSize:"20px",fontWeight:"bold",minHeight:"30px",color:Ne?"#d32f2f":"transparent",backgroundColor:Ne?"rgba(211, 47, 47, 0.1)":"transparent",padding:"5px 15px",borderRadius:"8px",border:Ne?"2px solid #d32f2f":"2px solid transparent",transition:"all 0.3s ease",textAlign:"center"},children:Ne||"\xa0"}),(0,x.jsxs)("div",{style:{display:"flex",gap:"20px",justifyContent:"center",alignItems:"flex-start",width:"100%"},children:[(0,x.jsx)("div",{style:{width:"250px",backgroundColor:"#fff",padding:"15px",borderRadius:"8px",maxHeight:"calc(100vh - 80px)",overflowY:"auto"},children:on()?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>ot(!0),style:{width:"100%",padding:"15px",fontSize:"16px",fontWeight:"bold",backgroundColor:"#9C27B0",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",marginBottom:"20px"},children:"\u26a1 Upgrades"}),(0,x.jsx)("h3",{style:{margin:"0 0 10px 0",fontSize:"18px"},children:"Build Ants"}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"6px"},children:["drone","scout","soldier","spitter","bomber","bombardier","tank","healer","cordyphage"].map(e=>(0,l.s1)(e)).filter(e=>e).map(e=>{var t;const r=te.players[te.currentPlayer],o=(0,a.canAfford)(r,e.id),{applyHeroCostModifier:i}=n(201),s=r.heroId?i(e.cost,r.heroId):e.cost,c=Object.values(te.ants).find(e=>"queen"===e.type&&e.owner===te.currentPlayer),u=(null===c||void 0===c?void 0:c.queenTier)||"queen";let d=!1;e.requiresQueenTier&&("broodQueen"===e.requiresQueenTier?d="queen"===u:"swarmQueen"===e.requiresQueenTier&&(d="swarmQueen"!==u));let h=e.description;if(d&&e.requiresQueenTier){var p;const t=(null===(p=l.mZ[e.requiresQueenTier])||void 0===p?void 0:p.name)||e.requiresQueenTier;h="Requires ".concat(t,". ").concat(e.description)}const f={drone:"D",scout:"S",soldier:"O",tank:"T",spitter:"I",bomber:"X",bombardier:"R",healer:"W",cordyphage:"C"}[e.id];return(0,x.jsx)("button",{onClick:()=>{if(c){if(d&&e.requiresQueenTier){var t;const n=(null===(t=l.mZ[e.requiresQueenTier])||void 0===t?void 0:t.name)||e.requiresQueenTier;return void hn("This unit requires ".concat(n,"!"))}o?(ue(c.id),he("layEgg"),Te(!1),Ae({antType:e.id})):hn("Not enough resources!")}else hn("You need a queen to lay eggs!")},disabled:!o||!on()||d,title:h,style:{padding:"8px 10px",fontSize:"14px",backgroundColor:d?"#999":o?"#4CAF50":"#ccc",color:d||!o?"#666":"white",border:"none",borderRadius:"6px",cursor:o&&on()&&!d?"pointer":"not-allowed",textAlign:"left",opacity:on()?1:.6},children:(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,x.jsx)("div",{style:{width:"64px",height:"64px",overflow:"hidden",flexShrink:0},children:(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/").concat(_n(e.id,null===(t=te.players[te.currentPlayer])||void 0===t?void 0:t.color)),alt:e.name,style:{height:"32px",imageRendering:"pixelated",objectFit:"none",objectPosition:"0 0",transform:"scale(2)",transformOrigin:"top left"}})}),(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsxs)("div",{style:{fontWeight:"bold",fontSize:"14px"},children:[e.name," ",f&&"(".concat(f,")")]}),(0,x.jsxs)("div",{style:{fontSize:"12px",marginTop:"3px"},children:["Cost: ",s.food,"\ud83c\udf43 ",s.minerals,"\ud83d\udc8e"]}),(0,x.jsx)("div",{style:{fontSize:"11px",marginTop:"2px",opacity:.85,lineHeight:"1.2"},children:e.description})]})]})},e.id)})})]}):(0,x.jsxs)("div",{style:{textAlign:"center",padding:"20px 0"},children:[(0,x.jsx)("h3",{style:{margin:"0 0 12px 0",fontSize:"18px",color:"#888"},children:"Opponent's Turn"}),(0,x.jsx)("p",{style:{fontSize:"14px",color:"#666"},children:"Waiting for opponent..."})]})}),(0,x.jsx)("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",minWidth:0},children:(0,x.jsx)("div",{style:{backgroundImage:"url(".concat(H,")"),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",border:"2px solid #333",display:"inline-block",maxWidth:"100%",maxHeight:"calc(100vh - 80px)",overflow:"hidden"},children:(0,x.jsxs)("svg",{width:Zt.width,height:Zt.height,viewBox:"0 0 ".concat(Zt.width," ").concat(Zt.height),style:{cursor:qt?"grabbing":"default",display:"block",background:"transparent"},onMouseDown:e=>{(1===e.button||0===e.button&&e.ctrlKey)&&(e.preventDefault(),Lt(!0),Ht({x:e.clientX-Ot.x,y:e.clientY-Ot.y}))},onMouseMove:e=>{qt&&Nt({x:e.clientX-zt.x,y:e.clientY-zt.y})},onMouseUp:Xt,onMouseLeave:Xt,onWheel:e=>{e.preventDefault();const t=e.deltaY>0?-.1:.1,n=Math.max(.5,Math.min(2,Dt+t));Ft(n)},onClick:e=>console.log("SVG onClick event",{target:e.target.tagName,clientX:e.clientX,clientY:e.clientY}),children:[(0,x.jsx)("defs",{children:Object.values(te.ants).map(e=>(0,x.jsx)("clipPath",{id:"clip-".concat(e.id),children:(0,x.jsx)("rect",{x:-40,y:-40,width:80,height:80})},"clip-".concat(e.id)))}),(0,x.jsxs)("g",{transform:"translate(".concat(Zt.width/2,", ").concat(Zt.height/2,") scale(").concat(Dt,") translate(").concat(Ot.x,", ").concat(Ot.y,")"),children:[(()=>{const e=[],t=xn(),n="attack"===de?fn():[],r="teleport"===de&&ce?(0,a.getValidTeleportDestinations)(nn(),ce):[],o="heal"===de&&ce?(0,a.getValidHealTargets)(nn(),ce):[],i="ensnare"===de&&ce?(0,a.getValidEnsnareTargets)(nn(),ce):[],s="cordyceps"===de&&ce?(0,a.getValidCordycepsTargets)(nn(),ce):[],u="plague"===de&&ce?(0,a.getValidPlagueTargets)(nn(),ce):[],d=(()=>{if("reveal"!==de||!ce)return[];const e=nn().ants[ce];if(!e||"queen"!==e.type)return[];const t=[];for(let n=-Vt;n<=Vt;n++)for(let e=-Vt;e<=Vt;e++){const r=-n-e;if(Math.abs(n)>Vt||Math.abs(e)>Vt||Math.abs(r)>Vt)continue;const o=new c.HexCoord(n,e);t.push(o)}return t})(),h=(()=>{if("bombardier_splash"!==de||!ce)return[];const e=nn().ants[ce];if(!e||"bombardier"!==e.type)return[];if(pt)return[];const t=l.xr.BOMBARDIER,n=[];for(let r=-Vt;r<=Vt;r++)for(let o=-Vt;o<=Vt;o++){const i=-r-o;if(Math.abs(r)>Vt||Math.abs(o)>Vt||Math.abs(i)>Vt)continue;const a=new c.HexCoord(r,o),s=Math.max(Math.abs(e.position.q-a.q),Math.abs(e.position.r-a.r),Math.abs(-e.position.q-e.position.r-(-a.q-a.r)));s>=t.minAttackRange&&s<=t.attackRange&&n.push(a)}return n})(),p="bombardier_splash"===de&&pt?Yt(pt,dt):[];let f=null;const g=re||te;g&&Z&&(Z.isMultiplayer&&Z.playerRole&&!1!==Z.fogOfWar?f=y(g,Z.playerRole):Z.isAI&&!1!==Z.fogOfWar&&(f=y(g,"player1")));const m=(0,x.jsxs)("defs",{children:[(0,x.jsxs)("pattern",{id:"birthingPoolPattern",x:"0",y:"0",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:[(0,x.jsx)("circle",{cx:"5",cy:"5",r:"1.5",fill:"#6A0DAD",opacity:"0.4"}),(0,x.jsx)("circle",{cx:"15",cy:"10",r:"1",fill:"#6A0DAD",opacity:"0.3"}),(0,x.jsx)("circle",{cx:"10",cy:"15",r:"1.2",fill:"#4B0082",opacity:"0.5"}),(0,x.jsx)("circle",{cx:"2",cy:"12",r:"0.8",fill:"#8B008B",opacity:"0.4"}),(0,x.jsx)("circle",{cx:"18",cy:"3",r:"1",fill:"#6A0DAD",opacity:"0.3"})]}),(0,x.jsxs)("radialGradient",{id:"birthingPoolGradient",cx:"50%",cy:"50%",r:"50%",children:[(0,x.jsx)("stop",{offset:"0%",stopColor:"#9932CC",stopOpacity:"1"}),(0,x.jsx)("stop",{offset:"70%",stopColor:"#6A0DAD",stopOpacity:"1"}),(0,x.jsx)("stop",{offset:"100%",stopColor:"#4B0082",stopOpacity:"1"})]})]});let v=[];const b=te.mapShape||"rectangle",w="triangle"===b?l.sv.TRIANGLE_SIDE_LENGTH:"square"===b?l.sv.SQUARE_SIZE:Vt;if("triangle"===b)v=(0,c.generateTriangleGrid)(w);else if("square"===b)v=(0,c.generateSquareGrid)(w,Math.floor(.75*w));else for(let a=-Vt;a<=Vt;a++)for(let e=-Vt;e<=Vt;e++){const t=-a-e;Math.abs(a)<=Vt&&Math.abs(e)<=Vt&&Math.abs(t)<=Vt&&v.push(new c.HexCoord(a,e))}for(const l of v){var _,k,S;const{q:g,r:m}=l,{x:y,y:v}=(0,c.hexToPixel)(l,Ut),b=Object.values(te.ants).find(e=>Qt(e.position,l)),w=Object.values(te.eggs).find(e=>Qt(e.position,l)),C=Object.values(te.resources).find(e=>Qt(e.position,l)),A=Object.values(te.trees||{}).find(e=>Qt(e.position,l)),E=Object.values(te.anthills||{}).find(e=>Qt(e.position,l)),T=t.some(e=>Qt(e,l)),R=ce&&Qt(null===(_=te.ants[ce])||void 0===_?void 0:_.position,l),j=n.some(e=>Qt(e.position,l)),I=r.some(e=>Qt(e.position,l)),P=o.some(e=>Qt(e.position,l)),M=i.some(e=>Qt(e.position,l)),O=s.some(e=>Qt(e.position,l)),N=u.some(e=>Qt(e.position,l)),D=d.some(e=>Qt(e,l)),F=h.some(e=>Qt(e,l)),q=p.some(e=>Qt(e,l)),L=st.some(e=>Qt(e,l)),z="".concat(g,",").concat(m),H=!f||f.has(z),B=!0;let W=!1,U=null;Object.values(te.ants).forEach(e=>{if("queen"!==e.type)return;if(Qt(e.position,l))return W=!0,void(U=e.owner);(0,a.getSpawningPoolHexes)(e,c.getNeighbors).some(e=>Qt(e,l))&&(W=!0,U=e.owner)});const V="".concat(g,",").concat(m);let G=Ct.get(V)||"#8B7355",Q=!1;W&&(G="url(#birthingPoolGradient)",Q=!0),T&&(G=H?"#AED6F1":"#8B9DC3",Q=!1),j&&(G="#FF6B6B",Q=!1),I&&(G="#BB8FCE",Q=!1),P&&(G="#90EE90",Q=!1),M&&(G="#F0E68C",Q=!1),O&&(G="#8e44ad",Q=!1),N&&(G="#9B59B6",Q=!1),D&&(G="#5DADE2",Q=!1),F&&(G="#ff6b35",Q=!1),q&&(G="#FF1744",Q=!1),L&&(G="#FF4444",Q=!1),R&&(G="#F9E79F",Q=!1),e.push((0,x.jsxs)("g",{transform:"translate(".concat(y,", ").concat(v,")"),children:[(0,x.jsx)("polygon",{points:"50,0 25,-43 -25,-43 -50,0 -25,43 25,43",fill:G,stroke:R?"#F39C12":W?"#4B0082":"#333",strokeWidth:R?"3":W?"2.5":"2",style:{cursor:"pointer"},onClick:()=>mn(l),onContextMenu:e=>{e.preventDefault(),ue(null),he(null),Pe(null),Oe(null)},onMouseEnter:e=>{T&&fe(l)},onMouseLeave:()=>{T&&fe(null)},onAuxClick:e=>{1===e.button&&T&&"move"===de&&(e.preventDefault(),ke&&Qt(ke,l)?Se(null):Se(l))}}),Q&&(0,x.jsx)("polygon",{points:"50,0 25,-43 -25,-43 -50,0 -25,43 25,43",fill:"url(#birthingPoolPattern)",style:{pointerEvents:"none"}}),(0,x.jsxs)("text",{x:"-15",y:"-18",fontSize:"8",fill:"#000",fontWeight:"bold",style:{pointerEvents:"none",userSelect:"none"},children:[String.fromCharCode(65+g+6),m+7]}),E&&(0,x.jsxs)("g",{transform:b?"translate(15, -15)":"",children:[(0,x.jsx)("text",{textAnchor:"middle",dy:"0.3em",fontSize:"24",fontWeight:"bold",style:{pointerEvents:"none",opacity:E.isComplete?1:.6},children:E.isComplete?"\u26f0\ufe0f":"\ud83d\udea7"}),E.isComplete&&(0,x.jsx)("text",{x:"12",y:"10",fontSize:"14",fontWeight:"bold",style:{pointerEvents:"none"},children:"food"===E.resourceType?"\ud83c\udf43":"\ud83d\udc8e"}),(0,x.jsx)("circle",{cx:"15",cy:"-15",r:"8",fill:(null===(k=te.players[E.owner])||void 0===k?void 0:k.color)||"#999",stroke:"#333",strokeWidth:"1.5",style:{pointerEvents:"none"}}),te.playerCount>=3&&(null===(S=te.players[E.owner])||void 0===S?void 0:S.team)&&(0,x.jsxs)("g",{transform:"translate(-15, -15)",children:[(0,x.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"A"===te.players[E.owner].team?"#ff69b4":"#222",stroke:"A"===te.players[E.owner].team?"#ff1493":"#000",strokeWidth:"1.5",style:{pointerEvents:"none"}}),(0,x.jsx)("text",{textAnchor:"middle",dy:"0.35em",fontSize:"10",fill:"A"===te.players[E.owner].team?"#000":"#fff",fontWeight:"bold",style:{pointerEvents:"none"},children:te.players[E.owner].team})]}),(0,x.jsxs)("g",{transform:"translate(0, 20)",children:[(0,x.jsx)("rect",{x:"-20",y:"0",width:"40",height:"4",fill:"#333",style:{pointerEvents:"none"}}),E.isComplete?(0,x.jsx)("rect",{x:"-20",y:"0",width:E.health/20*40,height:"4",fill:E.health>10?"#2ecc71":E.health>5?"#f39c12":"#e74c3c",style:{pointerEvents:"none"}}):(0,x.jsx)("rect",{x:"-20",y:"0",width:E.buildProgress/2*40,height:"4",fill:"#FFA500",style:{pointerEvents:"none"}})]}),!E.isComplete&&(0,x.jsxs)("text",{textAnchor:"middle",y:"30",fontSize:"10",fill:"#FFA500",fontWeight:"bold",style:{pointerEvents:"none"},children:[E.buildProgress,"/2"]})]}),w&&(e=>{const t=null===(e=te.players[w.owner])||void 0===e?void 0:e.color,n=te.players[w.owner],r=It(w.id,t),o=1.875;return r?(0,x.jsxs)("g",{children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"egg-clip-".concat(w.id),children:(0,x.jsx)("rect",{x:"-30",y:"-30",width:"60",height:"60"})})}),(0,x.jsx)("image",{href:r.fullPath,x:-30-r.currentFrame*r.frameWidth*o,y:"-30",width:r.frameWidth*r.frames*o,height:r.frameHeight*o,clipPath:"url(#egg-clip-".concat(w.id,")"),style:{pointerEvents:"none"}}),te.playerCount>=3&&(null===n||void 0===n?void 0:n.team)&&(0,x.jsxs)("g",{transform:"translate(18, -18)",children:[(0,x.jsx)("circle",{cx:"0",cy:"0",r:"8",fill:"A"===n.team?"#ff69b4":"#222",stroke:"A"===n.team?"#ff1493":"#000",strokeWidth:"1.5",style:{pointerEvents:"none"}}),(0,x.jsx)("text",{textAnchor:"middle",dy:"0.35em",fontSize:"10",fill:"A"===n.team?"#000":"#fff",fontWeight:"bold",style:{pointerEvents:"none"},children:n.team})]})]}):null})(),A&&B&&(0,x.jsx)("image",{x:-32,y:-32,width:64,height:64,href:"".concat("/Battle-Ants","/sprites/ants/Misc/tree_sprite.png"),style:{pointerEvents:"none"},onError:e=>{console.error("Failed to load tree sprite")}}),C&&!E&&H&&(0,x.jsxs)("g",{transform:b?"translate(15, -15)":"",children:[(0,x.jsx)("circle",{cx:"0",cy:"0",r:"20",fill:"food"===C.type?"#90EE90":"#FFD700",opacity:"0.8",style:{pointerEvents:"none"}}),(0,x.jsx)("text",{textAnchor:"middle",dy:"0.3em",fontSize:"16",fontWeight:"bold",style:{pointerEvents:"none"},children:"food"===C.type?"\ud83c\udf43":"\ud83d\udc8e"})]}),b&&b.type&&null,!H&&(0,x.jsx)("polygon",{points:"50,0 25,-43 -25,-43 -50,0 -25,43 25,43",fill:"rgba(0, 0, 0, 0.7)",style:{pointerEvents:"none"}}),(()=>Object.values(te.deadAnts||{}).find(e=>e.position.q===g&&e.position.r===m)?(0,x.jsx)("image",{x:-40,y:-40,width:80,height:80,href:"".concat("/Battle-Ants","/sprites/ants/Misc/dead_ant.png"),style:{pointerEvents:"none",opacity:.8},onError:e=>{console.error("Failed to load dead ant sprite")}}):null)(),(()=>{wt.length>0&&console.log("[PHEROMONE RENDER] Checking hex:",l,"against animations:",wt);for(const e of wt){const t=Kt(e.centerHex)[e.currentStep%6];if(Qt(t,l)){console.log("[PHEROMONE RENDER] SHOWING effect at hex:",l,"step:",e.currentStep);const t=32*(Math.floor(Date.now()/100)%8);return(0,x.jsxs)("g",{transform:"translate(-32, -32) scale(2)",children:[(0,x.jsx)("defs",{children:(0,x.jsx)("pattern",{id:"pheromone-pattern-".concat(e.id),x:-t,y:0,width:256,height:32,patternUnits:"userSpaceOnUse",children:(0,x.jsx)("image",{x:0,y:0,width:256,height:32,href:"".concat("/Battle-Ants","/sprites/ants/Effects/pheromone_effect.png"),style:{imageRendering:"pixelated"},onError:e=>{console.error("Failed to load pheromone effect sprite")},onLoad:e=>{console.log("[PHEROMONE RENDER] Successfully loaded sprite")}})})}),(0,x.jsx)("rect",{x:0,y:0,width:32,height:32,fill:"url(#pheromone-pattern-".concat(e.id,")"),opacity:.8,style:{pointerEvents:"none"}})]})}}return null})()]},"".concat(g,",").concat(m)))}const C=[];if(pe&&we.size>0){let e=null;if(ke){const t=ke.toString(),n=pe.toString(),r=we.get(t),o=we.get(n);if(r&&o){r.length;const t=te.ants[ce];if(t&&t.type&&l.xr[t.type]){let n=l.xr[t.type].movement;t.ensnared&&t.ensnared>0&&(n=0);const o=n-(r.length-1);if(o>0&&!Qt(ke,pe)){const n=Object.values(te.ants).filter(e=>e.id!==t.id&&(!e.burrowed||e.owner!==t.owner)).map(e=>new c.HexCoord(e.position.q,e.position.r)),i=(0,c.getMovementRangeWithPaths)(ke,o,Vt,n,[],b).find(e=>{let{hex:t}=e;return Qt(t,pe)});i&&(e=[...r,...i.path.slice(1)])}}}}if(!e){const t=pe.toString();e=we.get(t)}if(e&&e.length>0){for(let t=0;t<e.length;t++){const n=e[t],{x:r,y:o}=(0,c.hexToPixel)(n,Ut);if(t<e.length-1){const n=e[t+1],{x:i,y:a}=(0,c.hexToPixel)(n,Ut),s=i-r,l=a-o,u=Math.atan2(l,s),d=ke&&t<e.findIndex(e=>Qt(e,ke));C.push((0,x.jsxs)("g",{children:[(0,x.jsx)("line",{x1:r,y1:o,x2:i,y2:a,stroke:d?"#FFA500":"#FF0000",strokeWidth:"3",style:{pointerEvents:"none"}}),(0,x.jsx)("polygon",{points:"0,-6 12,0 0,6",fill:d?"#FFA500":"#FF0000",transform:"translate(".concat(i,", ").concat(a,") rotate(").concat(180*u/Math.PI,")"),style:{pointerEvents:"none"}})]},"path-".concat(t)))}else C.push((0,x.jsx)("circle",{cx:r,cy:o,r:"10",fill:"none",stroke:"#FF0000",strokeWidth:"3",style:{pointerEvents:"none"}},"path-end-".concat(t)))}if(ke){const{x:e,y:t}=(0,c.hexToPixel)(ke,Ut);C.push((0,x.jsx)("circle",{cx:e,cy:t,r:"8",fill:"#FFA500",stroke:"#FFFFFF",strokeWidth:"2",style:{pointerEvents:"none"}},"waypoint-marker"))}}}return(0,x.jsxs)(x.Fragment,{children:[m,e,C]})})(),(()=>{const e=[],t=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:"player1";let n=!1;return Z&&(Z.isMultiplayer&&Z.playerRole&&!1!==Z.fogOfWar||Z.isAI&&!1!==Z.fogOfWar)&&(n=!0),Object.values(te.ants).forEach(r=>{var o;if(!r||!r.type)return;const i=r.owner!==t,a=Object.values(te.trees||{}).some(e=>Qt(e.position,r.position));if(i&&a&&n){const e=r.position,n=(0,c.getNeighbors)(e);if(!Object.values(te.ants).some(r=>r.owner===t&&(Qt(r.position,e)||n.some(e=>Qt(e,r.position)))))return}const{x:u,y:d}=(0,c.hexToPixel)(r.position,Ut);let h="";if(ct&&ct.antId===r.id){const{path:e,currentStep:t}=ct;if(t<e.length-1){const n=e[t],r=e[t+1],o=(0,c.hexToPixel)(n,Ut),i=(0,c.hexToPixel)(r,Ut),a=i.x-o.x,s=i.y-o.y;h="translate(".concat(a,", ").concat(s,")")}}const p=Le.find(e=>e.attackerId===r.id);let f=h;const g=bn(r);if(p){const e=Date.now()-p.timestamp,t=(0,l.s1)(r.type);let n="";if((null===t||void 0===t?void 0:t.attackRange)>1){const t=Math.min(e/200,1),r=3*Math.sin(t*Math.PI*4)*(1-t),o=3*Math.cos(t*Math.PI*4)*(1-t);n="translate(".concat(r,", ").concat(o,")")}else{const t=Math.min(e/300,1),o=t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,i=p.targetPos.q-r.position.q,a=p.targetPos.r-r.position.r,s=Math.sqrt(i*i+a*a),l=20;if(s>0){const e=a/s*l*o*(o<.5?2:2-2*o);n="translate(".concat(i/s*l*o*(o<.5?2:2-2*o),", ").concat(e,")")}}f=n?"".concat(h," ").concat(n):h}let m="idle";p?m="attack":ct&&ct.antId===r.id&&(m="walk");const y=null===(o=te.players[r.owner])||void 0===o?void 0:o.color,v=Tt(r.id,r.type,m,y),b=Object.values(te.resources).find(e=>Qt(e.position,r.position)),w=Object.values(te.anthills||{}).find(e=>Qt(e.position,r.position)),_=b||w?"translate(-15, 15)":"",k=f?"".concat(_," ").concat(f):_,S=ct&&ct.antId===r.id?"transform 0.8s linear":"none",C=(ce&&r.id,("attack"===de?fn():[]).some(e=>e.id===r.id)),A=te.players[r.owner],E=null===A||void 0===A?void 0:A.heroAbilityActive;e.push((0,x.jsxs)("g",{transform:"translate(".concat(u,", ").concat(d,") ").concat(k),style:{transition:S},children:[E&&y&&(0,x.jsxs)("g",{opacity:.8,children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"aura-clip-".concat(r.id),children:(0,x.jsx)("circle",{cx:"0",cy:"0",r:"40"})})}),(0,x.jsx)("image",{x:-40-80*yt,y:-40,width:640,height:80,href:"".concat("/Battle-Ants","/sprites/ants/Auras/").concat(wn(y)),clipPath:"url(#aura-clip-".concat(r.id,")"),style:{pointerEvents:"none",imageRendering:"pixelated"}})]}),v&&!r.isBurrowed?(0,x.jsxs)("g",{opacity:g?1:.5,children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"clip-".concat(r.id),children:(0,x.jsx)("rect",{x:"-40",y:"-40",width:"80",height:"80"})})}),(0,x.jsx)("image",{x:-40-v.currentFrame*v.frameWidth*2.5,y:-40,width:v.frameWidth*v.frames*2.5,height:2.5*v.frameHeight,href:v.fullPath,clipPath:"url(#clip-".concat(r.id,")"),style:{pointerEvents:"none",imageRendering:"pixelated"}})]}):null,(!v||r.isBurrowed)&&(0,x.jsx)("text",{textAnchor:"middle",dy:"0.3em",fontSize:"24",fill:"white",style:{pointerEvents:"none",fontWeight:"bold",opacity:g?1:.5},children:r.isBurrowed?"\ud83d\udd73\ufe0f":(0,l.s1)(r.type).icon}),!g&&(0,x.jsx)("text",{textAnchor:"middle",x:"12",y:"-12",fontSize:"14",fill:"#666",style:{pointerEvents:"none",fontWeight:"bold"},children:"\ud83d\udca4"}),r.ensnared&&r.ensnared>0&&(0,x.jsxs)("g",{opacity:.9,children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"ensnare-clip-".concat(r.id),children:(0,x.jsx)("circle",{cx:"0",cy:"0",r:"32"})})}),(0,x.jsx)("image",{x:-32-64*yt,y:-32,width:512,height:64,href:"".concat("/Battle-Ants","/sprites/ants/Effects/ensnare_effect.png"),clipPath:"url(#ensnare-clip-".concat(r.id,")"),style:{pointerEvents:"none",imageRendering:"pixelated"}})]}),r.plagued&&r.plagued>0&&(0,x.jsxs)("g",{opacity:.8,children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"plague-clip-".concat(r.id),children:(0,x.jsx)("circle",{cx:"0",cy:"0",r:"32"})})}),(0,x.jsx)("image",{x:-32-64*yt,y:-32,width:512,height:64,href:"".concat("/Battle-Ants","/sprites/ants/Effects/plague_effect.png"),clipPath:"url(#plague-clip-".concat(r.id,")"),style:{pointerEvents:"none",imageRendering:"pixelated"}})]}),(0,x.jsxs)("g",{transform:"translate(0, 20)",children:[(0,x.jsx)("rect",{x:"-20",y:"0",width:"40",height:"4",fill:"#333",style:{pointerEvents:"none"}}),(0,x.jsx)("rect",{x:"-20",y:"0",width:r.health/r.maxHealth*40,height:"4",fill:r.health>.5*r.maxHealth?"#2ecc71":r.health>.25*r.maxHealth?"#f39c12":"#e74c3c",style:{pointerEvents:"none"}})]}),"queen"===r.type&&void 0!==r.energy&&(0,x.jsxs)("g",{transform:"translate(0, 26)",children:[(0,x.jsx)("rect",{x:"-20",y:"0",width:"40",height:"3",fill:"#333",style:{pointerEvents:"none"}}),(0,x.jsx)("rect",{x:"-20",y:"0",width:r.energy/r.maxEnergy*40,height:"3",fill:"#FFD700",style:{pointerEvents:"none"}})]}),te.playerCount>=3&&(null===A||void 0===A?void 0:A.team)&&(0,x.jsxs)("g",{transform:"translate(22, -22)",children:[(0,x.jsx)("circle",{cx:"0",cy:"0",r:"10",fill:"A"===A.team?"#ff69b4":"#222",stroke:"A"===A.team?"#ff1493":"#000",strokeWidth:"2",style:{pointerEvents:"none"}}),(0,x.jsx)("text",{textAnchor:"middle",dy:"0.35em",fontSize:"12",fill:"A"===A.team?"#000":"#fff",fontWeight:"bold",style:{pointerEvents:"none"},children:A.team})]}),"attack"===de&&ce&&C&&(()=>{const e=te.ants[ce];if(!e)return null;const t=(0,s.calculateDamage)(e,r,nn()),n=Math.round(t/r.maxHealth*100);return(0,x.jsxs)("g",{children:[(0,x.jsx)("rect",{x:"-25",y:"-40",width:"50",height:"18",fill:"rgba(255, 50, 50, 0.9)",stroke:"#fff",strokeWidth:"2",rx:"4",style:{pointerEvents:"none"}}),(0,x.jsxs)("text",{textAnchor:"middle",x:"0",y:"-28",fontSize:"14",fill:"#fff",fontWeight:"bold",style:{pointerEvents:"none"},children:["-",n,"%"]})]})})()]},"ant-overlay-".concat(r.id)))}),e})(),He.map(e=>{let{id:t,startPos:n,endPos:r,timestamp:o}=e;const i=(0,c.hexToPixel)(n,Ut),a=(0,c.hexToPixel)(r,Ut),s=Date.now()-o,l=Math.min(s/300,1),u=i.x+(a.x-i.x)*l,d=i.y+(a.y-i.y)*l;return(0,x.jsx)("g",{transform:"translate(".concat(u,", ").concat(d,")"),children:(0,x.jsx)("circle",{r:"4",fill:"#FF6B00",stroke:"#FF0000",strokeWidth:"2"})},t)}),Fe.map(e=>{let{id:t,damage:n,position:r,timestamp:o}=e;const{x:i,y:a}=(0,c.hexToPixel)(r,Ut),s=(Date.now()-o)/1e3,l=50*-s,u=1-s,d=1+.5*s;return(0,x.jsx)("g",{transform:"translate(".concat(i,", ").concat(a+l,")"),style:{pointerEvents:"none"},children:(0,x.jsxs)("text",{textAnchor:"middle",dy:"0.3em",fontSize:24*d,fontWeight:"bold",fill:"#ff0000",stroke:"#ffffff",strokeWidth:"3",paintOrder:"stroke",opacity:u,children:["-",n]})},t)}),Ve.map(e=>{let{id:t,position:n,timestamp:r}=e;const{x:o,y:i}=(0,c.hexToPixel)(n,Ut),a=(Date.now()-r)/1e3,s=a<.2?a/.2*2:2-(a-.2)/.8,l=1-a;return(0,x.jsx)("g",{transform:"translate(".concat(o,", ").concat(i,")"),style:{pointerEvents:"none"},children:(0,x.jsx)("text",{textAnchor:"middle",dy:"0.3em",fontSize:32*s,fontWeight:"bold",fill:"#ff0000",stroke:"#ffff00",strokeWidth:"4",paintOrder:"stroke",opacity:l,children:"!"})},t)}),Je.map(e=>{let{id:t,position:n,timestamp:r}=e;const{x:o,y:i}=(0,c.hexToPixel)(n,Ut),a=(Date.now()-r)/1e3,s=[{delay:0,color:"#00ff00",maxRadius:125},{delay:.1,color:"#32cd32",maxRadius:2.2*Ut},{delay:.2,color:"#7fff00",maxRadius:95},{delay:.3,color:"#adff2f",maxRadius:80}];return(0,x.jsxs)("g",{transform:"translate(".concat(o,", ").concat(i,")"),style:{pointerEvents:"none"},children:[s.map((e,t)=>{const n=Math.max(0,Math.min(1,(a-e.delay)/(.7-e.delay))),r=n*e.maxRadius,o=.8*(1-n);return(0,x.jsx)("circle",{cx:0,cy:0,r:r,fill:"none",stroke:e.color,strokeWidth:8*(1-.5*n),opacity:o},t)}),a<.3&&(0,x.jsx)("circle",{cx:0,cy:0,r:40*(1-a/.3),fill:"#ffffff",opacity:.9*(1-a/.3)})]},t)}),We.map(e=>{let{id:t,amount:n,type:r,position:o,timestamp:i}=e;const{x:a,y:s}=(0,c.hexToPixel)(o,Ut),l=(Date.now()-i)/1e3,u=50*-l,d=1-l,h=1+.5*l,p="heal"===r?"#00FF00":"food"===r?"#00BFFF":"#4169E1";return(0,x.jsx)("g",{transform:"translate(".concat(a,", ").concat(s+u,")"),style:{pointerEvents:"none"},children:(0,x.jsxs)("text",{textAnchor:"middle",dy:"0.3em",fontSize:24*h,fontWeight:"bold",fill:p,stroke:"#ffffff",strokeWidth:"3",paintOrder:"stroke",opacity:d,children:["+",n]})},t)})]})]})})}),(0,x.jsxs)("div",{style:{width:"250px",backgroundColor:"#fff",padding:"15px",borderRadius:"8px",maxHeight:"calc(100vh - 80px)",overflowY:"auto",overflowX:"hidden",paddingBottom:"200px"},children:[Z.isMultiplayer&&(0,x.jsxs)("div",{style:{marginBottom:"10px",padding:"10px",backgroundColor:"#ecf0f1",borderRadius:"5px"},children:[(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Game Mode:"})," Online"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"You are:"})," ","player1"===Z.playerRole?"Player 1 (Red)":"Player 2 (Cyan)"]}),!on()&&(0,x.jsx)("p",{style:{color:"#e74c3c"},children:(0,x.jsx)("strong",{children:"Waiting for opponent..."})})]}),(0,x.jsxs)("h2",{children:["Turn ",te.turn]}),(0,x.jsxs)("h3",{style:{color:(null===(v=te.players)||void 0===v||null===(k=v[te.currentPlayer])||void 0===k?void 0:k.color)||"#000"},children:[(null===(A=te.players)||void 0===A||null===(E=A[te.currentPlayer])||void 0===E?void 0:E.name)||"Loading...","'s Turn"]}),(0,x.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,x.jsx)("h4",{children:"Your Resources"}),(e=>{const t=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,n=null===(e=te.players)||void 0===e?void 0:e[t];if(!n)return(0,x.jsx)("p",{style:{color:"#888"},children:"Loading..."});let r=0,o=0;Object.values(te.anthills||{}).forEach(e=>{e.owner===t&&e.isComplete&&("food"===e.resourceType?r+=l.sv.ANTHILL_PASSIVE_INCOME.food:o+=l.sv.ANTHILL_PASSIVE_INCOME.minerals)});const i=Object.values(te.ants||{}).find(e=>"queen"===e.type&&e.owner===t);if(i){const e=i.queenTier||"queen";r+=l.mZ[e].foodIncome}return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("p",{children:["\ud83c\udf43 Food: ",n.resources.food,r>0&&(0,x.jsxs)("span",{style:{color:"#27ae60",fontWeight:"bold"},children:[" (+",r,"/turn)"]})]}),(0,x.jsxs)("p",{children:["\ud83d\udc8e Minerals: ",n.resources.minerals,o>0&&(0,x.jsxs)("span",{style:{color:"#3498db",fontWeight:"bold"},children:[" (+",o,"/turn)"]})]})]})})()]}),on()&&(()=>{const e=nn(),t=Object.values(e.ants).find(t=>"queen"===t.type&&t.owner===e.currentPlayer);if(!t)return null;const n=t.queenTier||"queen";if("swarmQueen"===n)return null;const r="queen"===n?"broodQueen":"swarmQueen",o=l.mZ[r],i=(e.players[e.currentPlayer],(0,a.canAffordQueenUpgrade)(e,t.id));return(0,x.jsxs)("div",{style:{marginBottom:"20px",paddingBottom:"15px",borderBottom:"2px solid #ddd"},children:[(0,x.jsx)("h4",{children:"Queen Upgrade"}),(0,x.jsxs)("button",{onClick:()=>{if(!i)return void hn("Not enough resources!");const e=nn(),t=Object.values(e.ants).find(t=>"queen"===t.type&&t.owner===e.currentPlayer);t&&rn((0,a.upgradeQueen)(e,t.id))},disabled:!i||!on(),style:{padding:"12px",fontSize:"15px",backgroundColor:i?"#FF6B00":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:i&&on()?"pointer":"not-allowed",textAlign:"left",width:"100%",opacity:on()?1:.6},children:[(0,x.jsxs)("div",{style:{fontWeight:"bold",fontSize:"16px"},children:[o.icon," Upgrade to ",o.name]}),(0,x.jsxs)("div",{style:{fontSize:"13px",marginTop:"5px"},children:["Cost: ",o.cost.food,"\ud83c\udf43 ",o.cost.minerals,"\ud83d\udc8e"]}),(0,x.jsxs)("div",{style:{fontSize:"12px",marginTop:"5px",opacity:.9},children:["\u2022 +2 Spawning Spots (",l.mZ[n].spawningSpots," \u2192 ",o.spawningSpots,")",(0,x.jsx)("br",{}),"\u2022 +",o.maxEnergy-l.mZ[n].maxEnergy," Max Energy (",l.mZ[n].maxEnergy,"\u26a1 \u2192 ",o.maxEnergy,"\u26a1)",(0,x.jsx)("br",{}),"\u2022 +5 Energy Regen/Turn",(0,x.jsx)("br",{}),"\u2022 +",o.foodIncome-l.mZ[n].foodIncome," Food Income/Turn (",l.mZ[n].foodIncome,"\ud83c\udf43 \u2192 ",o.foodIncome,"\ud83c\udf43)"]})]})]})})(),Ie&&(0,x.jsxs)("div",{style:{marginBottom:"20px",padding:"10px",backgroundColor:"#fff3cd",borderRadius:"5px",border:"2px solid #ffc107"},children:[(0,x.jsx)("h4",{children:"Selected Egg"}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Type:"})," ",null===(R=(0,l.s1)(Ie.antType))||void 0===R?void 0:R.icon," ",null===(j=(0,l.s1)(Ie.antType))||void 0===j?void 0:j.name]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Owner:"})," ",te.players[Ie.owner].name]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Will hatch on turn:"})," ",Ie.hatchTurn]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Turns until hatch:"})," ",Math.max(0,Ie.hatchTurn-te.turn)]}),(0,x.jsx)("button",{onClick:()=>Pe(null),style:{marginTop:"10px",padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})]}),Me&&(0,x.jsxs)("div",{style:{marginBottom:"20px",padding:"10px",backgroundColor:"#d4edda",borderRadius:"5px",border:"2px solid #28a745"},children:[(0,x.jsx)("h4",{children:"Anthill Info"}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Type:"})," ","food"===Me.resourceType?"\ud83c\udf43 Food":"\ud83d\udc8e Minerals"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Owner:"})," ",te.players[Me.owner].name]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Income:"})," ",l.sv.ANTHILL_PASSIVE_INCOME[Me.resourceType]," per turn"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Resources Gathered:"})," ",Me.resourcesGathered||0," / 75"]}),(0,x.jsxs)("p",{children:[(0,x.jsx)("strong",{children:"Remaining:"})," ",75-(Me.resourcesGathered||0)]}),(0,x.jsx)("div",{style:{width:"100%",height:"20px",backgroundColor:"#e0e0e0",borderRadius:"10px",overflow:"hidden",marginTop:"10px"},children:(0,x.jsx)("div",{style:{width:"".concat((Me.resourcesGathered||0)/75*100,"%"),height:"100%",backgroundColor:"food"===Me.resourceType?"#4CAF50":"#2196F3",transition:"width 0.3s ease"}})}),(0,x.jsx)("button",{onClick:()=>Oe(null),style:{marginTop:"10px",padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Close"})]}),ce&&te.ants[ce]&&(0,x.jsxs)("div",{style:{marginBottom:"20px",padding:"10px",backgroundColor:"#e0e0e0",borderRadius:"5px"},children:[(0,x.jsx)("h4",{children:"Selected Ant"}),(0,x.jsx)("p",{children:"queen"===te.ants[ce].type&&te.ants[ce].queenTier?l.mZ[te.ants[ce].queenTier].name:null===(I=(0,l.s1)(te.ants[ce].type))||void 0===I?void 0:I.name}),(0,x.jsxs)("p",{children:["HP: ",te.ants[ce].health,"/",te.ants[ce].maxHealth]}),("queen"===te.ants[ce].type||"healer"===te.ants[ce].type||"cordyphage"===te.ants[ce].type)&&te.ants[ce].maxEnergy&&(0,x.jsxs)("p",{children:["Energy: ",te.ants[ce].energy||0,"/",te.ants[ce].maxEnergy]}),(()=>{const e=te.ants[ce],t=(0,l.s1)(e.type),r=te.players[e.owner],{getAntAttack:o,getAntDefense:i}=n(451),a=o(e,r),s=i(e,r,te),c=t.attack||0,u=a-c,d=s-(t.defense||0);return(0,x.jsxs)(x.Fragment,{children:[c>0&&(0,x.jsxs)("p",{children:["Attack: ",a," ",u>0&&(0,x.jsxs)("span",{style:{color:"#27ae60"},children:["(+",u,")"]})]}),(0,x.jsxs)("p",{children:["Defense: ",s," ",d>0&&(0,x.jsxs)("span",{style:{color:"#27ae60"},children:["(+",d,")"]})]})]})})(),te.ants[ce].ensnared&&te.ants[ce].ensnared>0&&(0,x.jsxs)("p",{style:{color:"#f39c12",fontWeight:"bold"},children:["\ud83d\udd78\ufe0f Ensnared (",te.ants[ce].ensnared," turns)"]}),te.ants[ce].plagued&&te.ants[ce].plagued>0&&(0,x.jsxs)("p",{style:{color:"#8e44ad",fontWeight:"bold"},children:["\u2620\ufe0f Plagued (",te.ants[ce].plagued," turns)"]}),te.ants[ce].owner===(null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer)&&on()&&(0,x.jsxs)(x.Fragment,{children:["queen"!==te.ants[ce].type&&(0,x.jsx)("button",{onClick:()=>he("move"),style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"move"===de?"#3498db":"#ecf0f1",color:"move"===de?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"move"===de?"bold":"normal"},children:"Move"}),(()=>{const e=nn();return(0,a.getValidTeleportDestinations)(e,ce).length>0&&!te.ants[ce].hasMoved?(0,x.jsx)("button",{onClick:()=>he("teleport"),style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"teleport"===de?"#9b59b6":"#ecf0f1",color:"teleport"===de?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"teleport"===de?"bold":"normal"},children:"\ud83c\udf00 Teleport"}):null})(),"bomber"===te.ants[ce].type?(0,x.jsx)("button",{onClick:pn,disabled:!on()||te.ants[ce].hasAttacked,style:{marginTop:"10px",padding:"10px 20px",backgroundColor:te.ants[ce].hasAttacked?"#95a5a6":"#e74c3c",color:"white",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"bold",fontSize:"14px",width:"100%",opacity:on()?1:.6},children:"\ud83d\udca5 DETONATE (X) (Suicide Attack) \ud83d\udca5"}):"healer"===te.ants[ce].type?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>he("heal"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"heal"===de?"#27ae60":"#ecf0f1",color:"heal"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"heal"===de?"bold":"normal",opacity:on()?1:.6},children:"\u2728 Heal (25\u26a1) (H)"}),(0,x.jsx)("button",{onClick:()=>he("ensnare"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"ensnare"===de?"#f39c12":"#ecf0f1",color:"ensnare"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"ensnare"===de?"bold":"normal",opacity:on()?1:.6},children:"\ud83d\udd78\ufe0f Ensnare (20\u26a1) (E)"})]}):"cordyphage"===te.ants[ce].type?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>he("plague"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"plague"===de?"#16a085":"#ecf0f1",color:"plague"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"plague"===de?"bold":"normal",opacity:on()?1:.6},children:"\u2620\ufe0f Plague (25\u26a1) (P)"}),te.players[te.currentPlayer].upgrades.cordycepsPurge>0&&(0,x.jsx)("button",{onClick:()=>he("cordyceps"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"cordyceps"===de?"#8e44ad":"#ecf0f1",color:"cordyceps"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"cordyceps"===de?"bold":"normal",opacity:on()?1:.6},children:"\ud83e\udde0 Cordyceps (35\u26a1)"})]}):"bombardier"===te.ants[ce].type?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>he("attack"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"attack"===de?"#e74c3c":"#ecf0f1",color:"attack"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"attack"===de?"bold":"normal",opacity:on()?1:.6},children:"\ud83c\udfaf Focus Fire (A, 15)"}),(0,x.jsx)("button",{onClick:()=>he("bombardier_splash"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"bombardier_splash"===de?"#ff6b35":"#ecf0f1",color:"bombardier_splash"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"bombardier_splash"===de?"bold":"normal",opacity:on()?1:.6},children:"\ud83d\udca5 Splash (8, 3-hex)"})]}):(0,x.jsx)("button",{onClick:()=>he("attack"),style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"attack"===de?"#e74c3c":"#ecf0f1",color:"attack"===de?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"attack"===de?"bold":"normal"},children:"Attack (A)"}),"queen"===te.ants[ce].type&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{onClick:()=>he("layEgg"),style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"layEgg"===de?"#2ecc71":"#ecf0f1",color:"layEgg"===de?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"layEgg"===de?"bold":"normal"},children:"Lay Egg"}),(0,x.jsx)("button",{onClick:()=>he("heal"),style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"heal"===de?"#27ae60":"#ecf0f1",color:"heal"===de?"white":"black",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"heal"===de?"bold":"normal"},children:"Heal (H, 25\u26a1)"}),("broodQueen"===(null===(P=te.ants[ce])||void 0===P?void 0:P.queenTier)||"swarmQueen"===(null===(M=te.ants[ce])||void 0===M?void 0:M.queenTier))&&(0,x.jsx)("button",{onClick:()=>he("reveal"),disabled:!on()||te.ants[ce].hasAttacked,style:{marginRight:"5px",padding:"8px 12px",backgroundColor:"reveal"===de?"#3498db":"#ecf0f1",color:"reveal"===de?"white":"black",border:"none",borderRadius:"4px",cursor:on()&&!te.ants[ce].hasAttacked?"pointer":"not-allowed",fontWeight:"reveal"===de?"bold":"normal",opacity:on()?1:.6},children:"\ud83d\udc41\ufe0f Reveal (30\u26a1)"}),(0,x.jsx)("button",{onClick:()=>ot(!0),style:{padding:"8px 12px",backgroundColor:"#9C27B0",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"normal"},children:"\u26a1 Upgrades"})]}),"drone"===te.ants[ce].type&&!te.ants[ce].hasBuilt&&(0,x.jsx)("button",{onClick:gn,style:{padding:"8px 12px",backgroundColor:"#f39c12",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"normal"},children:"Build Anthill (B)"}),!te.ants[ce].isBurrowed&&(0,a.canBurrow)(nn(),te.ants[ce])&&(0,x.jsx)("button",{onClick:()=>{const e=nn(),t=(0,a.burrowAnt)(e,ce);rn(t)},disabled:!on(),style:{marginTop:"10px",padding:"8px 12px",backgroundColor:"#8B4513",color:"white",border:"none",borderRadius:"4px",cursor:on()?"pointer":"not-allowed",width:"100%",fontWeight:"bold",opacity:on()?1:.6},children:"\ud83c\udf0d BURROW"}),te.ants[ce].isBurrowed&&(0,a.canUnburrow)(nn(),ce)&&(0,x.jsx)("button",{onClick:()=>{const e=nn(),t=(0,a.unburrowAnt)(e,ce);rn(t)},disabled:!on(),style:{marginTop:"10px",padding:"8px 12px",backgroundColor:"#DAA520",color:"white",border:"none",borderRadius:"4px",cursor:on()?"pointer":"not-allowed",width:"100%",fontWeight:"bold",opacity:on()?1:.6},children:"\u2b06\ufe0f UNBURROW"}),"bombardier_splash"===de&&pt&&(0,x.jsxs)("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#fff3cd",borderRadius:"5px",border:"2px solid #ffc107",fontSize:"13px",textAlign:"center"},children:[(0,x.jsx)("strong",{children:"\u2328\ufe0f Press SHIFT to rotate"}),(0,x.jsx)("br",{}),(0,x.jsx)("span",{style:{fontSize:"11px",color:"#856404"},children:"Click the same hex again to confirm attack"})]})]})]}),on()&&(0,x.jsx)("button",{onClick:async()=>{if(!on())return void console.error("handleEndTurn blocked: Not your turn!");const e=nn();if(null!==Z&&void 0!==Z&&Z.isMultiplayer&&e.currentPlayer!==Z.playerRole)return void console.error("handleEndTurn blocked: currentPlayer mismatch!",{currentPlayer:e.currentPlayer,myRole:Z.playerRole});console.log("handleEndTurn - Before endTurn:",{turn:e.turn,currentPlayer:e.currentPlayer,playerRole:null===Z||void 0===Z?void 0:Z.playerRole,isMultiplayer:null===Z||void 0===Z?void 0:Z.isMultiplayer});const{gameState:t,resourceGains:n,plagueDamages:r}=(0,a.endTurn)(e);if(console.log("handleEndTurn - After endTurn:",{turn:t.turn,currentPlayer:t.currentPlayer,willUpdate:null!==Z&&void 0!==Z&&Z.isMultiplayer?"Firebase":"Local"}),t.gameOver&&!Ye&&$e(!0),n&&n.length>0){const e=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,r=null!==Z&&void 0!==Z&&Z.isMultiplayer?y(t,e):null;n.forEach(t=>{const n="".concat(t.position.q,",").concat(t.position.r);(t.owner===e||r&&r.has(n)||!(null!==Z&&void 0!==Z&&Z.isMultiplayer))&&tn(t.amount,t.type,t.position)})}if(r&&r.length>0){const e=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,n=null!==Z&&void 0!==Z&&Z.isMultiplayer?y(t,e):null;r.forEach(e=>{let{damage:t,position:r,antId:o}=e;const i="".concat(r.q,",").concat(r.r);(!(null!==Z&&void 0!==Z&&Z.isMultiplayer)||!n||n.has(i))&&Jt(t,r)})}rn(t),ue(null),he(null),Pe(null),Ae(null),Te(!1)},style:{width:"100%",padding:"10px",fontSize:"16px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"End Turn"}),te.gameOver&&(0,x.jsxs)("div",{style:{marginTop:"20px",padding:"10px",backgroundColor:"#ffcc00",borderRadius:"5px"},children:[(0,x.jsx)("h3",{children:"Game Over!"}),(0,x.jsxs)("p",{children:[te.players[te.winner].name," wins!"]})]})]})]}),(0,x.jsxs)("div",{style:{position:"fixed",bottom:"20px",right:"calc(250px + 60px)",display:"grid",gridTemplateColumns:"repeat(2, 60px)",gridTemplateRows:"repeat(2, 60px) auto",gap:"10px",zIndex:1e3},children:[(0,x.jsx)("button",{onClick:vn,disabled:!on(),style:{padding:"0",borderRadius:"8px",backgroundColor:on()?"#9C27B0":"#ccc",color:"white",border:"none",fontSize:"24px",fontWeight:"bold",cursor:on()?"pointer":"not-allowed",boxShadow:"0 3px 6px rgba(0,0,0,0.3)",width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center",opacity:on()?1:.5},title:"Cycle to Next Active Ant (Tab)",children:"\ud83d\udc1c\u27f3"}),(0,x.jsx)("button",{onClick:$t,style:{padding:"0",borderRadius:"8px",backgroundColor:"#FF9800",color:"white",border:"none",fontSize:"26px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.3)",width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Center on Queen (C)",children:"\ud83d\udc51"}),(0,x.jsx)("button",{onClick:()=>Ft(e=>Math.min(2,e+.2)),style:{padding:"0",borderRadius:"8px",backgroundColor:"#4CAF50",color:"white",border:"none",fontSize:"30px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.3)",width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Zoom In (+)",children:"+"}),(0,x.jsx)("button",{onClick:()=>Ft(e=>Math.max(.5,e-.2)),style:{padding:"0",borderRadius:"8px",backgroundColor:"#f44336",color:"white",border:"none",fontSize:"30px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 3px 6px rgba(0,0,0,0.3)",width:"60px",height:"60px",display:"flex",alignItems:"center",justifyContent:"center"},title:"Zoom Out (-)",children:"-"}),(0,x.jsxs)("div",{style:{padding:"8px",borderRadius:"8px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",fontSize:"12px",textAlign:"center",fontWeight:"bold",gridColumn:"span 2",boxSizing:"border-box"},children:[Math.round(100*Dt),"%"]})]}),!te.gameOver&&(0,x.jsx)("button",{onClick:()=>{Ke(!0)},style:{position:"fixed",top:"20px",right:"20px",padding:"10px 18px",fontSize:"14px",fontWeight:"bold",backgroundColor:"#d32f2f",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)",zIndex:1e3,transition:"all 0.2s"},onMouseOver:e=>{e.target.style.backgroundColor="#b71c1c",e.target.style.boxShadow="0 6px 12px rgba(0,0,0,0.4)"},onMouseOut:e=>{e.target.style.backgroundColor="#d32f2f",e.target.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},children:"Concede"}),(null===(O=te.players[te.currentPlayer])||void 0===O?void 0:O.heroId)&&(0,x.jsxs)("div",{style:{position:"fixed",bottom:"20px",left:"calc(300px + 40px + 130px + 15px)",display:"flex",alignItems:"center",gap:"15px",padding:"12px 20px",backgroundColor:"#2c3e50",borderRadius:"8px",border:"2px solid #34495e",zIndex:1e3,boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:[(0,x.jsx)("div",{onClick:()=>mt(!0),style:{width:"64px",height:"64px",border:"3px solid "+((null===(N=te.players[te.currentPlayer])||void 0===N?void 0:N.color)||"#fff"),borderRadius:"8px",overflow:"hidden",backgroundColor:"#1a252f",flexShrink:0,cursor:"pointer"},children:(0,x.jsx)("img",{src:"".concat("/Battle-Ants","/sprites/hero_").concat({"#FF0000":"red","#ff0000":"red","#0000FF":"blue","#0000ff":"blue","#00FFFF":"blue","#00ffff":"blue","#FFFF00":"yellow","#ffff00":"yellow","#00FF00":"green","#00ff00":"green"}[(null===(kn=te.players[te.currentPlayer])||void 0===kn?void 0:kn.color)||"#FF0000"]||"red",".png"),alt:"Hero",style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,x.jsxs)("div",{style:{minWidth:"250px"},children:[(0,x.jsx)("div",{style:{marginBottom:"6px",color:"#ecf0f1",fontSize:"18px",fontWeight:"bold"},children:(e=>{const{getHeroById:t}=n(201),r=t(null===(e=te.players[te.currentPlayer])||void 0===e?void 0:e.heroId);return r?r.name:"Hero"})()}),(0,x.jsx)("div",{style:{width:"100%",height:"22px",backgroundColor:"#34495e",borderRadius:"11px",overflow:"hidden",border:"2px solid #1a252f",marginBottom:"6px",position:"relative"},children:(0,x.jsx)("div",{style:{width:"".concat((null===(D=te.players[te.currentPlayer])||void 0===D?void 0:D.heroPower)||0,"%"),height:"100%",backgroundColor:(null===(F=te.players[te.currentPlayer])||void 0===F?void 0:F.heroPower)>=100?"#f39c12":"#3498db",transition:"width 0.3s ease"}})}),(0,x.jsx)("button",{onClick:()=>{const{activateHeroAbility:e}=n(451),t=nn(),r=e(t,t.currentPlayer);rn(r)},disabled:!on()||((null===(q=te.players[te.currentPlayer])||void 0===q?void 0:q.heroPower)||0)<100||(null===(B=te.players[te.currentPlayer])||void 0===B?void 0:B.heroAbilityActive),style:{padding:"6px 12px",fontSize:"12px",fontWeight:"bold",backgroundColor:((null===(W=te.players[te.currentPlayer])||void 0===W?void 0:W.heroPower)||0)>=100&&on()&&(null===(U=te.players[te.currentPlayer])||void 0===U||!U.heroAbilityActive)?"#f39c12":"#95a5a6",color:"white",border:"none",borderRadius:"5px",cursor:((null===(V=te.players[te.currentPlayer])||void 0===V?void 0:V.heroPower)||0)>=100&&on()&&(null===(G=te.players[te.currentPlayer])||void 0===G||!G.heroAbilityActive)?"pointer":"not-allowed",width:"100%",opacity:on()?1:.6},title:((e,t)=>{const{getHeroById:r}=n(201),o=r(null===(e=te.players[te.currentPlayer])||void 0===e?void 0:e.heroId);return(null===o||void 0===o||null===(t=o.heroAbility)||void 0===t?void 0:t.description)||"Hero Ability"})(),children:null!==(K=te.players[te.currentPlayer])&&void 0!==K&&K.heroAbilityActive?"\u2713 ACTIVE":"\u26a1 ACTIVATE ABILITY"})]})]}),(0,x.jsxs)("div",{style:{position:"fixed",bottom:"65px",left:"calc(300px + 40px)",padding:"8px 12px",borderRadius:"8px",backgroundColor:"rgba(0,0,0,0.7)",color:"white",fontSize:"11px",zIndex:1e3,maxWidth:"180px"},children:[(0,x.jsx)("strong",{children:"Controls:"}),(0,x.jsx)("br",{}),"Tab: Next Active Ant",(0,x.jsx)("br",{}),"Mouse Wheel: Zoom",(0,x.jsx)("br",{}),"Middle Click: Pan",(0,x.jsx)("br",{}),"WASD/Arrows: Pan",(0,x.jsx)("br",{}),"C: Center on Queen"]}),(0,x.jsx)("button",{onClick:()=>nt(!0),style:{position:"fixed",bottom:"20px",left:"calc(300px + 40px)",padding:"10px 16px",borderRadius:"20px",backgroundColor:"#2196F3",color:"white",border:"none",fontSize:"14px",fontWeight:"bold",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap"},title:"Game Guide",children:"how to play"}),rt&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>ot(!1),children:(0,x.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"10px",maxWidth:"600px",maxHeight:"80vh",overflow:"auto",padding:"30px",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,x.jsx)("button",{onClick:()=>ot(!1),style:{position:"absolute",top:"15px",right:"15px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#e74c3c",color:"white",border:"none",fontSize:"20px",cursor:"pointer",fontWeight:"bold"},children:"\xd7"}),(0,x.jsx)("h2",{style:{marginTop:0,color:"#9C27B0",borderBottom:"3px solid #9C27B0",paddingBottom:"10px"},children:"\u26a1 Upgrades"}),(0,x.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"20px"},children:Object.values(l.GU).map(e=>{const t=te.players[te.currentPlayer],n=Object.values(te.ants).find(e=>"queen"===e.type&&e.owner===te.currentPlayer),r=t.upgrades[e.id]||0,o=r>=e.maxTier,i=!o&&(0,a.canAffordUpgrade)(t,e.id,n),s=o?null:e.costs[r],l=1===e.maxTier;return(0,x.jsxs)("button",{onClick:()=>{if(!i)return void hn(o?"Already purchased!":"Not enough resources!");const t=nn();rn((0,a.purchaseUpgrade)(t,e.id))},disabled:!i,style:{padding:"15px",fontSize:"15px",backgroundColor:o?"#888":i?"#9C27B0":"#ccc",color:"white",border:"none",borderRadius:"8px",cursor:i?"pointer":"not-allowed",textAlign:"left"},children:[(0,x.jsxs)("div",{style:{fontWeight:"bold",fontSize:"17px",marginBottom:"8px"},children:[e.icon," ",e.name,!l&&" (Tier ".concat(r,"/").concat(e.maxTier,")"),o&&(0,x.jsx)("span",{style:{marginLeft:"10px",fontSize:"14px",opacity:.8},children:"\u2713 Owned"})]}),!o&&s&&(0,x.jsxs)("div",{style:{fontSize:"14px",marginBottom:"6px"},children:["Cost: ",s.food,"\ud83c\udf43 ",s.minerals,"\ud83d\udc8e"]}),(0,x.jsx)("div",{style:{fontSize:"13px",opacity:.9,lineHeight:"1.4"},children:e.description}),e.requiresQueenTier&&"swarmQueen"!==(null===n||void 0===n?void 0:n.queenTier)&&(0,x.jsx)("div",{style:{fontSize:"12px",marginTop:"6px",fontStyle:"italic",color:"#FFD700"},children:"Requires: Swarm Queen upgrade"})]},e.id)})})]})}),gt&&(null===(Y=te.players[te.currentPlayer])||void 0===Y?void 0:Y.heroId)&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>mt(!1),children:(0,x.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"10px",maxWidth:"600px",width:"100%",padding:"30px",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,x.jsx)("button",{onClick:()=>mt(!1),style:{position:"absolute",top:"15px",right:"15px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#e74c3c",color:"white",border:"none",fontSize:"20px",cursor:"pointer",fontWeight:"bold"},children:"\xd7"}),(e=>{const{getHeroById:t}=n(201),r=t(null===(e=te.players[te.currentPlayer])||void 0===e?void 0:e.heroId);return r?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("h1",{style:{marginTop:0,color:"#333",borderBottom:"3px solid #2196F3",paddingBottom:"10px",display:"flex",alignItems:"center",gap:"10px"},children:[(0,x.jsx)("span",{style:{fontSize:"36px"},children:r.icon}),r.name]}),(0,x.jsx)("div",{style:{marginBottom:"25px"},children:(0,x.jsx)("p",{style:{fontSize:"16px",color:"#555",fontStyle:"italic"},children:r.description})}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Passive Bonuses"}),(0,x.jsxs)("div",{style:{backgroundColor:"#f0f0f0",padding:"15px",borderRadius:"8px"},children:[r.bonuses.meleeAttackBonus&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Melee Attack:"})," +",Math.round(100*r.bonuses.meleeAttackBonus),"%"]}),r.bonuses.meleeHealthBonus&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Melee Health:"})," +",r.bonuses.meleeHealthBonus]}),r.bonuses.rangedAttackBonus&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Ranged Attack:"})," +",Math.round(100*r.bonuses.rangedAttackBonus),"%"]}),r.bonuses.attackMultiplier&&1!==r.bonuses.attackMultiplier&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"All Units Attack:"})," ",r.bonuses.attackMultiplier>1?"+":"",Math.round(100*(r.bonuses.attackMultiplier-1)),"%"]}),r.bonuses.healthMultiplier&&1!==r.bonuses.healthMultiplier&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"All Units Health:"})," ",r.bonuses.healthMultiplier>1?"+":"",Math.round(100*(r.bonuses.healthMultiplier-1)),"%"]}),r.bonuses.costMultiplier&&1!==r.bonuses.costMultiplier&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Unit Cost:"})," ",r.bonuses.costMultiplier<1?"":"+",Math.round(100*(r.bonuses.costMultiplier-1)),"% (units are ",r.bonuses.costMultiplier<1?"cheaper":"more expensive",")"]}),r.bonuses.healCostMultiplier&&1!==r.bonuses.healCostMultiplier&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Healing Cost:"})," ",Math.round(100*(1-r.bonuses.healCostMultiplier)),"% cheaper"]}),r.bonuses.spawningSpotBonus&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Spawning Spots:"})," +",r.bonuses.spawningSpotBonus," (starts with ",2+r.bonuses.spawningSpotBonus,")"]}),r.bonuses.queenDoubleHeal&&(0,x.jsxs)("p",{style:{margin:"5px 0"},children:[(0,x.jsx)("strong",{children:"Queen Healing:"})," Can heal twice per turn"]})]})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#f39c12",marginBottom:"10px"},children:"Hero Ability"}),(0,x.jsxs)("div",{style:{backgroundColor:"#fff4e6",padding:"15px",borderRadius:"8px",border:"2px solid #f39c12"},children:[(0,x.jsx)("h3",{style:{margin:"0 0 10px 0",color:"#e67e22"},children:r.heroAbility.name}),(0,x.jsx)("p",{style:{margin:"5px 0",color:"#555"},children:r.heroAbility.description}),(0,x.jsxs)("p",{style:{margin:"10px 0 5px 0",fontSize:"14px",color:"#888"},children:[(0,x.jsx)("strong",{children:"Activation:"})," Gain 100 hero power by dealing and taking damage, then activate for powerful effects!"]})]})]})]}):null})()]})}),Qe&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:(0,x.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"10px",padding:"30px 40px",textAlign:"center",maxWidth:"400px",boxShadow:"0 10px 30px rgba(0,0,0,0.5)"},children:[(0,x.jsx)("h2",{style:{marginTop:0,color:"#d32f2f",fontSize:"24px"},children:"Concede Match?"}),(0,x.jsx)("p",{style:{fontSize:"16px",color:"#555",marginBottom:"25px"},children:"Are you sure you want to concede? This will end the game and declare your opponent the winner."}),(0,x.jsxs)("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[(0,x.jsx)("button",{onClick:()=>{Ke(!1)},style:{padding:"12px 25px",fontSize:"16px",fontWeight:"bold",backgroundColor:"#757575",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Cancel"}),(0,x.jsx)("button",{onClick:()=>{Ke(!1);const e=null!==Z&&void 0!==Z&&Z.isMultiplayer?Z.playerRole:te.currentPlayer,{checkWinCondition:t}=n(867),r=(0,i.A)({},te.ants),o=Object.keys(r).find(t=>"queen"===r[t].type&&r[t].owner===e);o&&delete r[o];const a=Object.keys(te.players).find(t=>t!==e),s=t((0,i.A)((0,i.A)({},te),{},{ants:r}),a,e);let l=s.winner||a;const c=(0,i.A)((0,i.A)({},te),{},{ants:r,gameOver:!0,winner:l,winningTeam:s.winningTeam});rn(c),$e(!0)},style:{padding:"12px 25px",fontSize:"16px",fontWeight:"bold",backgroundColor:"#d32f2f",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Yes, Concede"})]})]})}),bt&&(0,x.jsx)("div",{onClick:()=>xt(!1),style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:4e3,cursor:"pointer"},children:(0,x.jsxs)("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.95)",border:"4px solid #FFD700",borderRadius:"20px",padding:"40px 60px",textAlign:"center",boxShadow:"0 0 40px rgba(255, 215, 0, 0.8), inset 0 0 20px rgba(255, 215, 0, 0.2)",animation:"turnPopupPulse 0.5s ease-in-out",minWidth:"300px"},children:[(0,x.jsx)("h1",{style:{margin:0,fontSize:"48px",color:"#FFD700",textShadow:"0 0 20px rgba(255, 215, 0, 0.8), 0 0 40px rgba(255, 215, 0, 0.5)",fontWeight:"bold",letterSpacing:"2px"},children:"YOUR TURN!"}),(0,x.jsx)("p",{style:{margin:"15px 0 0 0",fontSize:"16px",color:"#e0e0e0",fontStyle:"italic"},children:"Click anywhere to continue"})]})}),Ye&&te.gameOver&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:3e3},children:(0,x.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"15px",padding:"40px 50px",textAlign:"center",maxWidth:"500px",boxShadow:"0 15px 40px rgba(0,0,0,0.6)"},children:[(0,x.jsx)("h1",{style:{marginTop:0,fontSize:"36px",color:te.winner===te.currentPlayer||null!==Z&&void 0!==Z&&Z.playerRole&&te.winner===Z.playerRole?"#4CAF50":"#d32f2f",marginBottom:"15px"},children:te.winner===te.currentPlayer||null!==Z&&void 0!==Z&&Z.playerRole&&te.winner===Z.playerRole?"Victory!":"Defeat"}),(0,x.jsxs)("p",{style:{fontSize:"20px",color:"#555",marginBottom:"30px"},children:[(null===($=te.players[te.winner])||void 0===$?void 0:$.name)||"Player ".concat("player1"===te.winner?"1":"2")," wins!"]}),(0,x.jsx)("button",{onClick:()=>{$e(!1),Xe(!0)},style:{padding:"15px 40px",fontSize:"18px",fontWeight:"bold",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",boxShadow:"0 4px 8px rgba(0,0,0,0.3)"},children:"View Game Summary"})]})}),tt&&(0,x.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},children:(0,x.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:"10px",maxWidth:"900px",maxHeight:"90vh",overflow:"auto",padding:"30px",position:"relative"},children:[(0,x.jsx)("button",{onClick:()=>nt(!1),style:{position:"absolute",top:"15px",right:"15px",width:"35px",height:"35px",borderRadius:"50%",backgroundColor:"#e74c3c",color:"white",border:"none",fontSize:"20px",cursor:"pointer",fontWeight:"bold"},children:"\xd7"}),(0,x.jsx)("h1",{style:{marginTop:0,color:"#333",borderBottom:"3px solid #2196F3",paddingBottom:"10px"},children:"Ant Wars - Game Guide"}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Objective"}),(0,x.jsx)("p",{style:{fontSize:"15px",lineHeight:"1.6"},children:"Destroy the enemy Queen to win! Manage your colony, gather resources, build anthills, and command your ant army to victory."})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Game Basics"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Resources:"})," Food (\ud83c\udf43) and Minerals (\ud83d\udc8e) are needed to spawn units and purchase upgrades"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Turn-Based:"})," Each player takes turns. End your turn when all actions are complete"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Queen Energy:"})," Queens have energy for laying eggs and healing. Energy regenerates each round"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Fog of War:"})," In multiplayer, you can only see areas within your units' vision range"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Camera:"})," The view centers on your Queen each turn. Use mouse wheel to zoom, middle-click or WASD/arrows to pan"]})]})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Unit Types & Stats"}),(0,x.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"15px"},children:Object.values(l.xr).map(e=>(0,x.jsxs)("div",{style:{border:"2px solid #ddd",borderRadius:"8px",padding:"12px",backgroundColor:"#f9f9f9"},children:[(0,x.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:"8px"},children:[(0,x.jsx)("div",{style:{width:"64px",height:"64px",overflow:"hidden",marginRight:"10px",position:"relative"},children:(0,x.jsx)("img",{src:(t=>{const n=(null===(t=te.players[te.currentPlayer])||void 0===t?void 0:t.color)||"#FF0000",r=_n(e.id,n);return console.log("[HOW TO PLAY] Generating sprite path for ".concat(e.name," with color ").concat(n,": ").concat(r)),"".concat("/Battle-Ants","/").concat(r)})(),alt:e.name,style:{height:"32px",imageRendering:"pixelated",objectFit:"none",objectPosition:"0 0",transform:"scale(2)",transformOrigin:"top left"},onError:t=>{console.error("[HOW TO PLAY] Failed to load sprite for ".concat(e.name,":"),t.target.src)},onLoad:t=>{console.log("[HOW TO PLAY] Successfully loaded sprite for ".concat(e.name))}})}),(0,x.jsx)("h3",{style:{margin:0,fontSize:"16px",color:"#333"},children:e.name})]}),(0,x.jsx)("p",{style:{fontSize:"12px",margin:"0 0 8px 0",color:"#666"},children:e.description}),(0,x.jsxs)("div",{style:{fontSize:"12px",lineHeight:"1.6"},children:[(0,x.jsx)("strong",{children:"Cost:"})," ",e.cost.food,"\ud83c\udf43 ",e.cost.minerals,"\ud83d\udc8e",(0,x.jsx)("br",{}),(0,x.jsx)("strong",{children:"HP:"})," ",e.maxHealth," | ",(0,x.jsx)("strong",{children:"Attack:"})," ",e.attack," | ",(0,x.jsx)("strong",{children:"Defense:"})," ",e.defense,(0,x.jsx)("br",{}),(0,x.jsx)("strong",{children:"Move Range:"})," ",e.moveRange," | ",(0,x.jsx)("strong",{children:"Attack Range:"})," ",e.attackRange,e.minAttackRange&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsx)("strong",{children:"Min Range:"})," ",e.minAttackRange]}),e.cannotMoveAndAttack&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsx)("em",{children:"Cannot move and attack in same turn"})]}),e.splashDamage&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsxs)("em",{children:["Deals splash damage (50%) in radius ",e.splashRadius]})]}),e.canBuildAnthill&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsx)("em",{children:"Can build anthills on resource nodes"})]})]})]},e.id))})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Combat System"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Damage Formula:"})," Attack - (Defense / 2), minimum 1 damage"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Health-Based Scaling:"})," Damaged units deal less damage (health% + 5%)"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Melee Counter-Attack:"})," When attacked in melee range, defender strikes back if they survive"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Anthill Defense Bonus:"})," Units on anthills get +2 defense"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Bomber Detonation:"})," When bombers die, they explode dealing damage to adjacent units"]})]})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Queen Mechanics"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Energy System:"})," Queens start with ",l.sv.QUEEN_BASE_ENERGY," energy, regenerate ",l.sv.QUEEN_BASE_ENERGY_REGEN," per round"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Laying Eggs:"})," Costs ",l.sv.EGG_LAY_ENERGY_COST," energy (reduced with upgrades). Eggs hatch after their incubation time"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Spawning Pool:"})," Queens can only lay eggs in adjacent hexes (2 spots initially, increases with upgrades)"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Healing:"})," Costs ",l.sv.HEAL_ENERGY_COST," energy to heal a friendly unit for ",l.sv.HEAL_AMOUNT," HP within range 2"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Passive Income:"})," Queens generate ",l.sv.QUEEN_BASE_FOOD_INCOME," food per turn (increases with upgrades)"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Queen Upgrades:"})," Upgrade to Brood Queen (+2 spots, -5 egg cost, +3 food/turn) then Swarm Queen (+2 more spots, -5 more egg cost, +3 food/turn)"]})]})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Anthills & Economy"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Building:"})," Drones can build anthills on resource nodes (requires 2 build actions)"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Passive Income:"})," Completed anthills generate ",l.sv.ANTHILL_PASSIVE_INCOME.food," food or ",l.sv.ANTHILL_PASSIVE_INCOME.minerals," minerals per turn"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Anthills as Structures:"})," Have 20 HP and provide +2 defense to units standing on them"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Strategy:"})," Secure resource nodes early for economic advantage!"]})]})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Upgrades"}),(0,x.jsx)("div",{style:{fontSize:"14px",lineHeight:"1.8"},children:Object.values(l.GU).map(e=>(0,x.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,x.jsxs)("strong",{children:[e.icon," ",e.name,":"]})," ",e.description,"cannibalism"===e.id&&(0,x.jsxs)(x.Fragment,{children:[" - Grants ",l.sv.CANNIBALISM_FOOD_GAIN," food and ",l.sv.CANNIBALISM_MINERAL_GAIN," minerals when melee units kill enemies"]}),(0,x.jsx)("br",{}),(0,x.jsxs)("em",{style:{fontSize:"12px",color:"#666"},children:["Max Tier: ",e.maxTier," | Costs: ",e.costs.map((e,t)=>"T".concat(t+1,": ").concat(e.food,"\ud83c\udf43 ").concat(e.minerals,"\ud83d\udc8e")).join(", ")]})]},e.id))})]}),(0,x.jsxs)("section",{style:{marginBottom:"25px"},children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Tips & Strategy"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsx)("li",{children:"Send scouts early to explore and claim resource nodes"}),(0,x.jsx)("li",{children:"Build anthills for passive income - economy wins games!"}),(0,x.jsx)("li",{children:"Protect your Queen at all costs - losing her means defeat"}),(0,x.jsx)("li",{children:"Use tanks to hold the frontline while ranged units deal damage"}),(0,x.jsx)("li",{children:"Bombardiers are powerful but vulnerable - keep them protected"}),(0,x.jsx)("li",{children:"Upgrade your units to gain combat advantages"}),(0,x.jsx)("li",{children:"Cannibalism upgrade turns aggressive play into resource generation"}),(0,x.jsx)("li",{children:"Position units on anthills for the +2 defense bonus in key fights"})]})]}),(0,x.jsxs)("section",{children:[(0,x.jsx)("h2",{style:{color:"#2196F3",marginBottom:"10px"},children:"Controls"}),(0,x.jsxs)("ul",{style:{fontSize:"14px",lineHeight:"1.8"},children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Left Click:"})," Select units, select actions, move, attack"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Right Click:"})," Deselect/Cancel"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Tab Key / \ud83d\udc1c\u27f3 Button:"})," Cycle to next ant with available actions"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Mouse Wheel:"})," Zoom in/out"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Middle Click / Ctrl+Drag:"})," Pan camera"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"WASD / Arrow Keys:"})," Pan camera"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"+/- Keys:"})," Zoom in/out"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"C Key / \ud83d\udc51 Button:"})," Center camera on your Queen"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Build Ants (Left Panel):"})," Click an ant type to queue egg laying"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"Upgrades (Right Panel):"})," Purchase upgrades to boost your army"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("strong",{children:"End Turn:"})," Complete your turn and switch to opponent"]})]})]}),(0,x.jsx)("div",{style:{marginTop:"30px",textAlign:"center",paddingTop:"20px",borderTop:"2px solid #ddd"},children:(0,x.jsx)("button",{onClick:()=>nt(!1),style:{padding:"12px 30px",fontSize:"16px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontWeight:"bold"},children:"Got It!"})})]})})]});var kn},Y=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:o,getLCP:i,getTTFB:a}=t;n(e),r(e),o(e),i(e),a(e)})};o.createRoot(document.getElementById("root")).render((0,x.jsx)(r.StrictMode,{children:(0,x.jsx)(K,{})})),Y()})();
//# sourceMappingURL=main.f8e91509.js.map